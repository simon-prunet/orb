

<!DOCTYPE html>
<!--[if IE 8]><html class="no-js lt-ie9" lang="en" > <![endif]-->
<!--[if gt IE 8]><!--> <html class="no-js" lang="en" > <!--<![endif]-->
<head>
  <meta charset="utf-8">
  
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  
  <title>Code documentation: core modules &mdash; orb  documentation</title>
  

  
  
  
  

  
  <script type="text/javascript" src="_static/js/modernizr.min.js"></script>
  
    
      <script type="text/javascript" id="documentation_options" data-url_root="./" src="_static/documentation_options.js"></script>
        <script type="text/javascript" src="_static/jquery.js"></script>
        <script type="text/javascript" src="_static/underscore.js"></script>
        <script type="text/javascript" src="_static/doctools.js"></script>
        <script type="text/javascript" src="_static/language_data.js"></script>
    
    <script type="text/javascript" src="_static/js/theme.js"></script>

    

  
  <link rel="stylesheet" href="_static/css/theme.css" type="text/css" />
  <link rel="stylesheet" href="_static/pygments.css" type="text/css" />
    <link rel="index" title="Index" href="genindex.html" />
    <link rel="search" title="Search" href="search.html" />
    <link rel="next" title="Code documentation: utils modules" href="code_utils.html" />
    <link rel="prev" title="Introduction" href="README.html" /> 
</head>

<body class="wy-body-for-nav">

   
  <div class="wy-grid-for-nav">
    
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search" >
          

          
            <a href="index.html" class="icon icon-home"> orb
          

          
          </a>

          
            
            
          

          
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>

          
        </div>

        <div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="main navigation">
          
            
            
              
            
            
              <ul class="current">
<li class="toctree-l1"><a class="reference internal" href="README.html">Introduction</a></li>
<li class="toctree-l1 current"><a class="current reference internal" href="#">Code documentation: core modules</a><ul>
<li class="toctree-l2"><a class="reference internal" href="#module-orb.astrometry">orb.astrometry module</a></li>
<li class="toctree-l2"><a class="reference internal" href="#module-orb.cgvar">orb.cgvar module</a></li>
<li class="toctree-l2"><a class="reference internal" href="#module-orb.constants">orb.constants module</a></li>
<li class="toctree-l2"><a class="reference internal" href="#module-orb.core">orb.core module</a></li>
<li class="toctree-l2"><a class="reference internal" href="#module-orb.cutils">orb.cutils module</a></li>
<li class="toctree-l2"><a class="reference internal" href="#module-orb.etc">orb.etc module</a></li>
<li class="toctree-l2"><a class="reference internal" href="#module-orb.fit">orb.fit module</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="code_utils.html">Code documentation: utils modules</a></li>
</ul>

            
          
        </div>
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap">

      
      <nav class="wy-nav-top" aria-label="top navigation">
        
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="index.html">orb</a>
        
      </nav>


      <div class="wy-nav-content">
        
        <div class="rst-content">
        
          















<div role="navigation" aria-label="breadcrumbs navigation">

  <ul class="wy-breadcrumbs">
    
      <li><a href="index.html">Docs</a> &raquo;</li>
        
      <li>Code documentation: core modules</li>
    
    
      <li class="wy-breadcrumbs-aside">
        
            
            <a href="_sources/code.rst.txt" rel="nofollow"> View page source</a>
          
        
      </li>
    
  </ul>

  
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
            
  <div class="section" id="code-documentation-core-modules">
<h1>Code documentation: core modules<a class="headerlink" href="#code-documentation-core-modules" title="Permalink to this headline">¶</a></h1>
<div class="section" id="module-orb.astrometry">
<span id="orb-astrometry-module"></span><h2>orb.astrometry module<a class="headerlink" href="#module-orb.astrometry" title="Permalink to this headline">¶</a></h2>
<p>The Astrometry module is aimed to manage all astrometry processes:
Fitting star position and photometry for alignement and cubes merging.</p>
<dl class="class">
<dt id="orb.astrometry.Aligner">
<em class="property">class </em><code class="descclassname">orb.astrometry.</code><code class="descname">Aligner</code><span class="sig-paren">(</span><em>image1</em>, <em>image2</em>, <em>fwhm_arc</em>, <em>fov1</em>, <em>fov2</em>, <em>bin1</em>, <em>bin2</em>, <em>pix_size1</em>, <em>pix_size2</em>, <em>init_angle</em>, <em>init_dx</em>, <em>init_dy</em>, <em>sip1=None</em>, <em>sip2=None</em>, <em>saturation_threshold=60000</em>, <em>project_header=[]</em>, <em>overwrite=False</em>, <em>**kwargs</em><span class="sig-paren">)</span><a class="headerlink" href="#orb.astrometry.Aligner" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <a class="reference internal" href="#orb.core.Tools" title="orb.core.Tools"><code class="xref py py-class docutils literal notranslate"><span class="pre">orb.core.Tools</span></code></a></p>
<p>This class is aimed to align two images of the same field of
stars and correct for optical distortions.</p>
<p>Primarily designed to align the cube of the camera 2 onto the cube
of the camera 1 it can be used to align any other kind of images
containing stars.</p>
<dl class="attribute">
<dt id="orb.astrometry.Aligner.astro1">
<code class="descname">astro1</code><em class="property"> = None</em><a class="headerlink" href="#orb.astrometry.Aligner.astro1" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="attribute">
<dt id="orb.astrometry.Aligner.astro2">
<code class="descname">astro2</code><em class="property"> = None</em><a class="headerlink" href="#orb.astrometry.Aligner.astro2" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="attribute">
<dt id="orb.astrometry.Aligner.bin1">
<code class="descname">bin1</code><em class="property"> = None</em><a class="headerlink" href="#orb.astrometry.Aligner.bin1" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="attribute">
<dt id="orb.astrometry.Aligner.bin2">
<code class="descname">bin2</code><em class="property"> = None</em><a class="headerlink" href="#orb.astrometry.Aligner.bin2" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="method">
<dt id="orb.astrometry.Aligner.compute_alignment_parameters">
<code class="descname">compute_alignment_parameters</code><span class="sig-paren">(</span><em>correct_distortion=False</em>, <em>star_list_path1=None</em>, <em>fwhm_arc=None</em>, <em>brute_force=True</em><span class="sig-paren">)</span><a class="headerlink" href="#orb.astrometry.Aligner.compute_alignment_parameters" title="Permalink to this definition">¶</a></dt>
<dd><p>Return the alignment coefficients that match the stars of the
frame 2 to the stars of the frame 1.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first last simple">
<li><strong>correct_distortion</strong> – (Optional) If True, a SIP is computed to
match stars from frame 2 onto the stars from frame 1. But it
needs a lot of stars to run correctly (default False).</li>
<li><strong>star_list_path1</strong> – (Optional) Path to a list of stars in
the image 1. If given the fwhm_arc must also be set (default None).</li>
<li><strong>fwhm_arc</strong> – (Optional) mean FWHM of the stars in
arcseconds. Must be given if star_list_path1 is not None
(default None).</li>
<li><strong>brute_force</strong> – (Optional) If True the first step is a
brute force guess. This is very useful if the initial
parameters are not well known (default True).</li>
</ul>
</td>
</tr>
</tbody>
</table>
<div class="admonition note">
<p class="first admonition-title">Note</p>
<p>The alignement coefficients are:</p>
<ul class="last simple">
<li>dx : shift along x axis in pixels</li>
<li>dy : shift along y axis in pixels</li>
<li>dr : rotation angle between images (the center of rotation
is the center of the images of the camera 1) in degrees</li>
<li>da : tip angle between cameras (along x axis) in degrees</li>
<li>db : tilt angle between cameras (along y axis) in degrees</li>
</ul>
</div>
<div class="admonition note">
<p class="first admonition-title">Note</p>
<p>The process tries to find the stars detected in the camera A in the frame of the camera B. It goes through 2 steps:</p>
<ol class="last arabic simple">
<li>Rough alignment (brute force style) only looking over
dx, dy. dr is kept to its initial value (init_angle), da
and db are set to 0.</li>
<li>Fine alignment pass.</li>
</ol>
</div>
<div class="admonition warning">
<p class="first admonition-title">Warning</p>
<p class="last">This alignment process do not work if the initial
parameters are too far from the real value. The angle must
be known within a few degrees. The shift must be known
within 4 % of the frame size (The latter can be changed
using the SIZE_COEFF constant)</p>
</div>
</dd></dl>

<dl class="attribute">
<dt id="orb.astrometry.Aligner.da">
<code class="descname">da</code><em class="property"> = None</em><a class="headerlink" href="#orb.astrometry.Aligner.da" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="attribute">
<dt id="orb.astrometry.Aligner.db">
<code class="descname">db</code><em class="property"> = None</em><a class="headerlink" href="#orb.astrometry.Aligner.db" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="attribute">
<dt id="orb.astrometry.Aligner.dr">
<code class="descname">dr</code><em class="property"> = None</em><a class="headerlink" href="#orb.astrometry.Aligner.dr" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="attribute">
<dt id="orb.astrometry.Aligner.dx">
<code class="descname">dx</code><em class="property"> = None</em><a class="headerlink" href="#orb.astrometry.Aligner.dx" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="attribute">
<dt id="orb.astrometry.Aligner.dy">
<code class="descname">dy</code><em class="property"> = None</em><a class="headerlink" href="#orb.astrometry.Aligner.dy" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="attribute">
<dt id="orb.astrometry.Aligner.image1">
<code class="descname">image1</code><em class="property"> = None</em><a class="headerlink" href="#orb.astrometry.Aligner.image1" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="attribute">
<dt id="orb.astrometry.Aligner.image2">
<code class="descname">image2</code><em class="property"> = None</em><a class="headerlink" href="#orb.astrometry.Aligner.image2" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="attribute">
<dt id="orb.astrometry.Aligner.pix_size1">
<code class="descname">pix_size1</code><em class="property"> = None</em><a class="headerlink" href="#orb.astrometry.Aligner.pix_size1" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="attribute">
<dt id="orb.astrometry.Aligner.pix_size2">
<code class="descname">pix_size2</code><em class="property"> = None</em><a class="headerlink" href="#orb.astrometry.Aligner.pix_size2" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="method">
<dt id="orb.astrometry.Aligner.print_alignment_coeffs">
<code class="descname">print_alignment_coeffs</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#orb.astrometry.Aligner.print_alignment_coeffs" title="Permalink to this definition">¶</a></dt>
<dd><p>Print the alignement coefficients.</p>
</dd></dl>

<dl class="attribute">
<dt id="orb.astrometry.Aligner.rc">
<code class="descname">rc</code><em class="property"> = None</em><a class="headerlink" href="#orb.astrometry.Aligner.rc" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="attribute">
<dt id="orb.astrometry.Aligner.saturation_threshold">
<code class="descname">saturation_threshold</code><em class="property"> = None</em><a class="headerlink" href="#orb.astrometry.Aligner.saturation_threshold" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="attribute">
<dt id="orb.astrometry.Aligner.search_size_coeff">
<code class="descname">search_size_coeff</code><em class="property"> = None</em><a class="headerlink" href="#orb.astrometry.Aligner.search_size_coeff" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="attribute">
<dt id="orb.astrometry.Aligner.sip1">
<code class="descname">sip1</code><em class="property"> = None</em><a class="headerlink" href="#orb.astrometry.Aligner.sip1" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="attribute">
<dt id="orb.astrometry.Aligner.sip2">
<code class="descname">sip2</code><em class="property"> = None</em><a class="headerlink" href="#orb.astrometry.Aligner.sip2" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="attribute">
<dt id="orb.astrometry.Aligner.zoom_factor">
<code class="descname">zoom_factor</code><em class="property"> = None</em><a class="headerlink" href="#orb.astrometry.Aligner.zoom_factor" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

</dd></dl>

<dl class="class">
<dt id="orb.astrometry.Astrometry">
<em class="property">class </em><code class="descclassname">orb.astrometry.</code><code class="descname">Astrometry</code><span class="sig-paren">(</span><em>data</em>, <em>profile_name=None</em>, <em>fwhm_arc=None</em>, <em>detect_stack=None</em>, <em>fit_tol=0.01</em>, <em>moffat_beta=None</em>, <em>star_list_path=None</em>, <em>box_size_coeff=7.0</em>, <em>check_mask=True</em>, <em>reduced_chi_square_limit=1.5</em>, <em>readout_noise=10.0</em>, <em>dark_current_level=0.0</em>, <em>target_radec=None</em>, <em>target_xy=None</em>, <em>wcs_rotation=None</em>, <em>sip=None</em>, <em>**kwargs</em><span class="sig-paren">)</span><a class="headerlink" href="#orb.astrometry.Astrometry" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <a class="reference internal" href="#orb.core.Tools" title="orb.core.Tools"><code class="xref py py-class docutils literal notranslate"><span class="pre">orb.core.Tools</span></code></a></p>
<p>Manage all astrometrical processes that can be made on a single
frame of a whole cube.</p>
<p>This class can detect stars in the given data and return fit
parameters. Fit parameters are returned as a
<code class="xref py py-class docutils literal notranslate"><span class="pre">StarsParams</span></code> object used to store and access
fit parameters.</p>
<p>Possible fitting profiles are at least Gaussian and Moffat. Other
profiles can be created by expanding <code class="xref py py-class docutils literal notranslate"><span class="pre">PSF</span></code>
class.</p>
<dl class="attribute">
<dt id="orb.astrometry.Astrometry.DETECT_INDEX">
<code class="descname">DETECT_INDEX</code><em class="property"> = 0</em><a class="headerlink" href="#orb.astrometry.Astrometry.DETECT_INDEX" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="method">
<dt id="orb.astrometry.Astrometry.arc2pix">
<code class="descname">arc2pix</code><span class="sig-paren">(</span><em>x</em><span class="sig-paren">)</span><a class="headerlink" href="#orb.astrometry.Astrometry.arc2pix" title="Permalink to this definition">¶</a></dt>
<dd><p>Convert pixels to arcseconds</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><strong>x</strong> – a value or a vector in pixel</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="method">
<dt id="orb.astrometry.Astrometry.detect_all_sources">
<code class="descname">detect_all_sources</code><span class="sig-paren">(</span><em>use_deep_frame=False</em>, <em>realign=False</em><span class="sig-paren">)</span><a class="headerlink" href="#orb.astrometry.Astrometry.detect_all_sources" title="Permalink to this definition">¶</a></dt>
<dd><p>Detect all point sources in the cube regardless of there FWHM.</p>
<p>Galaxies, HII regions, filamentary knots and stars might be
detected.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first last simple">
<li><strong>use_deep_frame</strong> – (Optional) If True a deep frame of the
cube is used instead of combinig only the first frames
(default False).</li>
<li><strong>realign</strong> – (Optional) Realign frames with a
cross-correlation algorithm (default False). Much better if
used on a small number of frames.</li>
</ul>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="method">
<dt id="orb.astrometry.Astrometry.detect_stars">
<code class="descname">detect_stars</code><span class="sig-paren">(</span><em>min_star_number=4</em>, <em>no_save=False</em>, <em>saturation_threshold=35000</em>, <em>try_catalogue=False</em>, <em>use_deep_frame=False</em>, <em>r_max_coeff=0.6</em>, <em>filter_image=True</em>, <em>realign=False</em><span class="sig-paren">)</span><a class="headerlink" href="#orb.astrometry.Astrometry.detect_stars" title="Permalink to this definition">¶</a></dt>
<dd><p>Detect star positions in data.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first simple">
<li><strong>index</strong> – Minimum index of the images used for star detection.</li>
<li><strong>min_star_number</strong> – Minimum number of stars to
detect. Must be greater or equal to 4 (minimum star number
for any alignment process).</li>
<li><strong>no_save</strong> – (Optional) If True do not save the list of
detected stars in a file, only return a list (default
False).</li>
<li><strong>saturation_threshold</strong> – (Optional) Number of counts above
which the star can be considered as saturated. Very low by
default because at the ZPD the intensity of a star can be
twice the intensity far from it (default 35000).</li>
<li><strong>try_catalogue</strong> – (Optional) If True, try to use a star
catalogue (e.g. USNO-B1) to detect stars if target_ra,
target_dec, target_x, target_y and wcs_rotation parameters
have been given (see
<code class="xref py py-meth docutils literal notranslate"><span class="pre">astrometry.Astrometry.query_vizier()</span></code>, default
False).</li>
<li><strong>use_deep_frame</strong> – (Optional) If True a deep frame of the
cube is used instead of combining only the first frames
(default False).</li>
<li><strong>r_max_coeff</strong> – (Optional) Coefficient that sets the limit
radius of the stars (default 0.6).</li>
<li><strong>filter_image</strong> – (Optional) If True, image is filtered
before detection to remove nebulosities (default True).</li>
<li><strong>realign</strong> – (Optional) Realign frames with a
cross-correlation algorithm (default False). Much better if
used on a small number of frames.</li>
</ul>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><p class="first last">(star_list_path, mean_fwhm_arc) : (a path to a list
of the dected stars, the mean FWHM of the stars in arcsec)</p>
</td>
</tr>
</tbody>
</table>
<div class="admonition note">
<p class="first admonition-title">Note</p>
<p>Star detection walks through 2 steps:</p>
<ol class="last arabic simple">
<li>Preselection of 4 times the minimum number of stars to
detect using a variable threshold with a filter for hot
pixels and stars near the border of the image.</li>
<li>Stars are fitted to test if they are ‘real’ stars. The
most luminous stars (that do not saturate) are
eventually taken.</li>
</ol>
</div>
</dd></dl>

<dl class="method">
<dt id="orb.astrometry.Astrometry.detect_stars_from_catalogue">
<code class="descname">detect_stars_from_catalogue</code><span class="sig-paren">(</span><em>min_star_number=4</em>, <em>no_save=False</em>, <em>saturation_threshold=35000</em>, <em>realign=False</em><span class="sig-paren">)</span><a class="headerlink" href="#orb.astrometry.Astrometry.detect_stars_from_catalogue" title="Permalink to this definition">¶</a></dt>
<dd><p>Detect star positions in data from a catalogue.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first simple">
<li><strong>index</strong> – Minimum index of the images used for star detection.</li>
<li><strong>min_star_number</strong> – Minimum number of stars to
detect. Must be greater or equal to 4 (minimum star number
for any alignment process).</li>
<li><strong>no_save</strong> – if True do not save the list of detected stars
in a file, only return a list (default False).</li>
<li><strong>saturation_threshold</strong> – Number of counts above which the
star can be considered as saturated. Very low by default
because at the ZPD the intensity of a star can be twice the
intensity far from it (default 35000).</li>
<li><strong>realign</strong> – (Optional) Realign frames with a
cross-correlation algorithm (default False). Much better if
used on a small number of frames.</li>
</ul>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><p class="first last">(star_list_path, mean_fwhm_arc) : (a path to a list
of the dected stars, the mean FWHM of the stars in arcsec)</p>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="method">
<dt id="orb.astrometry.Astrometry.fit_sip">
<code class="descname">fit_sip</code><span class="sig-paren">(</span><em>star_list1</em>, <em>star_list2</em>, <em>params=None</em>, <em>init_sip=None</em>, <em>err=None</em>, <em>sip_order=2</em>, <em>crpix=None</em>, <em>crval=None</em><span class="sig-paren">)</span><a class="headerlink" href="#orb.astrometry.Astrometry.fit_sip" title="Permalink to this definition">¶</a></dt>
<dd><p>FIT the distortion correction polynomial to match two lists
of stars (the list of stars 2 is distorded to match the list
of stars 1).</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first last simple">
<li><strong>star_list1</strong> – list of stars 1</li>
<li><strong>star_list2</strong> – list of stars 2</li>
<li><strong>params</strong> – (Optional) Transformation parameter to go from
the list of stars 1 to the list of stars 2. Must be a tuple
[dx, dy, dr, da, db, rcx, rcy, zoom_factor] (default None).</li>
<li><strong>init_sip</strong> – (Optional) Initial SIP (an astropy.wcs.WCS object,
default None)</li>
<li><strong>err</strong> – (Optional) error on the star positions of the star
list 2 (default None).</li>
<li><strong>sip_order</strong> – (Optional) SIP order (default 3).</li>
<li><strong>crpix</strong> – (Optional) If an initial wcs is not given (init_sip
set to None) this header value must be given.</li>
<li><strong>crval</strong> – (Optional) If an initial wcs is not given (init_sip
set to None) this header value must be given.</li>
</ul>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="method">
<dt id="orb.astrometry.Astrometry.fit_stars_in_cube">
<code class="descname">fit_stars_in_cube</code><span class="sig-paren">(</span><em>correct_alignment=False</em>, <em>save=False</em>, <em>add_cube=None</em>, <em>hpfilter=False</em>, <em>fix_height=True</em>, <em>fix_beta=True</em>, <em>fix_fwhm=False</em>, <em>fwhm_min=0.5</em>, <em>local_background=True</em>, <em>no_aperture_photometry=False</em>, <em>fix_aperture_size=False</em>, <em>precise_guess=False</em>, <em>aper_coeff=3.0</em>, <em>blur=False</em>, <em>no_fit=False</em>, <em>estimate_local_noise=True</em>, <em>multi_fit=False</em>, <em>enable_zoom=False</em>, <em>enable_rotation=False</em>, <em>saturation=None</em><span class="sig-paren">)</span><a class="headerlink" href="#orb.astrometry.Astrometry.fit_stars_in_cube" title="Permalink to this definition">¶</a></dt>
<dd><p>Fit stars in the cube.</p>
<p>Frames must not be too disaligned. Disalignment can be
corrected as the cube is fitted by setting correct_alignment
option to True.</p>
<div class="admonition note">
<p class="first admonition-title">Note</p>
<p>2 fitting modes are possible:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="o">*</span> <span class="n">Individual</span> <span class="n">fit</span> <span class="n">mode</span> <span class="p">[</span><span class="n">multi_fit</span><span class="o">=</span><span class="kc">False</span><span class="p">]</span>
<span class="o">*</span> <span class="n">Multi</span> <span class="n">fit</span> <span class="n">mode</span> <span class="p">[</span><span class="n">multi_fit</span><span class="o">=</span><span class="kc">True</span><span class="p">]</span>
</pre></div>
</div>
<p class="last">see <code class="xref py py-meth docutils literal notranslate"><span class="pre">astrometry.utils.fit_stars_in_frame()</span></code> for more
information.</p>
</div>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first last simple">
<li><strong>correct_alignment</strong> – (Optional) If True, the initial star
positions from the star list are corrected by their last
recorded deviation. Useful when the cube is smoothly
disaligned from one frame to the next.</li>
<li><strong>save</strong> – (Optional) If True save the fit results in a file
(default True).</li>
<li><strong>add_cube</strong> – (Optional) A tuple [Cube instance,
coeff]. This cube is added to the data before the fit so
that the fitted data is self.data[] + coeff * Cube[].</li>
<li><strong>hpfilter</strong> – (Optional) If True, frames are HP filtered
before fitting stars. Useful for alignment purpose if there
are too much nebulosities in the frames. This option must
not be used for photometry (default False).</li>
<li><strong>fix_height</strong> – (Optional) see
<a href="#id1"><span class="problematic" id="id2">:paramref:`utils.astrometry.fit_stars_in_frame.fix_height`</span></a>
(default True)</li>
<li><strong>fix_beta</strong> – (Optional) see
<a href="#id3"><span class="problematic" id="id4">:paramref:`utils.astrometry.fit_stars_in_frame.fix_beta`</span></a> (default
True).</li>
<li><strong>fix_fwhm</strong> – (Optional) see
<a href="#id5"><span class="problematic" id="id6">:paramref:`utils.astrometry.fit_stars_in_frame.fix_fwhm`</span></a>
(default False)</li>
<li><strong>fwhm_min</strong> – (Optional) see
<a href="#id7"><span class="problematic" id="id8">:paramref:`utils.astrometry.fit_stars_in_frame.fix_min`</span></a> (default
0.5)</li>
<li><strong>local_background</strong> – (Optional) see
<a href="#id9"><span class="problematic" id="id10">:paramref:`utils.astrometry.fit_stars_in_frame.local_background`</span></a>
(default True).</li>
<li><strong>no_aperture_photometry</strong> – (Optional) see
<a href="#id11"><span class="problematic" id="id12">:paramref:`utils.astrometry.fit_stars_in_frame.no_aperture_photometry`</span></a>
(default False).</li>
<li><strong>fix_aperture_size</strong> – (Optional) see
<a href="#id13"><span class="problematic" id="id14">:paramref:`utils.astrometry.fit_stars_in_frame.fix_aperture_size`</span></a>
(default False).</li>
<li><strong>precise_guess</strong> – (Optional) see
<a href="#id15"><span class="problematic" id="id16">:paramref:`utils.astrometry.fit_stars_in_frame.precise_guess`</span></a>
(default False).</li>
<li><strong>aper_coeff</strong> – (Optional) see
<a href="#id17"><span class="problematic" id="id18">:paramref:`utils.astrometry.fit_stars_in_frame.aper_coeff`</span></a>
(default 3).</li>
<li><strong>blur</strong> – (Optional) see
<a href="#id19"><span class="problematic" id="id20">:paramref:`utils.astrometry.fit_stars_in_frame.blur`</span></a> (default
False).</li>
<li><strong>no_fit</strong> – (Optional) see
<a href="#id21"><span class="problematic" id="id22">:paramref:`utils.astrometry.fit_stars_in_frame.no_fit`</span></a> (default
False).</li>
<li><strong>estimate_local_noise</strong> – (Optional) see
<a href="#id23"><span class="problematic" id="id24">:paramref:`utils.astrometry.fit_stars_in_frame.estimate_local_noise`</span></a>
(default True).</li>
<li><strong>multi_fit</strong> – (Optional) see
<a href="#id25"><span class="problematic" id="id26">:paramref:`utils.astrometry.fit_stars_in_frame.multi_fit`</span></a> (default
False).</li>
<li><strong>enable_zoom</strong> – (Optional) see
<a href="#id27"><span class="problematic" id="id28">:paramref:`utils.astrometry.fit_stars_in_frame.enable_zoom`</span></a>
(default False).</li>
<li><strong>enable_rotation</strong> – (Optional) see
<a href="#id29"><span class="problematic" id="id30">:paramref:`utils.astrometry.fit_stars_in_frame.enable_rotation`</span></a>
(default False).</li>
<li><strong>saturation</strong> – (Optional) see
<a href="#id31"><span class="problematic" id="id32">:paramref:`utils.astrometry.fit_stars_in_frame.saturation`</span></a>
(default None).</li>
</ul>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="method">
<dt id="orb.astrometry.Astrometry.fit_stars_in_frame">
<code class="descname">fit_stars_in_frame</code><span class="sig-paren">(</span><em>index</em>, <em>save=False</em>, <em>**kwargs</em><span class="sig-paren">)</span><a class="headerlink" href="#orb.astrometry.Astrometry.fit_stars_in_frame" title="Permalink to this definition">¶</a></dt>
<dd><p>Fit stars in one frame.</p>
<p>This function is basically a wrapper around
<code class="xref py py-meth docutils literal notranslate"><span class="pre">utils.astrometry.fit_stars_in_frame()</span></code>.</p>
<div class="admonition note">
<p class="first admonition-title">Note</p>
<p>2 fitting modes are possible:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="o">*</span> <span class="n">Individual</span> <span class="n">fit</span> <span class="n">mode</span> <span class="p">[</span><span class="n">multi_fit</span><span class="o">=</span><span class="kc">False</span><span class="p">]</span>
<span class="o">*</span> <span class="n">Multi</span> <span class="n">fit</span> <span class="n">mode</span> <span class="p">[</span><span class="n">multi_fit</span><span class="o">=</span><span class="kc">True</span><span class="p">]</span>
</pre></div>
</div>
<p class="last">see <code class="xref py py-meth docutils literal notranslate"><span class="pre">utils.astrometry.fit_stars_in_frame()</span></code> for more
information.</p>
</div>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first last simple">
<li><strong>index</strong> – Index of the frame to fit. If index is a frame,
this frame is used instead.</li>
<li><strong>save</strong> – (Optional) If True save the fit results in a file
(default True).</li>
<li><strong>kwargs</strong> – Same optional arguments as for
<code class="xref py py-meth docutils literal notranslate"><span class="pre">utils.astrometry.fit_stars_in_frame()</span></code>.</li>
</ul>
</td>
</tr>
</tbody>
</table>
<div class="admonition warning">
<p class="first admonition-title">Warning</p>
<p>Some optional arguments are taken directly from the
values computed at the init of the Class. The following
optional arguments thus cannot be passed:</p>
<div class="last highlight-default notranslate"><div class="highlight"><pre><span></span><span class="o">*</span> <span class="n">profile_name</span>
<span class="o">*</span> <span class="n">scale</span>
<span class="o">*</span> <span class="n">fwhm_pix</span>
<span class="o">*</span> <span class="n">beta</span>
<span class="o">*</span> <span class="n">fit_tol</span>
<span class="o">*</span> <span class="n">readout_noise</span>
<span class="o">*</span> <span class="n">dark_current_level</span>
</pre></div>
</div>
</div>
</dd></dl>

<dl class="method">
<dt id="orb.astrometry.Astrometry.fwhm">
<code class="descname">fwhm</code><span class="sig-paren">(</span><em>x</em><span class="sig-paren">)</span><a class="headerlink" href="#orb.astrometry.Astrometry.fwhm" title="Permalink to this definition">¶</a></dt>
<dd><p>Return fwhm from width</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><strong>x</strong> – width</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="method">
<dt id="orb.astrometry.Astrometry.get_alignment_vectors">
<code class="descname">get_alignment_vectors</code><span class="sig-paren">(</span><em>fit_cube=False</em>, <em>min_coeff=0.2</em><span class="sig-paren">)</span><a class="headerlink" href="#orb.astrometry.Astrometry.get_alignment_vectors" title="Permalink to this definition">¶</a></dt>
<dd><p>Return alignement vectors</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first last simple">
<li><strong>fit_cube</strong> – (Optional) If True, the cube is fitted before
using the fit results to create the alignement vectors. Else
the vectors are created using the fit results already in
memory (default False).</li>
<li><strong>min_coeff</strong> – The minimum proportion of stars correctly
fitted to assume a good enough calculated disalignment
(default 0.2).</li>
</ul>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="method">
<dt id="orb.astrometry.Astrometry.load_fit_results">
<code class="descname">load_fit_results</code><span class="sig-paren">(</span><em>fit_results_path=None</em><span class="sig-paren">)</span><a class="headerlink" href="#orb.astrometry.Astrometry.load_fit_results" title="Permalink to this definition">¶</a></dt>
<dd><p>Load a file containing the fit results</p>
</dd></dl>

<dl class="method">
<dt id="orb.astrometry.Astrometry.load_star_list">
<code class="descname">load_star_list</code><span class="sig-paren">(</span><em>star_list_path</em><span class="sig-paren">)</span><a class="headerlink" href="#orb.astrometry.Astrometry.load_star_list" title="Permalink to this definition">¶</a></dt>
<dd><p>Load a list of stars coordinates</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><strong>star_list_path</strong> – The path to the star list file.</td>
</tr>
</tbody>
</table>
<div class="admonition seealso">
<p class="first admonition-title">See also</p>
<p class="last"><code class="xref py py-meth docutils literal notranslate"><span class="pre">astrometry.load_star_list()</span></code></p>
</div>
</dd></dl>

<dl class="method">
<dt id="orb.astrometry.Astrometry.pix2arc">
<code class="descname">pix2arc</code><span class="sig-paren">(</span><em>x</em><span class="sig-paren">)</span><a class="headerlink" href="#orb.astrometry.Astrometry.pix2arc" title="Permalink to this definition">¶</a></dt>
<dd><p>Convert arcseconds to pixels</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><strong>x</strong> – a value or a vector in arcsec</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="attribute">
<dt id="orb.astrometry.Astrometry.profiles">
<code class="descname">profiles</code><em class="property"> = ['moffat', 'gaussian']</em><a class="headerlink" href="#orb.astrometry.Astrometry.profiles" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="method">
<dt id="orb.astrometry.Astrometry.query_vizier">
<code class="descname">query_vizier</code><span class="sig-paren">(</span><em>catalog='gaia'</em>, <em>max_stars=100</em><span class="sig-paren">)</span><a class="headerlink" href="#orb.astrometry.Astrometry.query_vizier" title="Permalink to this definition">¶</a></dt>
<dd><p>Return a list of star coordinates around an object in a
given radius based on a query to VizieR Services
(<a class="reference external" href="http://vizier.u-strasbg.fr/viz-bin/VizieR">http://vizier.u-strasbg.fr/viz-bin/VizieR</a>)</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first last simple">
<li><strong>catalog</strong> – (Optional) Catalog to ask on the VizieR
database (see notes) (default ‘gaia’)</li>
<li><strong>max_stars</strong> – (Optional) Maximum number of row to retrieve
(default 100)</li>
</ul>
</td>
</tr>
</tbody>
</table>
<div class="admonition seealso">
<p class="first admonition-title">See also</p>
<p class="last"><a class="reference internal" href="code_utils.html#orb.utils.web.query_vizier" title="orb.utils.web.query_vizier"><code class="xref py py-meth docutils literal notranslate"><span class="pre">orb.utils.web.query_vizier()</span></code></a></p>
</div>
</dd></dl>

<dl class="method">
<dt id="orb.astrometry.Astrometry.register">
<code class="descname">register</code><span class="sig-paren">(</span><em>max_stars_detect=60</em>, <em>full_deep_frame=False</em>, <em>return_fit_params=False</em>, <em>rscale_coeff=1.0</em>, <em>compute_precision=True</em>, <em>compute_distortion=False</em>, <em>realign=False</em>, <em>return_error_maps=False</em>, <em>return_error_spl=False</em><span class="sig-paren">)</span><a class="headerlink" href="#orb.astrometry.Astrometry.register" title="Permalink to this definition">¶</a></dt>
<dd><p>Register data and return a corrected pywcs.WCS
object.</p>
<p>Optionally (if return_error_maps set to True or
return_error_spl set to True) 2 distortion maps used to refine
a calculated SIP distortion model are returned.</p>
<p>Precise RA/DEC positions of the stars in the field are
recorded from a catalog of the VIZIER server.</p>
<p>Using the real position of the same stars in the frame, WCS
transformation parameters are optimized va a SIP model.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first last simple">
<li><strong>max_stars_detect</strong> – (Optional) Number of detected stars
in the frame for the initial wcs parameters (default 60).</li>
<li><strong>full_deep_frame</strong> – (Optional) If True all the frames of
the cube are used to create a deep frame. Use it only when
the frames in the cube are aligned. In the other case only
the first frames are combined together (default False).</li>
<li><strong>return_fit_params</strong> – (Optional) If True return final fit
parameters instead of wcs (default False).</li>
<li><strong>rscale_coeff</strong> – (Optional) Coefficient on the maximum
radius of the fitted stars to compute scale. When rscale_coeff
= 1, rmax is half the longer side of the image (default 1).</li>
<li><strong>compute_distortion</strong> – (Optional) If True, optical
distortion (SIP) are computed. Note that a frame with a lot
of stars is better for this purpose (default False).</li>
<li><strong>compute_precision</strong> – (Optional) If True, astrometrical
precision is computed (default True).</li>
<li><strong>realign</strong> – (Optional) Realign frames with a
cross-correlation algorithm (default False). Much better if
used on a small number of frames.</li>
<li><strong>return_error_maps</strong> – (Optional) If True, error maps
(200x200 pixels) on the registration are returned (default
False).</li>
<li><strong>return_error_spl</strong> – (Optional) If True, error maps on the
registration are returned as
scipy.interpolate.RectBivariateSpline instances (default
False).</li>
</ul>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="method">
<dt id="orb.astrometry.Astrometry.reset_box_size">
<code class="descname">reset_box_size</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#orb.astrometry.Astrometry.reset_box_size" title="Permalink to this definition">¶</a></dt>
<dd><p>Reset box size attribute. Useful if FWHM or scale has been
modified after class init.</p>
</dd></dl>

<dl class="method">
<dt id="orb.astrometry.Astrometry.reset_fwhm_arc">
<code class="descname">reset_fwhm_arc</code><span class="sig-paren">(</span><em>fwhm_arc</em><span class="sig-paren">)</span><a class="headerlink" href="#orb.astrometry.Astrometry.reset_fwhm_arc" title="Permalink to this definition">¶</a></dt>
<dd><p>Reset FWHM of stars in arcsec</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><strong>fwhm_arc</strong> – FWHM of stars in arcsec</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="method">
<dt id="orb.astrometry.Astrometry.reset_fwhm_pix">
<code class="descname">reset_fwhm_pix</code><span class="sig-paren">(</span><em>fwhm_pix</em><span class="sig-paren">)</span><a class="headerlink" href="#orb.astrometry.Astrometry.reset_fwhm_pix" title="Permalink to this definition">¶</a></dt>
<dd><p>Reset FWHM of stars in pixels</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><strong>fwhm_arc</strong> – FWHM of stars in pixels</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="method">
<dt id="orb.astrometry.Astrometry.reset_profile_name">
<code class="descname">reset_profile_name</code><span class="sig-paren">(</span><em>profile_name</em><span class="sig-paren">)</span><a class="headerlink" href="#orb.astrometry.Astrometry.reset_profile_name" title="Permalink to this definition">¶</a></dt>
<dd><p>Reset the name of the profile used.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><strong>profile_name</strong> – Name of the PSF profile to use for
fitting. Can be ‘moffat’ or ‘gaussian’.</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="method">
<dt id="orb.astrometry.Astrometry.reset_scale">
<code class="descname">reset_scale</code><span class="sig-paren">(</span><em>scale</em><span class="sig-paren">)</span><a class="headerlink" href="#orb.astrometry.Astrometry.reset_scale" title="Permalink to this definition">¶</a></dt>
<dd><p>Reset scale attribute.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><strong>scale</strong> – Frame scale in arcsec/pixel</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="method">
<dt id="orb.astrometry.Astrometry.reset_star_list">
<code class="descname">reset_star_list</code><span class="sig-paren">(</span><em>star_list</em><span class="sig-paren">)</span><a class="headerlink" href="#orb.astrometry.Astrometry.reset_star_list" title="Permalink to this definition">¶</a></dt>
<dd><p>Reset the list of stars</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><strong>star_list</strong> – An array of shape (star_nb, 2) giving the
positions in x and y of the stars.</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="method">
<dt id="orb.astrometry.Astrometry.set_deep_frame">
<code class="descname">set_deep_frame</code><span class="sig-paren">(</span><em>deep_frame_path</em><span class="sig-paren">)</span><a class="headerlink" href="#orb.astrometry.Astrometry.set_deep_frame" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="method">
<dt id="orb.astrometry.Astrometry.width">
<code class="descname">width</code><span class="sig-paren">(</span><em>x</em><span class="sig-paren">)</span><a class="headerlink" href="#orb.astrometry.Astrometry.width" title="Permalink to this definition">¶</a></dt>
<dd><p>Return width from fwhm</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><strong>x</strong> – fwhm.</td>
</tr>
</tbody>
</table>
</dd></dl>

</dd></dl>

<dl class="class">
<dt id="orb.astrometry.StarsParams">
<em class="property">class </em><code class="descclassname">orb.astrometry.</code><code class="descname">StarsParams</code><span class="sig-paren">(</span><em>star_nb=1</em>, <em>frame_nb=1</em>, <em>**kwargs</em><span class="sig-paren">)</span><a class="headerlink" href="#orb.astrometry.StarsParams" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <a class="reference internal" href="#orb.core.Tools" title="orb.core.Tools"><code class="xref py py-class docutils literal notranslate"><span class="pre">orb.core.Tools</span></code></a></p>
<p>StarsParams manage the parameters of each star in each frame of
a cube.</p>
<p>It can be accessed as a simple 3D array of shape (star_number,
frame_nb, parameter).</p>
<p>Additional methods provide an easy access to the data.</p>
<dl class="method">
<dt id="orb.astrometry.StarsParams.convert">
<code class="descname">convert</code><span class="sig-paren">(</span><em>data</em><span class="sig-paren">)</span><a class="headerlink" href="#orb.astrometry.StarsParams.convert" title="Permalink to this definition">¶</a></dt>
<dd><p>Convert StarsParams data to a new StarsParams instance.</p>
</dd></dl>

<dl class="method">
<dt id="orb.astrometry.StarsParams.get_star_list">
<code class="descname">get_star_list</code><span class="sig-paren">(</span><em>index=0</em>, <em>all_params=False</em><span class="sig-paren">)</span><a class="headerlink" href="#orb.astrometry.StarsParams.get_star_list" title="Permalink to this definition">¶</a></dt>
<dd><p>Return an array of the positions of the stars in one frame</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first last simple">
<li><strong>index</strong> – (Optional) The index of the frame to use to
create the list of stars (default 0)</li>
<li><strong>all_params</strong> – (Optional) If True, all params are
returned. Bad params are returned as NaN values.</li>
</ul>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="method">
<dt id="orb.astrometry.StarsParams.load_stars_params">
<code class="descname">load_stars_params</code><span class="sig-paren">(</span><em>params_file_path</em>, <em>group=None</em>, <em>silent=False</em><span class="sig-paren">)</span><a class="headerlink" href="#orb.astrometry.StarsParams.load_stars_params" title="Permalink to this definition">¶</a></dt>
<dd><p>Load a file containing stars parameters.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first last simple">
<li><strong>fit_results_path</strong> – Path to the file parameters</li>
<li><strong>silent</strong> – (Optional) If True, no message is printed
(default False).</li>
<li><strong>group</strong> – (Optional) Group path into the HDF5 file. If
None the group will be ‘/’ (default None).</li>
</ul>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="method">
<dt id="orb.astrometry.StarsParams.reset_data">
<code class="descname">reset_data</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#orb.astrometry.StarsParams.reset_data" title="Permalink to this definition">¶</a></dt>
<dd><p>Reset StarsParams data to an empty array</p>
</dd></dl>

<dl class="method">
<dt id="orb.astrometry.StarsParams.save_stars_params">
<code class="descname">save_stars_params</code><span class="sig-paren">(</span><em>params_file_path</em>, <em>group=None</em><span class="sig-paren">)</span><a class="headerlink" href="#orb.astrometry.StarsParams.save_stars_params" title="Permalink to this definition">¶</a></dt>
<dd><p>Save stars parameters in one file</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first last simple">
<li><strong>params_file_path</strong> – Path to the parameters file</li>
<li><strong>group</strong> – (Optional) Group path into the HDF5 file. If
None the group will be ‘/’ (default None).</li>
</ul>
</td>
</tr>
</tbody>
</table>
<div class="admonition warning">
<p class="first admonition-title">Warning</p>
<p class="last">if no group is given, the whole file will be
deleted if it already exists because new parameters will be
written in the root group.</p>
</div>
</dd></dl>

</dd></dl>

</div>
<div class="section" id="module-orb.cgvar">
<span id="orb-cgvar-module"></span><h2>orb.cgvar module<a class="headerlink" href="#module-orb.cgvar" title="Permalink to this headline">¶</a></h2>
<dl class="function">
<dt id="orb.cgvar.dawsni">
<code class="descclassname">orb.cgvar.</code><code class="descname">dawsni</code><span class="sig-paren">(</span><em>GVar im</em><span class="sig-paren">)</span><a class="headerlink" href="#orb.cgvar.dawsni" title="Permalink to this definition">¶</a></dt>
<dd><p>Dawson function for an imaginary float input</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><strong>im</strong> – Imaginary gvar.GVar input</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body">an imaginary gvar.GVar scalar</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="function">
<dt id="orb.cgvar.dawsni_dfdx">
<code class="descclassname">orb.cgvar.</code><code class="descname">dawsni_dfdx</code><span class="sig-paren">(</span><em>double im</em><span class="sig-paren">)</span><a class="headerlink" href="#orb.cgvar.dawsni_dfdx" title="Permalink to this definition">¶</a></dt>
<dd><p>Derivative of the dawson function for an imaginary input</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><strong>im</strong> – Imaginary input</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body">an imaginary float</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="function">
<dt id="orb.cgvar.sinc1d">
<code class="descclassname">orb.cgvar.</code><code class="descname">sinc1d</code><span class="sig-paren">(</span><em>x</em><span class="sig-paren">)</span><a class="headerlink" href="#orb.cgvar.sinc1d" title="Permalink to this definition">¶</a></dt>
<dd><p>sinc function</p>
</dd></dl>

<dl class="function">
<dt id="orb.cgvar.sinc_dfdx">
<code class="descclassname">orb.cgvar.</code><code class="descname">sinc_dfdx</code><span class="sig-paren">(</span><em>ndarray x</em><span class="sig-paren">)</span><a class="headerlink" href="#orb.cgvar.sinc_dfdx" title="Permalink to this definition">¶</a></dt>
<dd><p>Derivative of the sinc function</p>
</dd></dl>

<dl class="function">
<dt id="orb.cgvar.sincgauss1d">
<code class="descclassname">orb.cgvar.</code><code class="descname">sincgauss1d</code><span class="sig-paren">(</span><em>a</em>, <em>b</em>, <em>erf=False</em><span class="sig-paren">)</span><a class="headerlink" href="#orb.cgvar.sincgauss1d" title="Permalink to this definition">¶</a></dt>
<dd><p>sincgauss function</p>
</dd></dl>

<dl class="function">
<dt id="orb.cgvar.sincgauss1d_complex">
<code class="descclassname">orb.cgvar.</code><code class="descname">sincgauss1d_complex</code><span class="sig-paren">(</span><em>a</em>, <em>b</em>, <em>erf=False</em><span class="sig-paren">)</span><a class="headerlink" href="#orb.cgvar.sincgauss1d_complex" title="Permalink to this definition">¶</a></dt>
<dd><p>The “complex” version of the sincgauss (dawson definition).</p>
<p>This is the real sinc*gauss function when ones wants to fit both the real
part and the imaginary part of the spectrum.</p>
</dd></dl>

<dl class="function">
<dt id="orb.cgvar.sincgauss_real">
<code class="descclassname">orb.cgvar.</code><code class="descname">sincgauss_real</code><span class="sig-paren">(</span><em>double a</em>, <em>ndarray b</em><span class="sig-paren">)</span><a class="headerlink" href="#orb.cgvar.sincgauss_real" title="Permalink to this definition">¶</a></dt>
<dd><p>Sincgauss function of a and b which returns a real vector.</p>
</dd></dl>

<dl class="function">
<dt id="orb.cgvar.sincgauss_real_dfdx">
<code class="descclassname">orb.cgvar.</code><code class="descname">sincgauss_real_dfdx</code><span class="sig-paren">(</span><em>double a</em>, <em>ndarray b</em>, <em>erf=False</em>, <em>f_ab=None</em><span class="sig-paren">)</span><a class="headerlink" href="#orb.cgvar.sincgauss_real_dfdx" title="Permalink to this definition">¶</a></dt>
<dd><p>Partial derivatives wrt. a and b of the sincgauss function.</p>
<p>Returns real derivatives.</p>
</dd></dl>

<dl class="function">
<dt id="orb.cgvar.sincgauss_real_erf">
<code class="descclassname">orb.cgvar.</code><code class="descname">sincgauss_real_erf</code><span class="sig-paren">(</span><em>double a</em>, <em>ndarray b</em><span class="sig-paren">)</span><a class="headerlink" href="#orb.cgvar.sincgauss_real_erf" title="Permalink to this definition">¶</a></dt>
<dd><p>Sincgauss function (erf formulation) of a and b which returns a
real vector.</p>
</dd></dl>

<dl class="function">
<dt id="orb.cgvar.sincgausscomplex_real">
<code class="descclassname">orb.cgvar.</code><code class="descname">sincgausscomplex_real</code><span class="sig-paren">(</span><em>double a</em>, <em>ndarray b</em><span class="sig-paren">)</span><a class="headerlink" href="#orb.cgvar.sincgausscomplex_real" title="Permalink to this definition">¶</a></dt>
<dd><p>Sincgausscomplex function of a and b which returns two real
vectors instead of a complex vector.</p>
</dd></dl>

<dl class="function">
<dt id="orb.cgvar.sincgausscomplex_real_dfdx">
<code class="descclassname">orb.cgvar.</code><code class="descname">sincgausscomplex_real_dfdx</code><span class="sig-paren">(</span><em>double a</em>, <em>ndarray b</em><span class="sig-paren">)</span><a class="headerlink" href="#orb.cgvar.sincgausscomplex_real_dfdx" title="Permalink to this definition">¶</a></dt>
<dd><p>Partial derivatives wrt. a and b of the sincgauss function.</p>
<p>Returns real derivatives.</p>
</dd></dl>

<dl class="function">
<dt id="orb.cgvar.sincgausscomplex_real_dfdx_erf">
<code class="descclassname">orb.cgvar.</code><code class="descname">sincgausscomplex_real_dfdx_erf</code><span class="sig-paren">(</span><em>double a</em>, <em>ndarray b</em><span class="sig-paren">)</span><a class="headerlink" href="#orb.cgvar.sincgausscomplex_real_dfdx_erf" title="Permalink to this definition">¶</a></dt>
<dd><p>Partial derivatives (erf formulation) wrt. a and b of the
sincgauss function.</p>
<p>Returns real derivatives.</p>
</dd></dl>

<dl class="function">
<dt id="orb.cgvar.sincgausscomplex_real_erf">
<code class="descclassname">orb.cgvar.</code><code class="descname">sincgausscomplex_real_erf</code><span class="sig-paren">(</span><em>double a</em>, <em>ndarray b</em><span class="sig-paren">)</span><a class="headerlink" href="#orb.cgvar.sincgausscomplex_real_erf" title="Permalink to this definition">¶</a></dt>
<dd><p>Sincgausscomplex function (erf formulation) of a and b which returns two real
vectors instead of a complex vector.</p>
</dd></dl>

</div>
<div class="section" id="module-orb.constants">
<span id="orb-constants-module"></span><h2>orb.constants module<a class="headerlink" href="#module-orb.constants" title="Permalink to this headline">¶</a></h2>
<dl class="data">
<dt id="orb.constants.ATOMIC_MASS">
<code class="descclassname">orb.constants.</code><code class="descname">ATOMIC_MASS</code><em class="property"> = 1.66053886e-24</em><a class="headerlink" href="#orb.constants.ATOMIC_MASS" title="Permalink to this definition">¶</a></dt>
<dd><p>1 Atomic mass in g</p>
</dd></dl>

<dl class="data">
<dt id="orb.constants.FITS_CARD_MAX_STR_LENGTH">
<code class="descclassname">orb.constants.</code><code class="descname">FITS_CARD_MAX_STR_LENGTH</code><em class="property"> = 18</em><a class="headerlink" href="#orb.constants.FITS_CARD_MAX_STR_LENGTH" title="Permalink to this definition">¶</a></dt>
<dd><p>Max length of a FITS string card</p>
</dd></dl>

<dl class="data">
<dt id="orb.constants.FWHM_COEFF">
<code class="descclassname">orb.constants.</code><code class="descname">FWHM_COEFF</code><em class="property"> = 2.3548200450309493</em><a class="headerlink" href="#orb.constants.FWHM_COEFF" title="Permalink to this definition">¶</a></dt>
<dd><p>Coefficient used to convert the width of a gaussian function to its FWHM (line_fwhm = line_width * FWHM)</p>
</dd></dl>

<dl class="data">
<dt id="orb.constants.FWHM_SINC_COEFF">
<code class="descclassname">orb.constants.</code><code class="descname">FWHM_SINC_COEFF</code><em class="property"> = 1.20671</em><a class="headerlink" href="#orb.constants.FWHM_SINC_COEFF" title="Permalink to this definition">¶</a></dt>
<dd><p>Coefficien used to determine sinc fwhm</p>
</dd></dl>

<dl class="data">
<dt id="orb.constants.HEISEN">
<code class="descclassname">orb.constants.</code><code class="descname">HEISEN</code><em class="property"> = 6.6260755e-27</em><a class="headerlink" href="#orb.constants.HEISEN" title="Permalink to this definition">¶</a></dt>
<dd><p>Heisenberg constant in erg.s</p>
</dd></dl>

<dl class="data">
<dt id="orb.constants.K_BOLTZMANN">
<code class="descclassname">orb.constants.</code><code class="descname">K_BOLTZMANN</code><em class="property"> = 1.38064852e-16</em><a class="headerlink" href="#orb.constants.K_BOLTZMANN" title="Permalink to this definition">¶</a></dt>
<dd><p>Boltzmann constant in erg/K</p>
</dd></dl>

<dl class="data">
<dt id="orb.constants.LIGHT_VEL_KMS">
<code class="descclassname">orb.constants.</code><code class="descname">LIGHT_VEL_KMS</code><em class="property"> = 299792.458</em><a class="headerlink" href="#orb.constants.LIGHT_VEL_KMS" title="Permalink to this definition">¶</a></dt>
<dd><p>Velocity of the light in the vacuum in km.s-1</p>
</dd></dl>

<dl class="data">
<dt id="orb.constants.SESAME_URL">
<code class="descclassname">orb.constants.</code><code class="descname">SESAME_URL</code><em class="property"> = 'http://vizier.cfa.harvard.edu/viz-bin/nph-sesame/-oxp/SNVA?'</em><a class="headerlink" href="#orb.constants.SESAME_URL" title="Permalink to this definition">¶</a></dt>
<dd><p>Sesame URL</p>
</dd></dl>

<dl class="data">
<dt id="orb.constants.VIZIER_URL">
<code class="descclassname">orb.constants.</code><code class="descname">VIZIER_URL</code><em class="property"> = 'http://webviz.u-strasbg.fr/viz-bin/'</em><a class="headerlink" href="#orb.constants.VIZIER_URL" title="Permalink to this definition">¶</a></dt>
<dd><p>Vizier URL in Canada</p>
</dd></dl>

<dl class="data">
<dt id="orb.constants.VIZIER_URL_CA">
<code class="descclassname">orb.constants.</code><code class="descname">VIZIER_URL_CA</code><em class="property"> = 'http://vizier.hia.nrc.ca/viz-bin/'</em><a class="headerlink" href="#orb.constants.VIZIER_URL_CA" title="Permalink to this definition">¶</a></dt>
<dd><p>Vizier URL in Canada</p>
</dd></dl>

</div>
<div class="section" id="module-orb.core">
<span id="orb-core-module"></span><h2>orb.core module<a class="headerlink" href="#module-orb.core" title="Permalink to this headline">¶</a></h2>
<p>The Core module contains all the core classes of ORB.</p>
<dl class="class">
<dt id="orb.core.Axis">
<em class="property">class </em><code class="descclassname">orb.core.</code><code class="descname">Axis</code><span class="sig-paren">(</span><em>axis</em><span class="sig-paren">)</span><a class="headerlink" href="#orb.core.Axis" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <a class="reference internal" href="#orb.core.Vector1d" title="orb.core.Vector1d"><code class="xref py py-class docutils literal notranslate"><span class="pre">orb.core.Vector1d</span></code></a></p>
<p>Axis class</p>
</dd></dl>

<dl class="class">
<dt id="orb.core.ColorStreamHandler">
<em class="property">class </em><code class="descclassname">orb.core.</code><code class="descname">ColorStreamHandler</code><span class="sig-paren">(</span><em>stream=None</em><span class="sig-paren">)</span><a class="headerlink" href="#orb.core.ColorStreamHandler" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <a class="reference external" href="https://docs.python.org/3/library/logging.handlers.html#logging.StreamHandler" title="(in Python v3.7)"><code class="xref py py-class docutils literal notranslate"><span class="pre">logging.StreamHandler</span></code></a></p>
<p>Manage colored logging</p>
<p>copied from <a class="reference external" href="https://gist.github.com/mooware/a1ed40987b6cc9ab9c65">https://gist.github.com/mooware/a1ed40987b6cc9ab9c65</a></p>
<dl class="attribute">
<dt id="orb.core.ColorStreamHandler.CRITICAL">
<code class="descname">CRITICAL</code><em class="property"> = '\x1b[31m'</em><a class="headerlink" href="#orb.core.ColorStreamHandler.CRITICAL" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="attribute">
<dt id="orb.core.ColorStreamHandler.DEBUG">
<code class="descname">DEBUG</code><em class="property"> = '\x1b[36m'</em><a class="headerlink" href="#orb.core.ColorStreamHandler.DEBUG" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="attribute">
<dt id="orb.core.ColorStreamHandler.DEFAULT">
<code class="descname">DEFAULT</code><em class="property"> = '\x1b[0m'</em><a class="headerlink" href="#orb.core.ColorStreamHandler.DEFAULT" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="attribute">
<dt id="orb.core.ColorStreamHandler.ERROR">
<code class="descname">ERROR</code><em class="property"> = '\x1b[31m'</em><a class="headerlink" href="#orb.core.ColorStreamHandler.ERROR" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="attribute">
<dt id="orb.core.ColorStreamHandler.INFO">
<code class="descname">INFO</code><em class="property"> = '\x1b[0m'</em><a class="headerlink" href="#orb.core.ColorStreamHandler.INFO" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="attribute">
<dt id="orb.core.ColorStreamHandler.WARNING">
<code class="descname">WARNING</code><em class="property"> = '\x1b[33m'</em><a class="headerlink" href="#orb.core.ColorStreamHandler.WARNING" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="method">
<dt id="orb.core.ColorStreamHandler.format">
<code class="descname">format</code><span class="sig-paren">(</span><em>record</em><span class="sig-paren">)</span><a class="headerlink" href="#orb.core.ColorStreamHandler.format" title="Permalink to this definition">¶</a></dt>
<dd><p>Format the specified record.</p>
<p>If a formatter is set, use it. Otherwise, use the default formatter
for the module.</p>
</dd></dl>

</dd></dl>

<dl class="class">
<dt id="orb.core.Cube">
<em class="property">class </em><code class="descclassname">orb.core.</code><code class="descname">Cube</code><span class="sig-paren">(</span><em>data</em>, <em>project_header=[]</em>, <em>wcs_header=[]</em>, <em>calibration_laser_header=[]</em>, <em>overwrite=True</em>, <em>indexer=None</em>, <em>**kwargs</em><span class="sig-paren">)</span><a class="headerlink" href="#orb.core.Cube" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <a class="reference internal" href="#orb.core.Tools" title="orb.core.Tools"><code class="xref py py-class docutils literal notranslate"><span class="pre">orb.core.Tools</span></code></a></p>
<p>3d numpy data cube handling. Base class for all Cube classes</p>
<dl class="method">
<dt id="orb.core.Cube.export">
<code class="descname">export</code><span class="sig-paren">(</span><em>export_path</em>, <em>x_range=None</em>, <em>y_range=None</em>, <em>z_range=None</em>, <em>header=None</em>, <em>overwrite=False</em>, <em>force_hdf5=False</em>, <em>force_fits=False</em>, <em>calibration_laser_map_path=None</em>, <em>mask=None</em>, <em>deep_frame_path=None</em><span class="sig-paren">)</span><a class="headerlink" href="#orb.core.Cube.export" title="Permalink to this definition">¶</a></dt>
<dd><p>Export cube as one FITS/HDF5 file.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first last simple">
<li><strong>export_path</strong> – Path of the exported FITS file</li>
<li><strong>x_range</strong> – (Optional) Tuple (x_min, x_max) (default
None).</li>
<li><strong>y_range</strong> – (Optional) Tuple (y_min, y_max) (default
None).</li>
<li><strong>z_range</strong> – (Optional) Tuple (z_min, z_max) (default
None).</li>
<li><strong>header</strong> – (Optional) Header of the output file (default
None).</li>
<li><strong>overwrite</strong> – (Optional) Overwrite output file (default
False).</li>
<li><strong>force_hdf5</strong> – (Optional) If True, output is in HDF5
format even if the input files are FITS files. If False it
will be in the format of the input files (default False).</li>
<li><strong>force_fits</strong> – (Optional) If True, output is in FITS
format. If False it will be in the format of the input files
(default False).</li>
<li><strong>calibration_laser_map_path</strong> – (Optional) Path to a
calibration laser map to append (default None).</li>
<li><strong>deep_frame_path</strong> – (Optional) Path to a deep frame to
append (default None)</li>
<li><strong>mask</strong> – (Optional) If a mask is given. Exported data is
masked. A NaN in the mask flags for a masked pixel. Other
values are not considered (default None).</li>
</ul>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="method">
<dt id="orb.core.Cube.get_all_data">
<code class="descname">get_all_data</code><span class="sig-paren">(</span><em>mask=False</em><span class="sig-paren">)</span><a class="headerlink" href="#orb.core.Cube.get_all_data" title="Permalink to this definition">¶</a></dt>
<dd><p>Return the whole data cube</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><strong>mask</strong> – (Optional) if True return mask (default False).</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="method">
<dt id="orb.core.Cube.get_binned_cube">
<code class="descname">get_binned_cube</code><span class="sig-paren">(</span><em>binning</em><span class="sig-paren">)</span><a class="headerlink" href="#orb.core.Cube.get_binned_cube" title="Permalink to this definition">¶</a></dt>
<dd><p>Return the binned version of the cube</p>
</dd></dl>

<dl class="method">
<dt id="orb.core.Cube.get_calibration_laser_map">
<code class="descname">get_calibration_laser_map</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#orb.core.Cube.get_calibration_laser_map" title="Permalink to this definition">¶</a></dt>
<dd><p>Not implemented in Cube class but implemented in child
classes.</p>
</dd></dl>

<dl class="method">
<dt id="orb.core.Cube.get_column_data">
<code class="descname">get_column_data</code><span class="sig-paren">(</span><em>icol</em>, <em>silent=True</em>, <em>mask=False</em><span class="sig-paren">)</span><a class="headerlink" href="#orb.core.Cube.get_column_data" title="Permalink to this definition">¶</a></dt>
<dd><p>Return data as a slice along x axis</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first last simple">
<li><strong>icol</strong> – Column index</li>
<li><strong>silent</strong> – (Optional) if False display a progress bar
during data loading (default True)</li>
<li><strong>mask</strong> – (Optional) if True return mask (default False).</li>
</ul>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="method">
<dt id="orb.core.Cube.get_data">
<code class="descname">get_data</code><span class="sig-paren">(</span><em>x_min</em>, <em>x_max</em>, <em>y_min</em>, <em>y_max</em>, <em>z_min</em>, <em>z_max</em>, <em>silent=False</em>, <em>mask=False</em><span class="sig-paren">)</span><a class="headerlink" href="#orb.core.Cube.get_data" title="Permalink to this definition">¶</a></dt>
<dd><p>Return a part of the data cube.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first last simple">
<li><strong>x_min</strong> – minimum index along x axis</li>
<li><strong>x_max</strong> – maximum index along x axis</li>
<li><strong>y_min</strong> – minimum index along y axis</li>
<li><strong>y_max</strong> – maximum index along y axis</li>
<li><strong>z_min</strong> – minimum index along z axis</li>
<li><strong>z_max</strong> – maximum index along z axis</li>
<li><strong>silent</strong> – (Optional) if False display a progress bar
during data loading (default False)</li>
<li><strong>mask</strong> – (Optional) if True return mask (default False).</li>
</ul>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="method">
<dt id="orb.core.Cube.get_data_frame">
<code class="descname">get_data_frame</code><span class="sig-paren">(</span><em>index</em>, <em>silent=False</em>, <em>mask=False</em><span class="sig-paren">)</span><a class="headerlink" href="#orb.core.Cube.get_data_frame" title="Permalink to this definition">¶</a></dt>
<dd><p>Return one frame of the cube.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first last simple">
<li><strong>index</strong> – Index of the frame to be returned</li>
<li><strong>silent</strong> – (Optional) if False display a progress bar
during data loading (default False)</li>
<li><strong>mask</strong> – (Optional) if True return mask (default False).</li>
</ul>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="method">
<dt id="orb.core.Cube.get_interf_energy_map">
<code class="descname">get_interf_energy_map</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#orb.core.Cube.get_interf_energy_map" title="Permalink to this definition">¶</a></dt>
<dd><p>Return the energy map of an interferogram cube.</p>
</dd></dl>

<dl class="method">
<dt id="orb.core.Cube.get_mean_image">
<code class="descname">get_mean_image</code><span class="sig-paren">(</span><em>recompute=False</em><span class="sig-paren">)</span><a class="headerlink" href="#orb.core.Cube.get_mean_image" title="Permalink to this definition">¶</a></dt>
<dd><p>Return the mean image of a cube (corresponding to a deep
frame for an interferogram cube or a specral cube).</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><strong>recompute</strong> – (Optional) Force to recompute mean image
even if it is already present in the cube (default False).</td>
</tr>
</tbody>
</table>
<div class="admonition note">
<p class="first admonition-title">Note</p>
<p class="last">In this process NaNs are considered as zeros.</p>
</div>
</dd></dl>

<dl class="method">
<dt id="orb.core.Cube.get_median_image">
<code class="descname">get_median_image</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#orb.core.Cube.get_median_image" title="Permalink to this definition">¶</a></dt>
<dd><p>Return the median image of a cube</p>
<div class="admonition note">
<p class="first admonition-title">Note</p>
<p class="last">This is not a real median image. Frames are combined
10 by 10 with a median.</p>
</div>
</dd></dl>

<dl class="method">
<dt id="orb.core.Cube.get_quadrant_dims">
<code class="descname">get_quadrant_dims</code><span class="sig-paren">(</span><em>quad_number</em>, <em>div_nb=None</em>, <em>dimx=None</em>, <em>dimy=None</em><span class="sig-paren">)</span><a class="headerlink" href="#orb.core.Cube.get_quadrant_dims" title="Permalink to this definition">¶</a></dt>
<dd><p>Return the indices of a quadrant along x and y axes.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first last simple">
<li><strong>quad_number</strong> – Quadrant number</li>
<li><strong>div_nb</strong> – (Optional) Use another number of divisions
along x and y axes. (e.g. if div_nb = 3, the number of
quadrant is 9 ; if div_nb = 4, the number of quadrant is 16)</li>
<li><strong>dimx</strong> – (Optional) Use another x axis dimension. Other
than the axis dimension of the managed data cube</li>
<li><strong>dimy</strong> – (Optional) Use another y axis dimension. Other
than the axis dimension of the managed data cube</li>
</ul>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="method">
<dt id="orb.core.Cube.get_resized_data">
<code class="descname">get_resized_data</code><span class="sig-paren">(</span><em>size_x</em>, <em>size_y</em><span class="sig-paren">)</span><a class="headerlink" href="#orb.core.Cube.get_resized_data" title="Permalink to this definition">¶</a></dt>
<dd><dl class="docutils">
<dt>Resize the data cube and return it using spline</dt>
<dd>interpolation.</dd>
</dl>
<p>This function is used only to resize a cube of flat or dark
frames. Note that resizing dark or flat frames must be
avoided.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first last simple">
<li><strong>size_x</strong> – New size of the cube along x axis</li>
<li><strong>size_y</strong> – New size of the cube along y axis</li>
</ul>
</td>
</tr>
</tbody>
</table>
<div class="admonition warning">
<p class="first admonition-title">Warning</p>
<p class="last">This function must not be used to resize images
containing star-like objects (a linear interpopolation must
be done in this case).</p>
</div>
</dd></dl>

<dl class="method">
<dt id="orb.core.Cube.get_resized_frame">
<code class="descname">get_resized_frame</code><span class="sig-paren">(</span><em>index</em>, <em>size_x</em>, <em>size_y</em>, <em>degree=3</em><span class="sig-paren">)</span><a class="headerlink" href="#orb.core.Cube.get_resized_frame" title="Permalink to this definition">¶</a></dt>
<dd><p>Return a resized frame using spline interpolation.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first last simple">
<li><strong>index</strong> – Index of the frame to resize</li>
<li><strong>size_x</strong> – New size of the cube along x axis</li>
<li><strong>size_y</strong> – New size of the cube along y axis</li>
<li><strong>degree</strong> – (Optional) Interpolation degree (Default 3)</li>
</ul>
</td>
</tr>
</tbody>
</table>
<div class="admonition warning">
<p class="first admonition-title">Warning</p>
<p class="last">To use this function on images containing
star-like objects a linear interpolation must be done
(set degree to 1).</p>
</div>
</dd></dl>

<dl class="method">
<dt id="orb.core.Cube.get_size_on_disk">
<code class="descname">get_size_on_disk</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#orb.core.Cube.get_size_on_disk" title="Permalink to this definition">¶</a></dt>
<dd><p>Return the expected size of the cube if saved on disk in Mo.</p>
</dd></dl>

<dl class="method">
<dt id="orb.core.Cube.get_spectrum_energy_map">
<code class="descname">get_spectrum_energy_map</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#orb.core.Cube.get_spectrum_energy_map" title="Permalink to this definition">¶</a></dt>
<dd><p>Return the energy map of a spectrum cube.</p>
<div class="admonition note">
<p class="first admonition-title">Note</p>
<p class="last">In this process NaNs are considered as zeros.</p>
</div>
</dd></dl>

<dl class="method">
<dt id="orb.core.Cube.get_zmean">
<code class="descname">get_zmean</code><span class="sig-paren">(</span><em>nozero=False</em>, <em>center=False</em><span class="sig-paren">)</span><a class="headerlink" href="#orb.core.Cube.get_zmean" title="Permalink to this definition">¶</a></dt>
<dd><p>Return a vector containing frames median.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first last simple">
<li><strong>nozero</strong> – If True zeros are removed from the median
computation. If there’s only zeros, median frame value will
be a NaN (default False).</li>
<li><strong>center</strong> – If True only the center of the frame is used to
compute median.</li>
</ul>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="method">
<dt id="orb.core.Cube.get_zmedian">
<code class="descname">get_zmedian</code><span class="sig-paren">(</span><em>nozero=False</em>, <em>center=False</em><span class="sig-paren">)</span><a class="headerlink" href="#orb.core.Cube.get_zmedian" title="Permalink to this definition">¶</a></dt>
<dd><p>Return a vector containing frames mean.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first last simple">
<li><strong>nozero</strong> – If True zeros are removed from the mean
computation. If there’s only zeros, mean frame value will
be a NaN (default False).</li>
<li><strong>center</strong> – If True only the center of the frame is used to
compute mean.</li>
</ul>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="method">
<dt id="orb.core.Cube.get_zstat">
<code class="descname">get_zstat</code><span class="sig-paren">(</span><em>nozero=False</em>, <em>stat='mean'</em>, <em>center=False</em><span class="sig-paren">)</span><a class="headerlink" href="#orb.core.Cube.get_zstat" title="Permalink to this definition">¶</a></dt>
<dd><p>Return a vector containing frames stat (mean, median or
std).</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first last simple">
<li><strong>nozero</strong> – If True zeros are removed from the stat
computation. If there’s only zeros, stat frame value will
be a NaN (default False).</li>
<li><strong>stat</strong> – Type of stat to return. Can be ‘mean’, ‘median’
or ‘std’</li>
<li><strong>center</strong> – If True only the center of the frame is used to
compute stat.</li>
</ul>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="method">
<dt id="orb.core.Cube.get_zstd">
<code class="descname">get_zstd</code><span class="sig-paren">(</span><em>nozero=False</em>, <em>center=False</em><span class="sig-paren">)</span><a class="headerlink" href="#orb.core.Cube.get_zstd" title="Permalink to this definition">¶</a></dt>
<dd><p>Return a vector containing frames std.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first last simple">
<li><strong>nozero</strong> – If True zeros are removed from the std
computation. If there’s only zeros, std frame value will
be a NaN (default False).</li>
<li><strong>center</strong> – If True only the center of the frame is used to
compute std.</li>
</ul>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="method">
<dt id="orb.core.Cube.is_same_2D_size">
<code class="descname">is_same_2D_size</code><span class="sig-paren">(</span><em>cube_test</em><span class="sig-paren">)</span><a class="headerlink" href="#orb.core.Cube.is_same_2D_size" title="Permalink to this definition">¶</a></dt>
<dd><p>Check if another cube has the same dimensions along x and y
axes.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><strong>cube_test</strong> – Cube to check</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="method">
<dt id="orb.core.Cube.is_same_3D_size">
<code class="descname">is_same_3D_size</code><span class="sig-paren">(</span><em>cube_test</em><span class="sig-paren">)</span><a class="headerlink" href="#orb.core.Cube.is_same_3D_size" title="Permalink to this definition">¶</a></dt>
<dd><p>Check if another cube has the same dimensions.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><strong>cube_test</strong> – Cube to check</td>
</tr>
</tbody>
</table>
</dd></dl>

</dd></dl>

<dl class="class">
<dt id="orb.core.ExtDebugLoggingFilter">
<em class="property">class </em><code class="descclassname">orb.core.</code><code class="descname">ExtDebugLoggingFilter</code><span class="sig-paren">(</span><em>name=''</em><span class="sig-paren">)</span><a class="headerlink" href="#orb.core.ExtDebugLoggingFilter" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <a class="reference external" href="https://docs.python.org/3/library/logging.html#logging.Filter" title="(in Python v3.7)"><code class="xref py py-class docutils literal notranslate"><span class="pre">logging.Filter</span></code></a></p>
<dl class="attribute">
<dt id="orb.core.ExtDebugLoggingFilter.bad_names">
<code class="descname">bad_names</code><em class="property"> = ['pp']</em><a class="headerlink" href="#orb.core.ExtDebugLoggingFilter.bad_names" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="method">
<dt id="orb.core.ExtDebugLoggingFilter.filter">
<code class="descname">filter</code><span class="sig-paren">(</span><em>record</em><span class="sig-paren">)</span><a class="headerlink" href="#orb.core.ExtDebugLoggingFilter.filter" title="Permalink to this definition">¶</a></dt>
<dd><p>Determine if the specified record is to be logged.</p>
<p>Is the specified record to be logged? Returns 0 for no, nonzero for
yes. If deemed appropriate, the record may be modified in-place.</p>
</dd></dl>

</dd></dl>

<dl class="class">
<dt id="orb.core.ExtInfoLoggingFilter">
<em class="property">class </em><code class="descclassname">orb.core.</code><code class="descname">ExtInfoLoggingFilter</code><span class="sig-paren">(</span><em>name=''</em><span class="sig-paren">)</span><a class="headerlink" href="#orb.core.ExtInfoLoggingFilter" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <a class="reference external" href="https://docs.python.org/3/library/logging.html#logging.Filter" title="(in Python v3.7)"><code class="xref py py-class docutils literal notranslate"><span class="pre">logging.Filter</span></code></a></p>
<dl class="attribute">
<dt id="orb.core.ExtInfoLoggingFilter.bad_names">
<code class="descname">bad_names</code><em class="property"> = ['pp']</em><a class="headerlink" href="#orb.core.ExtInfoLoggingFilter.bad_names" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="method">
<dt id="orb.core.ExtInfoLoggingFilter.filter">
<code class="descname">filter</code><span class="sig-paren">(</span><em>record</em><span class="sig-paren">)</span><a class="headerlink" href="#orb.core.ExtInfoLoggingFilter.filter" title="Permalink to this definition">¶</a></dt>
<dd><p>Determine if the specified record is to be logged.</p>
<p>Is the specified record to be logged? Returns 0 for no, nonzero for
yes. If deemed appropriate, the record may be modified in-place.</p>
</dd></dl>

</dd></dl>

<dl class="class">
<dt id="orb.core.FDCube">
<em class="property">class </em><code class="descclassname">orb.core.</code><code class="descname">FDCube</code><span class="sig-paren">(</span><em>image_list_path</em>, <em>image_mode='classic'</em>, <em>chip_index=1</em>, <em>binning=1</em>, <em>no_sort=False</em>, <em>silent_init=False</em>, <em>**kwargs</em><span class="sig-paren">)</span><a class="headerlink" href="#orb.core.FDCube" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <a class="reference internal" href="#orb.core.Cube" title="orb.core.Cube"><code class="xref py py-class docutils literal notranslate"><span class="pre">orb.core.Cube</span></code></a></p>
<p>Generate and manage a <strong>virtual frame-divided cube</strong>.</p>
<div class="admonition note">
<p class="first admonition-title">Note</p>
<p class="last">A <strong>frame-divided cube</strong> is a set of frames grouped
together by a list.  It avoids storing a data cube in one large
data file and loading an entire cube to process it.</p>
</div>
<p>This class has been designed to handle large data cubes. Its data
can be accessed virtually as if it was loaded in memory.</p>
<div class="highlight-python notranslate"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre>1
2
3</pre></div></td><td class="code"><div class="highlight"><pre><span></span><span class="n">cube</span> <span class="o">=</span> <span class="n">Cube</span><span class="p">(</span><span class="s1">&#39;liste&#39;</span><span class="p">)</span> <span class="c1"># A simple list is enough to initialize a Cube instance</span>
<span class="n">quadrant</span> <span class="o">=</span> <span class="n">Cube</span><span class="p">[</span><span class="mi">25</span><span class="p">:</span><span class="mi">50</span><span class="p">,</span> <span class="mi">25</span><span class="p">:</span><span class="mi">50</span><span class="p">,</span> <span class="p">:]</span> <span class="c1"># Here you just load a small quadrant</span>
<span class="n">spectrum</span> <span class="o">=</span> <span class="n">Cube</span><span class="p">[</span><span class="mi">84</span><span class="p">,</span><span class="mi">58</span><span class="p">,:]</span> <span class="c1"># load spectrum at pixel [84,58]</span>
</pre></div>
</td></tr></table></div>
<dl class="method">
<dt id="orb.core.FDCube.get_cube_header">
<code class="descname">get_cube_header</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#orb.core.FDCube.get_cube_header" title="Permalink to this definition">¶</a></dt>
<dd><p>Return the header of a cube from the header of the first frame
by keeping only the general keywords.</p>
</dd></dl>

<dl class="method">
<dt id="orb.core.FDCube.get_frame_header">
<code class="descname">get_frame_header</code><span class="sig-paren">(</span><em>index</em><span class="sig-paren">)</span><a class="headerlink" href="#orb.core.FDCube.get_frame_header" title="Permalink to this definition">¶</a></dt>
<dd><p>Return the header of a frame given its index in the list.</p>
<p>The header is returned as an instance of pyfits.Header().</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><strong>index</strong> – Index of the frame</td>
</tr>
</tbody>
</table>
<div class="admonition note">
<p class="first admonition-title">Note</p>
<p class="last">Please refer to
<a class="reference external" href="http://www.stsci.edu/institute/software_hardware/pyfits/">http://www.stsci.edu/institute/software_hardware/pyfits/</a> for
more information on PyFITS module and
<a class="reference external" href="http://fits.gsfc.nasa.gov/">http://fits.gsfc.nasa.gov/</a> for more information on FITS
files.</p>
</div>
</dd></dl>

</dd></dl>

<dl class="class">
<dt id="orb.core.FilterFile">
<em class="property">class </em><code class="descclassname">orb.core.</code><code class="descname">FilterFile</code><span class="sig-paren">(</span><em>filter_name</em>, <em>**kwargs</em><span class="sig-paren">)</span><a class="headerlink" href="#orb.core.FilterFile" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <a class="reference internal" href="#orb.core.Tools" title="orb.core.Tools"><code class="xref py py-class docutils literal notranslate"><span class="pre">orb.core.Tools</span></code></a></p>
<p>Manage filter files</p>
<dl class="method">
<dt id="orb.core.FilterFile.get_filter_bandpass">
<code class="descname">get_filter_bandpass</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#orb.core.FilterFile.get_filter_bandpass" title="Permalink to this definition">¶</a></dt>
<dd><p>Wrapper around
<a class="reference internal" href="code_utils.html#orb.utils.filters.get_filter_bandpass" title="orb.utils.filters.get_filter_bandpass"><code class="xref py py-meth docutils literal notranslate"><span class="pre">orb.utils.filters.get_filter_bandpass()</span></code></a></p>
</dd></dl>

<dl class="method">
<dt id="orb.core.FilterFile.get_filter_function">
<code class="descname">get_filter_function</code><span class="sig-paren">(</span><em>step</em>, <em>order</em>, <em>step_nb</em>, <em>wavenumber=False</em>, <em>silent=False</em>, <em>corr=1.0</em><span class="sig-paren">)</span><a class="headerlink" href="#orb.core.FilterFile.get_filter_function" title="Permalink to this definition">¶</a></dt>
<dd><p>Wrapper around
<a class="reference internal" href="code_utils.html#orb.utils.filters.get_filter_function" title="orb.utils.filters.get_filter_function"><code class="xref py py-meth docutils literal notranslate"><span class="pre">orb.utils.filters.get_filter_function()</span></code></a>.</p>
<p>Parameters are the same.</p>
</dd></dl>

<dl class="method">
<dt id="orb.core.FilterFile.get_modulation_efficiency">
<code class="descname">get_modulation_efficiency</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#orb.core.FilterFile.get_modulation_efficiency" title="Permalink to this definition">¶</a></dt>
<dd><p>Wrapper around
<a class="reference internal" href="code_utils.html#orb.utils.filters.get_modulation_efficiency" title="orb.utils.filters.get_modulation_efficiency"><code class="xref py py-meth docutils literal notranslate"><span class="pre">orb.utils.filters.get_modulation_efficiency()</span></code></a></p>
</dd></dl>

<dl class="method">
<dt id="orb.core.FilterFile.get_observation_params">
<code class="descname">get_observation_params</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#orb.core.FilterFile.get_observation_params" title="Permalink to this definition">¶</a></dt>
<dd><p>Wrapper around
<a class="reference internal" href="code_utils.html#orb.utils.filters.get_observation_params" title="orb.utils.filters.get_observation_params"><code class="xref py py-meth docutils literal notranslate"><span class="pre">orb.utils.filters.get_observation_params()</span></code></a></p>
</dd></dl>

<dl class="method">
<dt id="orb.core.FilterFile.get_phase_fit_order">
<code class="descname">get_phase_fit_order</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#orb.core.FilterFile.get_phase_fit_order" title="Permalink to this definition">¶</a></dt>
<dd><p>Wrapper around
<a class="reference internal" href="code_utils.html#orb.utils.filters.get_phase_fit_order" title="orb.utils.filters.get_phase_fit_order"><code class="xref py py-meth docutils literal notranslate"><span class="pre">orb.utils.filters.get_phase_fit_order()</span></code></a></p>
</dd></dl>

<dl class="method">
<dt id="orb.core.FilterFile.read_filter_file">
<code class="descname">read_filter_file</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#orb.core.FilterFile.read_filter_file" title="Permalink to this definition">¶</a></dt>
<dd><p>Wrapper around
<a class="reference internal" href="code_utils.html#orb.utils.filters.read_filter_file" title="orb.utils.filters.read_filter_file"><code class="xref py py-meth docutils literal notranslate"><span class="pre">orb.utils.filters.read_filter_file()</span></code></a></p>
</dd></dl>

</dd></dl>

<dl class="class">
<dt id="orb.core.HDFCube">
<em class="property">class </em><code class="descclassname">orb.core.</code><code class="descname">HDFCube</code><span class="sig-paren">(</span><em>cube_path</em>, <em>silent_init=False</em>, <em>binning=None</em>, <em>**kwargs</em><span class="sig-paren">)</span><a class="headerlink" href="#orb.core.HDFCube" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <a class="reference internal" href="#orb.core.FDCube" title="orb.core.FDCube"><code class="xref py py-class docutils literal notranslate"><span class="pre">orb.core.FDCube</span></code></a></p>
<p>This class implements the use of an HDF5 cube.</p>
<p>An HDF5 cube is similar to the <em>frame-divided cube</em> implemented by
the class <a class="reference internal" href="#orb.core.Cube" title="orb.core.Cube"><code class="xref py py-class docutils literal notranslate"><span class="pre">orb.core.Cube</span></code></a> but it makes use of the really
fast data access provided by HDF5 files. The “frame-divided”
concept is keeped but all the frames are grouped into one hdf5
file.</p>
<p>An HDF5 cube must have a certain architecture:</p>
<ul class="simple">
<li>Each frame has its own group called ‘frameIIIII’, IIIII being a
integer giving the position of the frame on 5 characters filled
with zeros. e.g. the first frame group is called frame00000</li>
<li>Each frame group is divided into at least 2 datasets: <strong>data</strong>
and <em>header</em> (e.g. the data of the first frame will be in the
dataset <em>frame00000/data</em>)</li>
<li>A <strong>mask</strong> dataset can be added to each frame.</li>
</ul>
<dl class="method">
<dt id="orb.core.HDFCube.get_calibration_laser_map">
<code class="descname">get_calibration_laser_map</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#orb.core.HDFCube.get_calibration_laser_map" title="Permalink to this definition">¶</a></dt>
<dd><p>Return stored calibration laser map</p>
</dd></dl>

<dl class="method">
<dt id="orb.core.HDFCube.get_cube_header">
<code class="descname">get_cube_header</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#orb.core.HDFCube.get_cube_header" title="Permalink to this definition">¶</a></dt>
<dd><p>Return the header of a the cube.</p>
<p>The header is returned as an instance of pyfits.Header().</p>
</dd></dl>

<dl class="method">
<dt id="orb.core.HDFCube.get_frame_attribute">
<code class="descname">get_frame_attribute</code><span class="sig-paren">(</span><em>index</em>, <em>attr</em><span class="sig-paren">)</span><a class="headerlink" href="#orb.core.HDFCube.get_frame_attribute" title="Permalink to this definition">¶</a></dt>
<dd><p>Return an attribute attached to a frame.</p>
<p>If the attribute does not exist returns None.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first last simple">
<li><strong>index</strong> – Index of the frame.</li>
<li><strong>attr</strong> – Attribute name.</li>
</ul>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="method">
<dt id="orb.core.HDFCube.get_frame_attributes">
<code class="descname">get_frame_attributes</code><span class="sig-paren">(</span><em>index</em><span class="sig-paren">)</span><a class="headerlink" href="#orb.core.HDFCube.get_frame_attributes" title="Permalink to this definition">¶</a></dt>
<dd><p>Return an attribute attached to a frame.</p>
<p>If the attribute does not exist returns None.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first last simple">
<li><strong>index</strong> – Index of the frame.</li>
<li><strong>attr</strong> – Attribute name.</li>
</ul>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="method">
<dt id="orb.core.HDFCube.get_frame_header">
<code class="descname">get_frame_header</code><span class="sig-paren">(</span><em>index</em><span class="sig-paren">)</span><a class="headerlink" href="#orb.core.HDFCube.get_frame_header" title="Permalink to this definition">¶</a></dt>
<dd><p>Return the header of a frame given its index in the list.</p>
<p>The header is returned as an instance of pyfits.Header().</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><strong>index</strong> – Index of the frame</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="method">
<dt id="orb.core.HDFCube.get_interf_energy_map">
<code class="descname">get_interf_energy_map</code><span class="sig-paren">(</span><em>recompute=False</em><span class="sig-paren">)</span><a class="headerlink" href="#orb.core.HDFCube.get_interf_energy_map" title="Permalink to this definition">¶</a></dt>
<dd><p>Return the energy map of an interferogram cube.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><strong>recompute</strong> – (Optional) Force to recompute energy map
even if it is already present in the cube (default False).</td>
</tr>
</tbody>
</table>
<p>If an energy map has already been computed (‘energy_map’
dataset) return it directly.</p>
</dd></dl>

<dl class="method">
<dt id="orb.core.HDFCube.get_mean_image">
<code class="descname">get_mean_image</code><span class="sig-paren">(</span><em>recompute=False</em><span class="sig-paren">)</span><a class="headerlink" href="#orb.core.HDFCube.get_mean_image" title="Permalink to this definition">¶</a></dt>
<dd><p>Return the deep frame of the cube.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><strong>recompute</strong> – (Optional) Force to recompute mean image
even if it is already present in the cube (default False).</td>
</tr>
</tbody>
</table>
<p>If a deep frame has already been computed (‘deep_frame’
dataset) return it directly.</p>
</dd></dl>

<dl class="method">
<dt id="orb.core.HDFCube.get_spectrum_energy_map">
<code class="descname">get_spectrum_energy_map</code><span class="sig-paren">(</span><em>recompute=False</em><span class="sig-paren">)</span><a class="headerlink" href="#orb.core.HDFCube.get_spectrum_energy_map" title="Permalink to this definition">¶</a></dt>
<dd><p>Return the energy map of a spectral cube.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><strong>recompute</strong> – (Optional) Force to recompute energy map
even if it is already present in the cube (default False).</td>
</tr>
</tbody>
</table>
<p>If an energy map has already been computed (‘energy_map’
dataset) return it directly.</p>
</dd></dl>

</dd></dl>

<dl class="class">
<dt id="orb.core.Header">
<em class="property">class </em><code class="descclassname">orb.core.</code><code class="descname">Header</code><span class="sig-paren">(</span><em>*args</em>, <em>**kwargs</em><span class="sig-paren">)</span><a class="headerlink" href="#orb.core.Header" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">astropy.io.fits.header.Header</span></code></p>
<p>Extension of <code class="xref py py-class docutils literal notranslate"><span class="pre">astropy.io.fits.Header</span></code></p>
<dl class="method">
<dt id="orb.core.Header.bin_wcs">
<code class="descname">bin_wcs</code><span class="sig-paren">(</span><em>binning</em><span class="sig-paren">)</span><a class="headerlink" href="#orb.core.Header.bin_wcs" title="Permalink to this definition">¶</a></dt>
<dd><p>Bin WCS</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><strong>binning</strong> – Binning</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="method">
<dt id="orb.core.Header.tostr">
<code class="descname">tostr</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#orb.core.Header.tostr" title="Permalink to this definition">¶</a></dt>
<dd><p>Return a nice string to print</p>
</dd></dl>

</dd></dl>

<dl class="class">
<dt id="orb.core.Indexer">
<em class="property">class </em><code class="descclassname">orb.core.</code><code class="descname">Indexer</code><span class="sig-paren">(</span><em>instrument=None</em>, <em>data_prefix='./temp/data.'</em>, <em>tuning_parameters={}</em>, <em>ncpus=None</em>, <em>silent=False</em><span class="sig-paren">)</span><a class="headerlink" href="#orb.core.Indexer" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <a class="reference internal" href="#orb.core.Tools" title="orb.core.Tools"><code class="xref py py-class docutils literal notranslate"><span class="pre">orb.core.Tools</span></code></a></p>
<p>Manage locations of created files.</p>
<p>All files locations are stored in a text-like file: the index
file. This file is the ‘real’ counterpart of the index (which is
‘virtual’ until <code class="xref py py-meth docutils literal notranslate"><span class="pre">core.Indexer.update_index()</span></code> is
called). This method is called each time
<code class="xref py py-meth docutils literal notranslate"><span class="pre">core.Indexer.__setitem__()</span></code> is called.</p>
<p>This class can be accessed like a dictionary.</p>
<dl class="attribute">
<dt id="orb.core.Indexer.file_group">
<code class="descname">file_group</code><em class="property"> = None</em><a class="headerlink" href="#orb.core.Indexer.file_group" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="attribute">
<dt id="orb.core.Indexer.file_group_indexes">
<code class="descname">file_group_indexes</code><em class="property"> = [0, 1, 2]</em><a class="headerlink" href="#orb.core.Indexer.file_group_indexes" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="attribute">
<dt id="orb.core.Indexer.file_groups">
<code class="descname">file_groups</code><em class="property"> = ['cam1', 'cam2', 'merged']</em><a class="headerlink" href="#orb.core.Indexer.file_groups" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="method">
<dt id="orb.core.Indexer.get_path">
<code class="descname">get_path</code><span class="sig-paren">(</span><em>file_key</em>, <em>file_group=None</em>, <em>err=False</em><span class="sig-paren">)</span><a class="headerlink" href="#orb.core.Indexer.get_path" title="Permalink to this definition">¶</a></dt>
<dd><p>Return the path of a file recorded in the index.</p>
<p>Equivalent to self[file_key] if the option file_group is not used.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first last simple">
<li><strong>file_key</strong> – Key name of the file to be located</li>
<li><strong>file_group</strong> – (Optional) Add group prefix to the key
name. File group must be ‘cam1’, ‘cam2’, ‘merged’ or their
integer equivalent 1, 2, 0. File group can also be set to
None (default None).</li>
<li><strong>err</strong> – (Optional) Print an error instead of a warning if
the file is not indexed.</li>
</ul>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="attribute">
<dt id="orb.core.Indexer.index">
<code class="descname">index</code><em class="property"> = {}</em><a class="headerlink" href="#orb.core.Indexer.index" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="method">
<dt id="orb.core.Indexer.load_index">
<code class="descname">load_index</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#orb.core.Indexer.load_index" title="Permalink to this definition">¶</a></dt>
<dd><p>Load index file and rebuild index of already located files</p>
</dd></dl>

<dl class="method">
<dt id="orb.core.Indexer.set_file_group">
<code class="descname">set_file_group</code><span class="sig-paren">(</span><em>file_group</em><span class="sig-paren">)</span><a class="headerlink" href="#orb.core.Indexer.set_file_group" title="Permalink to this definition">¶</a></dt>
<dd><p>Set the group of the next files to be recorded. All given
file keys will be prefixed by the file group.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><strong>file_group</strong> – File group must be ‘cam1’, ‘cam2’, ‘merged’
or their integer equivalent 1, 2, 0. File group can also be
set to None.</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="method">
<dt id="orb.core.Indexer.update_index">
<code class="descname">update_index</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#orb.core.Indexer.update_index" title="Permalink to this definition">¶</a></dt>
<dd><p>Update index files with data in the virtual index</p>
</dd></dl>

</dd></dl>

<dl class="class">
<dt id="orb.core.Lines">
<em class="property">class </em><code class="descclassname">orb.core.</code><code class="descname">Lines</code><span class="sig-paren">(</span><em>**kwargs</em><span class="sig-paren">)</span><a class="headerlink" href="#orb.core.Lines" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <a class="reference internal" href="#orb.core.Tools" title="orb.core.Tools"><code class="xref py py-class docutils literal notranslate"><span class="pre">orb.core.Tools</span></code></a></p>
<p>This class manages emission lines names and wavelengths.</p>
<p>Spectral lines rest wavelength (excerpt, all recorded lines are in
self.air_lines_nm):</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="o">============</span> <span class="o">=======</span>
  <span class="n">Em</span><span class="o">.</span> <span class="n">Line</span>     <span class="n">Air</span>
<span class="o">============</span> <span class="o">=======</span>
<span class="p">[</span><span class="n">OII</span><span class="p">]</span><span class="mi">3726</span>    <span class="mf">372.603</span>
<span class="p">[</span><span class="n">OII</span><span class="p">]</span><span class="mi">3729</span>    <span class="mf">372.882</span>
<span class="n">Hepsilon</span>     <span class="mf">397.007</span>
<span class="n">Hdelta</span>       <span class="mf">410.176</span>
<span class="n">Hgamma</span>       <span class="mf">434.047</span>
<span class="p">[</span><span class="n">OIII</span><span class="p">]</span><span class="mi">4363</span>   <span class="mf">436.321</span>
<span class="n">Hbeta</span>        <span class="mf">486.133</span>
<span class="p">[</span><span class="n">OIII</span><span class="p">]</span><span class="mi">4959</span>   <span class="mf">495.892</span>
<span class="p">[</span><span class="n">OIII</span><span class="p">]</span><span class="mi">5007</span>   <span class="mf">500.684</span>
<span class="p">[</span><span class="n">NII</span><span class="p">]</span><span class="mi">6548</span>    <span class="mf">654.803</span>
<span class="n">Halpha</span>       <span class="mf">656.279</span>
<span class="p">[</span><span class="n">NII</span><span class="p">]</span><span class="mi">6583</span>    <span class="mf">658.341</span>
<span class="p">[</span><span class="n">SII</span><span class="p">]</span><span class="mi">6716</span>    <span class="mf">671.647</span>
<span class="p">[</span><span class="n">SII</span><span class="p">]</span><span class="mi">6731</span>    <span class="mf">673.085</span>
</pre></div>
</div>
<dl class="attribute">
<dt id="orb.core.Lines.air_lines_name">
<code class="descname">air_lines_name</code><em class="property"> = None</em><a class="headerlink" href="#orb.core.Lines.air_lines_name" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="attribute">
<dt id="orb.core.Lines.air_lines_nm">
<code class="descname">air_lines_nm</code><em class="property"> = {'H10': 379.79044, 'H11': 377.06368, 'H12': 375.01584, 'H13': 373.43746, 'H14': 372.19449, 'H15': 371.19774, 'H8': 388.90557, 'H9': 383.53909, 'Halpha': 656.2819, 'Hbeta': 486.1333, 'Hdelta': 410.17415, 'HeI5876': 587.567, 'HeI6678': 667.81517, 'HeI7065': 706.52153, 'Hepsilon': 397.00788, 'Hgamma': 434.0471, '[ArIII]7136': 713.579, '[ArIII]7751': 775.111, '[NII]6548': 654.805, '[NII]6583': 658.345, '[NeIII]3869': 386.876, '[OIII]4363': 436.3209, '[OIII]4959': 495.8911, '[OIII]5007': 500.6843, '[OII]3726': 372.7319, '[OII]3729': 372.9221, '[OII]7320': 731.992, '[OII]7330': 733.019, '[OI]6300': 630.0304, '[SIII]6312': 631.206, '[SII]6716': 671.644, '[SII]6731': 673.0816}</em><a class="headerlink" href="#orb.core.Lines.air_lines_nm" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="attribute">
<dt id="orb.core.Lines.air_sky_lines_nm">
<code class="descname">air_sky_lines_nm</code><em class="property"> = None</em><a class="headerlink" href="#orb.core.Lines.air_sky_lines_nm" title="Permalink to this definition">¶</a></dt>
<dd><p>Air sky lines wavelength</p>
</dd></dl>

<dl class="method">
<dt id="orb.core.Lines.get_line_cm1">
<code class="descname">get_line_cm1</code><span class="sig-paren">(</span><em>lines_name</em>, <em>round_ang=False</em><span class="sig-paren">)</span><a class="headerlink" href="#orb.core.Lines.get_line_cm1" title="Permalink to this definition">¶</a></dt>
<dd><p>Return the wavenumber of a line or a list of lines</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><strong>lines_name</strong> – List of line names</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="method">
<dt id="orb.core.Lines.get_line_name">
<code class="descname">get_line_name</code><span class="sig-paren">(</span><em>lines</em><span class="sig-paren">)</span><a class="headerlink" href="#orb.core.Lines.get_line_name" title="Permalink to this definition">¶</a></dt>
<dd><p>Return the name of a line or a list of lines given their
wavelength.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><strong>lines</strong> – List of lines wavelength</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="method">
<dt id="orb.core.Lines.get_line_nm">
<code class="descname">get_line_nm</code><span class="sig-paren">(</span><em>lines_name</em>, <em>round_ang=False</em><span class="sig-paren">)</span><a class="headerlink" href="#orb.core.Lines.get_line_nm" title="Permalink to this definition">¶</a></dt>
<dd><p>Return the wavelength of a line or a list of lines</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first last simple">
<li><strong>lines_name</strong> – List of line names</li>
<li><strong>round_ang</strong> – (Optional) If True return the rounded
wavelength of the line in angstrom (default False)</li>
</ul>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="method">
<dt id="orb.core.Lines.get_sky_lines">
<code class="descname">get_sky_lines</code><span class="sig-paren">(</span><em>nm_min</em>, <em>nm_max</em>, <em>delta_nm</em>, <em>line_nb=0</em>, <em>get_names=False</em><span class="sig-paren">)</span><a class="headerlink" href="#orb.core.Lines.get_sky_lines" title="Permalink to this definition">¶</a></dt>
<dd><p>Return sky lines in a range of optical wavelength.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first last simple">
<li><strong>nm_min</strong> – min Wavelength of the lines in nm</li>
<li><strong>nm_max</strong> – max Wavelength of the lines in nm</li>
<li><strong>delta_nm</strong> – Wavelength resolution in nm as the minimum
wavelength interval of the spectrum. Lines comprises in half
of this interval are merged.</li>
<li><strong>line_nb</strong> – (Optional) Number of the most intense lines to
retrieve. If 0 all lines are given (default 0).</li>
<li><strong>get_name</strong> – (Optional) If True return lines name also.</li>
</ul>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="attribute">
<dt id="orb.core.Lines.other_names">
<code class="descname">other_names</code><em class="property"> = {'Halpha': ['H3'], 'Hbeta': ['H4'], 'Hdelta': ['H6'], 'Hepsilon': ['H7'], 'Hgamma': ['H5'], '[NII]6583': ['[NII]6584'], '[OII]3726': ['[OII]3727'], '[SII]6716': ['[SII]6717']}</em><a class="headerlink" href="#orb.core.Lines.other_names" title="Permalink to this definition">¶</a></dt>
<dd><p>Air emission lines wavelength</p>
</dd></dl>

<dl class="method">
<dt id="orb.core.Lines.round_nm2ang">
<code class="descname">round_nm2ang</code><span class="sig-paren">(</span><em>nm</em><span class="sig-paren">)</span><a class="headerlink" href="#orb.core.Lines.round_nm2ang" title="Permalink to this definition">¶</a></dt>
<dd><p>Convert a wavelength in nm into a rounded value in angstrom</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><strong>nm</strong> – Line wavelength in nm</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="attribute">
<dt id="orb.core.Lines.sky_lines_file_name">
<code class="descname">sky_lines_file_name</code><em class="property"> = 'sky_lines.orb'</em><a class="headerlink" href="#orb.core.Lines.sky_lines_file_name" title="Permalink to this definition">¶</a></dt>
<dd><p>Name of the sky lines data file.</p>
</dd></dl>

</dd></dl>

<dl class="class">
<dt id="orb.core.LogRecordSocketReceiver">
<em class="property">class </em><code class="descclassname">orb.core.</code><code class="descname">LogRecordSocketReceiver</code><span class="sig-paren">(</span><em>host='localhost'</em>, <em>port=9020</em>, <em>handler=&lt;class orb.core.LogRecordStreamHandler&gt;</em><span class="sig-paren">)</span><a class="headerlink" href="#orb.core.LogRecordSocketReceiver" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">SocketServer.ThreadingTCPServer</span></code></p>
<p>Simple TCP socket-based logging receiver suitable for testing.</p>
<dl class="method">
<dt id="orb.core.LogRecordSocketReceiver.serve_until_stopped">
<code class="descname">serve_until_stopped</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#orb.core.LogRecordSocketReceiver.serve_until_stopped" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="method">
<dt id="orb.core.LogRecordSocketReceiver.server_bind">
<code class="descname">server_bind</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#orb.core.LogRecordSocketReceiver.server_bind" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

</dd></dl>

<dl class="class">
<dt id="orb.core.LogRecordStreamHandler">
<em class="property">class </em><code class="descclassname">orb.core.</code><code class="descname">LogRecordStreamHandler</code><span class="sig-paren">(</span><em>request</em>, <em>client_address</em>, <em>server</em><span class="sig-paren">)</span><a class="headerlink" href="#orb.core.LogRecordStreamHandler" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">SocketServer.StreamRequestHandler</span></code></p>
<p>Handler for a streaming logging request.</p>
<p>This basically logs the record using whatever logging policy is
configured locally.</p>
<dl class="method">
<dt id="orb.core.LogRecordStreamHandler.handle">
<code class="descname">handle</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#orb.core.LogRecordStreamHandler.handle" title="Permalink to this definition">¶</a></dt>
<dd><p>Handle multiple requests - each expected to be a 4-byte length,
followed by the LogRecord in pickle format. Logs the record
according to whatever policy is configured locally.</p>
</dd></dl>

<dl class="method">
<dt id="orb.core.LogRecordStreamHandler.handleLogRecord">
<code class="descname">handleLogRecord</code><span class="sig-paren">(</span><em>record</em><span class="sig-paren">)</span><a class="headerlink" href="#orb.core.LogRecordStreamHandler.handleLogRecord" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="method">
<dt id="orb.core.LogRecordStreamHandler.unPickle">
<code class="descname">unPickle</code><span class="sig-paren">(</span><em>data</em><span class="sig-paren">)</span><a class="headerlink" href="#orb.core.LogRecordStreamHandler.unPickle" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

</dd></dl>

<dl class="class">
<dt id="orb.core.Logger">
<em class="property">class </em><code class="descclassname">orb.core.</code><code class="descname">Logger</code><span class="sig-paren">(</span><em>debug=False</em>, <em>logfilter='default'</em><span class="sig-paren">)</span><a class="headerlink" href="#orb.core.Logger" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <a class="reference external" href="https://docs.python.org/3/library/functions.html#object" title="(in Python v3.7)"><code class="xref py py-class docutils literal notranslate"><span class="pre">object</span></code></a></p>
<dl class="method">
<dt id="orb.core.Logger.getLogger">
<code class="descname">getLogger</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#orb.core.Logger.getLogger" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="method">
<dt id="orb.core.Logger.get_file_logging_state">
<code class="descname">get_file_logging_state</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#orb.core.Logger.get_file_logging_state" title="Permalink to this definition">¶</a></dt>
<dd><p>Return True if the file logging appears set</p>
</dd></dl>

<dl class="method">
<dt id="orb.core.Logger.get_logdateformat">
<code class="descname">get_logdateformat</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#orb.core.Logger.get_logdateformat" title="Permalink to this definition">¶</a></dt>
<dd><p>Return a string describing the logging date format</p>
</dd></dl>

<dl class="method">
<dt id="orb.core.Logger.get_logfilter">
<code class="descname">get_logfilter</code><span class="sig-paren">(</span><em>logfilter</em><span class="sig-paren">)</span><a class="headerlink" href="#orb.core.Logger.get_logfilter" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="method">
<dt id="orb.core.Logger.get_logformat">
<code class="descname">get_logformat</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#orb.core.Logger.get_logformat" title="Permalink to this definition">¶</a></dt>
<dd><p>Return a string describing the logging format</p>
</dd></dl>

<dl class="method">
<dt id="orb.core.Logger.get_logging_state">
<code class="descname">get_logging_state</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#orb.core.Logger.get_logging_state" title="Permalink to this definition">¶</a></dt>
<dd><p>Return True if the logging is set</p>
</dd></dl>

<dl class="method">
<dt id="orb.core.Logger.get_simplelogformat">
<code class="descname">get_simplelogformat</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#orb.core.Logger.get_simplelogformat" title="Permalink to this definition">¶</a></dt>
<dd><p>Return a string describing the simple logging format</p>
</dd></dl>

<dl class="method">
<dt id="orb.core.Logger.listen">
<code class="descname">listen</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#orb.core.Logger.listen" title="Permalink to this definition">¶</a></dt>
<dd><p>Listen and handle logging sent on TCP socket</p>
</dd></dl>

<dl class="attribute">
<dt id="orb.core.Logger.logfilters">
<code class="descname">logfilters</code><em class="property"> = {'default': &lt;orb.core.ExtDebugLoggingFilter object&gt;, 'extdebug': &lt;orb.core.ExtDebugLoggingFilter object&gt;, 'extinfo': &lt;orb.core.ExtInfoLoggingFilter object&gt;, 'none': &lt;orb.core.NoLoggingFilter object&gt;}</em><a class="headerlink" href="#orb.core.Logger.logfilters" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="method">
<dt id="orb.core.Logger.start_file_logging">
<code class="descname">start_file_logging</code><span class="sig-paren">(</span><em>logfile_path=None</em>, <em>logfilter=None</em><span class="sig-paren">)</span><a class="headerlink" href="#orb.core.Logger.start_file_logging" title="Permalink to this definition">¶</a></dt>
<dd><p>Start file logging</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><strong>logfile_path</strong> – Path to the logfile. If none is provided
a default logfile path is used.</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="method">
<dt id="orb.core.Logger.start_logging">
<code class="descname">start_logging</code><span class="sig-paren">(</span><em>logfilter=None</em><span class="sig-paren">)</span><a class="headerlink" href="#orb.core.Logger.start_logging" title="Permalink to this definition">¶</a></dt>
<dd><p>Reset logging only if logging is not set</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><strong>logfilter</strong> – If set to None, default logfilter set at
init will be applied (default None)</td>
</tr>
</tbody>
</table>
</dd></dl>

</dd></dl>

<dl class="class">
<dt id="orb.core.NoInstrumentConfigParams">
<em class="property">class </em><code class="descclassname">orb.core.</code><code class="descname">NoInstrumentConfigParams</code><a class="headerlink" href="#orb.core.NoInstrumentConfigParams" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <a class="reference internal" href="#orb.core.ROParams" title="orb.core.ROParams"><code class="xref py py-class docutils literal notranslate"><span class="pre">orb.core.ROParams</span></code></a></p>
<p>Special dictionary which elements can be accessed like
attributes.</p>
<p>Attributes are read-only and may be defined only once.</p>
</dd></dl>

<dl class="class">
<dt id="orb.core.NoLoggingFilter">
<em class="property">class </em><code class="descclassname">orb.core.</code><code class="descname">NoLoggingFilter</code><span class="sig-paren">(</span><em>name=''</em><span class="sig-paren">)</span><a class="headerlink" href="#orb.core.NoLoggingFilter" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <a class="reference external" href="https://docs.python.org/3/library/logging.html#logging.Filter" title="(in Python v3.7)"><code class="xref py py-class docutils literal notranslate"><span class="pre">logging.Filter</span></code></a></p>
<dl class="method">
<dt id="orb.core.NoLoggingFilter.filter">
<code class="descname">filter</code><span class="sig-paren">(</span><em>record</em><span class="sig-paren">)</span><a class="headerlink" href="#orb.core.NoLoggingFilter.filter" title="Permalink to this definition">¶</a></dt>
<dd><p>Determine if the specified record is to be logged.</p>
<p>Is the specified record to be logged? Returns 0 for no, nonzero for
yes. If deemed appropriate, the record may be modified in-place.</p>
</dd></dl>

</dd></dl>

<dl class="class">
<dt id="orb.core.OCube">
<em class="property">class </em><code class="descclassname">orb.core.</code><code class="descname">OCube</code><span class="sig-paren">(</span><em>data</em>, <em>params</em>, <em>**kwargs</em><span class="sig-paren">)</span><a class="headerlink" href="#orb.core.OCube" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <a class="reference internal" href="#orb.core.Cube" title="orb.core.Cube"><code class="xref py py-class docutils literal notranslate"><span class="pre">orb.core.Cube</span></code></a></p>
<p>Provide additional cube methods when observation parameters are known.</p>
<div class="admonition warning">
<p class="first admonition-title">Warning</p>
<p class="last">This class cannot be used alone.</p>
</div>
<dl class="method">
<dt id="orb.core.OCube.get_calibration_coeff_map">
<code class="descname">get_calibration_coeff_map</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#orb.core.OCube.get_calibration_coeff_map" title="Permalink to this definition">¶</a></dt>
<dd><p>Return calibration laser map</p>
</dd></dl>

<dl class="method">
<dt id="orb.core.OCube.get_calibration_laser_map">
<code class="descname">get_calibration_laser_map</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#orb.core.OCube.get_calibration_laser_map" title="Permalink to this definition">¶</a></dt>
<dd><p>Return calibration laser map</p>
</dd></dl>

<dl class="method">
<dt id="orb.core.OCube.get_theta_map">
<code class="descname">get_theta_map</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#orb.core.OCube.get_theta_map" title="Permalink to this definition">¶</a></dt>
<dd><p>Return the incident angle map from the calibration laser map</p>
</dd></dl>

<dl class="method">
<dt id="orb.core.OCube.get_uncalibrated_filter_bandpass">
<code class="descname">get_uncalibrated_filter_bandpass</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#orb.core.OCube.get_uncalibrated_filter_bandpass" title="Permalink to this definition">¶</a></dt>
<dd><p>Return filter bandpass as two 2d matrices (min, max) in pixels</p>
</dd></dl>

<dl class="method">
<dt id="orb.core.OCube.load_params">
<code class="descname">load_params</code><span class="sig-paren">(</span><em>params</em><span class="sig-paren">)</span><a class="headerlink" href="#orb.core.OCube.load_params" title="Permalink to this definition">¶</a></dt>
<dd><p>Load observation parameters</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Params:</th><td class="field-body">Path to an option file.</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="method">
<dt id="orb.core.OCube.validate">
<code class="descname">validate</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#orb.core.OCube.validate" title="Permalink to this definition">¶</a></dt>
<dd><p>Check if this class is valid</p>
</dd></dl>

</dd></dl>

<dl class="class">
<dt id="orb.core.OptionFile">
<em class="property">class </em><code class="descclassname">orb.core.</code><code class="descname">OptionFile</code><span class="sig-paren">(</span><em>option_file_path</em>, <em>protected_keys=[]</em><span class="sig-paren">)</span><a class="headerlink" href="#orb.core.OptionFile" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <a class="reference external" href="https://docs.python.org/3/library/functions.html#object" title="(in Python v3.7)"><code class="xref py py-class docutils literal notranslate"><span class="pre">object</span></code></a></p>
<p>Manage an option file.</p>
<p>An option file is a file containing keywords and values and
optionally some comments indicated by ‘#’, e.g.:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="c1">## ORBS configuration file</span>
<span class="c1"># Author: Thomas Martin &lt;thomas.martin.1@ulaval.ca&gt;</span>
<span class="c1"># File : config.orb</span>
<span class="c1">## Observatory</span>
<span class="n">OBSERVATORY_NAME</span> <span class="n">OMM</span> <span class="c1"># Observatory name</span>
<span class="n">TELESCOPE_NAME</span> <span class="n">OMM</span> <span class="c1"># Telescope name</span>
<span class="n">INSTRUMENT_NAME</span> <span class="n">SpIOMM</span> <span class="c1"># Instrument name</span>
<span class="n">OBS_LAT</span> <span class="mf">45.455000</span> <span class="c1"># Observatory latitude</span>
<span class="n">OBS_LON</span> <span class="o">-</span><span class="mf">71.153000</span> <span class="c1"># Observatory longitude</span>
</pre></div>
</div>
<div class="admonition note">
<p class="first admonition-title">Note</p>
<p class="last">The special keyword <strong>INCLUDE</strong> can be used to give the
path to another option file that must be included. Note that
existing keywords will be overriden so the INCLUDE keyword is
best placed at the very beginning of the option file.</p>
</div>
<div class="admonition note">
<p class="first admonition-title">Note</p>
<p class="last">Repeated keywords override themselves. Only the
protected keywords (‘REG’, ‘TUNE’) are all kept.</p>
</div>
<div class="admonition note">
<p class="first admonition-title">Note</p>
<p class="last">The first line starting with ‘##’ is considered as a header
of the file and can be used to give a description of the file.</p>
</div>
<dl class="method">
<dt id="orb.core.OptionFile.get">
<code class="descname">get</code><span class="sig-paren">(</span><em>key</em>, <em>cast=&lt;type 'str'&gt;</em><span class="sig-paren">)</span><a class="headerlink" href="#orb.core.OptionFile.get" title="Permalink to this definition">¶</a></dt>
<dd><p>Return the value associated to a keyword.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first last simple">
<li><strong>key</strong> – keyword</li>
<li><strong>cast</strong> – (Optional) Cast function for the returned value
(default str).</li>
</ul>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="method">
<dt id="orb.core.OptionFile.get_bad_frames">
<code class="descname">get_bad_frames</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#orb.core.OptionFile.get_bad_frames" title="Permalink to this definition">¶</a></dt>
<dd><p>Get bad frames.</p>
<p>Defined for the special keyword ‘BAD_FRAMES’.</p>
</dd></dl>

<dl class="method">
<dt id="orb.core.OptionFile.get_filter_edges">
<code class="descname">get_filter_edges</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#orb.core.OptionFile.get_filter_edges" title="Permalink to this definition">¶</a></dt>
<dd><p>Get filter eges parameters.</p>
<p>Defined for the special keyword ‘FILTER_EDGES’.</p>
</dd></dl>

<dl class="method">
<dt id="orb.core.OptionFile.get_fringes">
<code class="descname">get_fringes</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#orb.core.OptionFile.get_fringes" title="Permalink to this definition">¶</a></dt>
<dd><p>Get fringes</p>
<p>Defined for the special keyword ‘FRINGES’.</p>
</dd></dl>

<dl class="method">
<dt id="orb.core.OptionFile.get_lines">
<code class="descname">get_lines</code><span class="sig-paren">(</span><em>nm_min=None</em>, <em>nm_max=None</em>, <em>delta_nm=None</em><span class="sig-paren">)</span><a class="headerlink" href="#orb.core.OptionFile.get_lines" title="Permalink to this definition">¶</a></dt>
<dd><p>Get lines parameters.</p>
<p>Defined for the special keyword ‘LINES’.</p>
<p>All optional keywords are only used if the keyword SKY is
used.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first last simple">
<li><strong>nm_min</strong> – (Optional) min wavelength of the lines in nm
(default None).</li>
<li><strong>nm_max</strong> – (Optional) max wavelength of the lines in nm
(default None).</li>
<li><strong>delta_nm</strong> – (Optional) wavelength resolution in nm as the minimum
wavelength interval of the spectrum. Lines comprises in half
of this interval are merged (default None).</li>
</ul>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="method">
<dt id="orb.core.OptionFile.get_regions_parameters">
<code class="descname">get_regions_parameters</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#orb.core.OptionFile.get_regions_parameters" title="Permalink to this definition">¶</a></dt>
<dd><p>Get regions parameters.</p>
<p>Defined for the special keyword ‘REG’.</p>
</dd></dl>

<dl class="method">
<dt id="orb.core.OptionFile.get_tuning_parameters">
<code class="descname">get_tuning_parameters</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#orb.core.OptionFile.get_tuning_parameters" title="Permalink to this definition">¶</a></dt>
<dd><p>Return the list of tuning parameters.</p>
<p>Defined for the special keyword ‘TUNE’.</p>
</dd></dl>

<dl class="method">
<dt id="orb.core.OptionFile.iteritems">
<code class="descname">iteritems</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#orb.core.OptionFile.iteritems" title="Permalink to this definition">¶</a></dt>
<dd><p>Implement iteritems function often used with iterable objects</p>
</dd></dl>

<dl class="attribute">
<dt id="orb.core.OptionFile.protected_keys">
<code class="descname">protected_keys</code><em class="property"> = ['REG', 'TUNE']</em><a class="headerlink" href="#orb.core.OptionFile.protected_keys" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

</dd></dl>

<dl class="class">
<dt id="orb.core.OutHDFCube">
<em class="property">class </em><code class="descclassname">orb.core.</code><code class="descname">OutHDFCube</code><span class="sig-paren">(</span><em>export_path</em>, <em>shape</em>, <em>overwrite=False</em>, <em>reset=False</em>, <em>**kwargs</em><span class="sig-paren">)</span><a class="headerlink" href="#orb.core.OutHDFCube" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <a class="reference internal" href="#orb.core.Tools" title="orb.core.Tools"><code class="xref py py-class docutils literal notranslate"><span class="pre">orb.core.Tools</span></code></a></p>
<p>Output HDF5 Cube class.</p>
<p>This class must be used to output a valid HDF5 cube.</p>
<div class="admonition warning">
<p class="first admonition-title">Warning</p>
<p class="last">The underlying dataset is not readonly and might be
overwritten.</p>
</div>
<div class="admonition note">
<p class="first admonition-title">Note</p>
<p class="last">This class has been created because
<a class="reference internal" href="#orb.core.HDFCube" title="orb.core.HDFCube"><code class="xref py py-class docutils literal notranslate"><span class="pre">orb.core.HDFCube</span></code></a> must not be able to change its
underlying dataset (the HDF5 cube is always read-only).</p>
</div>
<dl class="method">
<dt id="orb.core.OutHDFCube.append_calibration_laser_map">
<code class="descname">append_calibration_laser_map</code><span class="sig-paren">(</span><em>calib_map</em>, <em>header=None</em><span class="sig-paren">)</span><a class="headerlink" href="#orb.core.OutHDFCube.append_calibration_laser_map" title="Permalink to this definition">¶</a></dt>
<dd><p>Append a calibration laser map to the HDF5 cube.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first last simple">
<li><strong>calib_map</strong> – Calibration laser map to append.</li>
<li><strong>header</strong> – (Optional) Header to append (default None)</li>
</ul>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="method">
<dt id="orb.core.OutHDFCube.append_deep_frame">
<code class="descname">append_deep_frame</code><span class="sig-paren">(</span><em>deep_frame</em><span class="sig-paren">)</span><a class="headerlink" href="#orb.core.OutHDFCube.append_deep_frame" title="Permalink to this definition">¶</a></dt>
<dd><p>Append a deep frame to the HDF5 cube.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><strong>deep_frame</strong> – Deep frame to append.</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="method">
<dt id="orb.core.OutHDFCube.append_energy_map">
<code class="descname">append_energy_map</code><span class="sig-paren">(</span><em>energy_map</em><span class="sig-paren">)</span><a class="headerlink" href="#orb.core.OutHDFCube.append_energy_map" title="Permalink to this definition">¶</a></dt>
<dd><p>Append an energy map to the HDF5 cube.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><strong>energy_map</strong> – Energy map to append.</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="method">
<dt id="orb.core.OutHDFCube.append_header">
<code class="descname">append_header</code><span class="sig-paren">(</span><em>header</em><span class="sig-paren">)</span><a class="headerlink" href="#orb.core.OutHDFCube.append_header" title="Permalink to this definition">¶</a></dt>
<dd><p>Append a header to the HDF5 cube.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><strong>header</strong> – header to append.</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="method">
<dt id="orb.core.OutHDFCube.append_image_list">
<code class="descname">append_image_list</code><span class="sig-paren">(</span><em>image_list</em><span class="sig-paren">)</span><a class="headerlink" href="#orb.core.OutHDFCube.append_image_list" title="Permalink to this definition">¶</a></dt>
<dd><p>Append an image list to the HDF5 cube.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><strong>image_list</strong> – Image list to append.</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="method">
<dt id="orb.core.OutHDFCube.close">
<code class="descname">close</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#orb.core.OutHDFCube.close" title="Permalink to this definition">¶</a></dt>
<dd><p>Close the HDF5 cube. Class cannot work properly once this
method is called so delete it. e.g.:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">outhdfcube</span><span class="o">.</span><span class="n">close</span><span class="p">()</span>
<span class="k">del</span> <span class="n">outhdfcube</span>
</pre></div>
</div>
</dd></dl>

<dl class="method">
<dt id="orb.core.OutHDFCube.write_frame">
<code class="descname">write_frame</code><span class="sig-paren">(</span><em>index</em>, <em>data=None</em>, <em>header=None</em>, <em>mask=None</em>, <em>record_stats=False</em>, <em>force_float32=True</em>, <em>section=None</em>, <em>force_complex64=False</em>, <em>compress=False</em><span class="sig-paren">)</span><a class="headerlink" href="#orb.core.OutHDFCube.write_frame" title="Permalink to this definition">¶</a></dt>
<dd><p>Write a frame</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first last simple">
<li><strong>index</strong> – Index of the frame</li>
<li><strong>data</strong> – (Optional) Frame data (default None).</li>
<li><strong>header</strong> – (Optional) Frame header (default None).</li>
<li><strong>mask</strong> – (Optional) Frame mask (default None).</li>
<li><strong>record_stats</strong> – (Optional) If True Mean and Median of the
frame are appended as attributes (data must be set) (defaut
False).</li>
<li><strong>force_float32</strong> – (Optional) If True, data type is forced
to numpy.float32 type (default True).</li>
<li><strong>section</strong> – (Optional) If not None, must be a 4-tuple
[xmin, xmax, ymin, ymax] giving the section to write instead
of the whole frame. Useful to modify only a part of the
frame (deafult None).</li>
<li><strong>force_complex64</strong> – (Optional) If True, data type is
forced to numpy.complex64 type (default False).</li>
<li><strong>compress</strong> – (Optional) If True, data is lossely
compressed using a gzip algorithm (default False).</li>
</ul>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="method">
<dt id="orb.core.OutHDFCube.write_frame_attribute">
<code class="descname">write_frame_attribute</code><span class="sig-paren">(</span><em>index</em>, <em>attr</em>, <em>value</em><span class="sig-paren">)</span><a class="headerlink" href="#orb.core.OutHDFCube.write_frame_attribute" title="Permalink to this definition">¶</a></dt>
<dd><p>Write a frame attribute</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first last simple">
<li><strong>index</strong> – Index of the frame</li>
<li><strong>attr</strong> – Attribute name</li>
<li><strong>value</strong> – Value of the attribute to write</li>
</ul>
</td>
</tr>
</tbody>
</table>
</dd></dl>

</dd></dl>

<dl class="class">
<dt id="orb.core.OutHDFQuadCube">
<em class="property">class </em><code class="descclassname">orb.core.</code><code class="descname">OutHDFQuadCube</code><span class="sig-paren">(</span><em>export_path</em>, <em>shape</em>, <em>quad_nb</em>, <em>overwrite=False</em>, <em>reset=False</em>, <em>**kwargs</em><span class="sig-paren">)</span><a class="headerlink" href="#orb.core.OutHDFQuadCube" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <a class="reference internal" href="#orb.core.OutHDFCube" title="orb.core.OutHDFCube"><code class="xref py py-class docutils literal notranslate"><span class="pre">orb.core.OutHDFCube</span></code></a></p>
<p>Output HDF5 Cube class saved in quadrants.</p>
<p>This class can be used to output a valid HDF5 cube.</p>
<dl class="method">
<dt id="orb.core.OutHDFQuadCube.write_quad">
<code class="descname">write_quad</code><span class="sig-paren">(</span><em>index</em>, <em>data=None</em>, <em>header=None</em>, <em>force_float32=True</em>, <em>force_complex64=False</em>, <em>compress=False</em><span class="sig-paren">)</span><a class="headerlink" href="#orb.core.OutHDFQuadCube.write_quad" title="Permalink to this definition">¶</a></dt>
<dd><p>“Write a quadrant</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first last simple">
<li><strong>index</strong> – Index of the quadrant</li>
<li><strong>data</strong> – (Optional) Frame data (default None).</li>
<li><strong>header</strong> – (Optional) Frame header (default None).</li>
<li><strong>mask</strong> – (Optional) Frame mask (default None).</li>
<li><strong>record_stats</strong> – (Optional) If True Mean and Median of the
frame are appended as attributes (data must be set) (defaut
False).</li>
<li><strong>force_float32</strong> – (Optional) If True, data type is forced
to numpy.float32 type (default True).</li>
<li><strong>section</strong> – (Optional) If not None, must be a 4-tuple
[xmin, xmax, ymin, ymax] giving the section to write instead
of the whole frame. Useful to modify only a part of the
frame (deafult None).</li>
<li><strong>force_complex64</strong> – (Optional) If True, data type is
forced to numpy.complex64 type (default False).</li>
<li><strong>compress</strong> – (Optional) If True, data is lossely
compressed using a gzip algorithm (default False).</li>
</ul>
</td>
</tr>
</tbody>
</table>
</dd></dl>

</dd></dl>

<dl class="class">
<dt id="orb.core.ParamsFile">
<em class="property">class </em><code class="descclassname">orb.core.</code><code class="descname">ParamsFile</code><span class="sig-paren">(</span><em>file_path</em>, <em>reset=True</em>, <em>**kwargs</em><span class="sig-paren">)</span><a class="headerlink" href="#orb.core.ParamsFile" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <a class="reference internal" href="#orb.core.Tools" title="orb.core.Tools"><code class="xref py py-class docutils literal notranslate"><span class="pre">orb.core.Tools</span></code></a></p>
<p>Manage correspondance between multiple dict containing the
same parameters and a file on disk.</p>
<p>Its behaviour is similar to <code class="xref py py-class docutils literal notranslate"><span class="pre">astrometry.StarsParams</span></code>.</p>
<dl class="method">
<dt id="orb.core.ParamsFile.append">
<code class="descname">append</code><span class="sig-paren">(</span><em>params</em><span class="sig-paren">)</span><a class="headerlink" href="#orb.core.ParamsFile.append" title="Permalink to this definition">¶</a></dt>
<dd><p>Append a dict to the file.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><strong>params</strong> – A dict of parameters</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="attribute">
<dt id="orb.core.ParamsFile.f">
<code class="descname">f</code><em class="property"> = None</em><a class="headerlink" href="#orb.core.ParamsFile.f" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="method">
<dt id="orb.core.ParamsFile.get_data">
<code class="descname">get_data</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#orb.core.ParamsFile.get_data" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

</dd></dl>

<dl class="class">
<dt id="orb.core.PhaseFile">
<em class="property">class </em><code class="descclassname">orb.core.</code><code class="descname">PhaseFile</code><span class="sig-paren">(</span><em>filter_name</em>, <em>**kwargs</em><span class="sig-paren">)</span><a class="headerlink" href="#orb.core.PhaseFile" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <a class="reference internal" href="#orb.core.Tools" title="orb.core.Tools"><code class="xref py py-class docutils literal notranslate"><span class="pre">orb.core.Tools</span></code></a></p>
<p>Manage phase files</p>
<dl class="method">
<dt id="orb.core.PhaseFile.get_improved_phase">
<code class="descname">get_improved_phase</code><span class="sig-paren">(</span><em>calib_laser_nm</em>, <em>return_spline=True</em><span class="sig-paren">)</span><a class="headerlink" href="#orb.core.PhaseFile.get_improved_phase" title="Permalink to this definition">¶</a></dt>
<dd><p>Return a scipy.interpolate.UnivariateSpline instance
corresponding to the phase at a given calibration laser
wavelength (i.e. a given incident angle theta).</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first last simple">
<li><strong>calib_laser_nm</strong> – Calibration laser wavelength in nm.</li>
<li><strong>return_spline</strong> – (Optional) If not True, the phase vector
is returned without any spline interpolation. Useful and
faster when no interpolation is needed (default True).</li>
</ul>
</td>
</tr>
</tbody>
</table>
<div class="admonition note">
<p class="first admonition-title">Note</p>
<p class="last">The returned spline is projected along an axis in
cm-1</p>
</div>
</dd></dl>

<dl class="method">
<dt id="orb.core.PhaseFile.write_improved_phase_file">
<code class="descname">write_improved_phase_file</code><span class="sig-paren">(</span><em>step</em>, <em>order</em>, <em>angles</em>, <em>phases</em>, <em>phases_err_min</em>, <em>phases_err_max</em><span class="sig-paren">)</span><a class="headerlink" href="#orb.core.PhaseFile.write_improved_phase_file" title="Permalink to this definition">¶</a></dt>
<dd><p>Write an improved phase file as an hdf5 archive.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first last simple">
<li><strong>step</strong> – Step size in nm</li>
<li><strong>order</strong> – Folding order.</li>
<li><strong>angles</strong> – limit angles of each phase group.</li>
<li><strong>phases</strong> – list of phase vectors corresponding to each
angle group.</li>
<li><strong>phases_err_min</strong> – list of min error vectors of each phase
vector.</li>
<li><strong>phases_err_max</strong> – list of max error vectors of each phase
vector.</li>
</ul>
</td>
</tr>
</tbody>
</table>
<div class="admonition warning">
<p class="first admonition-title">Warning</p>
<p class="last">To avoid unwanted replacement of ORB’s data files
the phase file is not written in ORB folder but at the root
folder. It must thus be placed in the orb/data folder to be
readable with self.read_improved_phase_file.</p>
</div>
</dd></dl>

</dd></dl>

<dl class="class">
<dt id="orb.core.ProgressBar">
<em class="property">class </em><code class="descclassname">orb.core.</code><code class="descname">ProgressBar</code><span class="sig-paren">(</span><em>max_index</em>, <em>silent=False</em><span class="sig-paren">)</span><a class="headerlink" href="#orb.core.ProgressBar" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <a class="reference external" href="https://docs.python.org/3/library/functions.html#object" title="(in Python v3.7)"><code class="xref py py-class docutils literal notranslate"><span class="pre">object</span></code></a></p>
<p>Display a simple progress bar in the terminal</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><strong>max_index</strong> – Index representing a 100% completed task.</td>
</tr>
</tbody>
</table>
<dl class="attribute">
<dt id="orb.core.ProgressBar.BAR_LENGTH">
<code class="descname">BAR_LENGTH</code><em class="property"> = 10.0</em><a class="headerlink" href="#orb.core.ProgressBar.BAR_LENGTH" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="attribute">
<dt id="orb.core.ProgressBar.MAX_CARAC">
<code class="descname">MAX_CARAC</code><em class="property"> = 78</em><a class="headerlink" href="#orb.core.ProgressBar.MAX_CARAC" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="attribute">
<dt id="orb.core.ProgressBar.REFRESH_COUNT">
<code class="descname">REFRESH_COUNT</code><em class="property"> = 3L</em><a class="headerlink" href="#orb.core.ProgressBar.REFRESH_COUNT" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="method">
<dt id="orb.core.ProgressBar.end">
<code class="descname">end</code><span class="sig-paren">(</span><em>silent=False</em><span class="sig-paren">)</span><a class="headerlink" href="#orb.core.ProgressBar.end" title="Permalink to this definition">¶</a></dt>
<dd><p>End the progress bar and display the total time needed to
complete the process.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><strong>silent</strong> – If True remove the progress bar from the
screen. Further diplayed text will be displayed above the
progress bar.</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="method">
<dt id="orb.core.ProgressBar.update">
<code class="descname">update</code><span class="sig-paren">(</span><em>index</em>, <em>info=''</em>, <em>remains=True</em>, <em>nolog=True</em><span class="sig-paren">)</span><a class="headerlink" href="#orb.core.ProgressBar.update" title="Permalink to this definition">¶</a></dt>
<dd><p>Update the progress bar.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first last simple">
<li><strong>index</strong> – Index representing the progress of the
process. Must be less than index_max.</li>
<li><strong>info</strong> – (Optional) Information to be displayed as
comments (default ‘’).</li>
<li><strong>remains</strong> – (Optional) If True, remaining time is
displayed (default True).</li>
<li><strong>nolog</strong> – (Optional) No logging of the printed text is
made (default True).</li>
</ul>
</td>
</tr>
</tbody>
</table>
</dd></dl>

</dd></dl>

<dl class="class">
<dt id="orb.core.ROParams">
<em class="property">class </em><code class="descclassname">orb.core.</code><code class="descname">ROParams</code><a class="headerlink" href="#orb.core.ROParams" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#dict" title="(in Python v3.7)"><code class="xref py py-class docutils literal notranslate"><span class="pre">dict</span></code></a></p>
<p>Special dictionary which elements can be accessed like
attributes.</p>
<p>Attributes are read-only and may be defined only once.</p>
<dl class="method">
<dt id="orb.core.ROParams.convert">
<code class="descname">convert</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#orb.core.ROParams.convert" title="Permalink to this definition">¶</a></dt>
<dd><p>Convert to a nice pickable object</p>
</dd></dl>

<dl class="method">
<dt id="orb.core.ROParams.reset">
<code class="descname">reset</code><span class="sig-paren">(</span><em>key</em>, <em>value</em><span class="sig-paren">)</span><a class="headerlink" href="#orb.core.ROParams.reset" title="Permalink to this definition">¶</a></dt>
<dd><p>Force config parameter reset</p>
</dd></dl>

</dd></dl>

<dl class="class">
<dt id="orb.core.Standard">
<em class="property">class </em><code class="descclassname">orb.core.</code><code class="descname">Standard</code><span class="sig-paren">(</span><em>std_name</em>, <em>**kwargs</em><span class="sig-paren">)</span><a class="headerlink" href="#orb.core.Standard" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <a class="reference internal" href="#orb.core.Tools" title="orb.core.Tools"><code class="xref py py-class docutils literal notranslate"><span class="pre">orb.core.Tools</span></code></a></p>
<p>Manage standard files and photometrical calibration</p>
<dl class="attribute">
<dt id="orb.core.Standard.ang">
<code class="descname">ang</code><em class="property"> = None</em><a class="headerlink" href="#orb.core.Standard.ang" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="method">
<dt id="orb.core.Standard.compute_optimal_texp">
<code class="descname">compute_optimal_texp</code><span class="sig-paren">(</span><em>step</em>, <em>order</em>, <em>seeing</em>, <em>filter_name</em>, <em>camera_number</em>, <em>saturation=30000</em>, <em>airmass=1.0</em><span class="sig-paren">)</span><a class="headerlink" href="#orb.core.Standard.compute_optimal_texp" title="Permalink to this definition">¶</a></dt>
<dd><p>Compute the optimal exposition time given the total flux of
the star in ADU/s.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first last simple">
<li><strong>step</strong> – Step size in nm</li>
<li><strong>order</strong> – Folding order</li>
<li><strong>seeing</strong> – Star’s FWHM in arcsec</li>
<li><strong>filter_name</strong> – Name of the filter</li>
<li><strong>camera_number</strong> – Number of the camera</li>
<li><strong>saturation</strong> – (Optional) Saturation value of the detector
(default 30000).</li>
<li><strong>airmass</strong> – (Optional) Airmass (default 1)</li>
</ul>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="method">
<dt id="orb.core.Standard.compute_star_flux_in_frame">
<code class="descname">compute_star_flux_in_frame</code><span class="sig-paren">(</span><em>step</em>, <em>order</em>, <em>filter_name</em>, <em>camera_number</em>, <em>airmass=1.0</em>, <em>corr=1.0</em><span class="sig-paren">)</span><a class="headerlink" href="#orb.core.Standard.compute_star_flux_in_frame" title="Permalink to this definition">¶</a></dt>
<dd><p>Return flux in ADU/s in an image.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first last simple">
<li><strong>step</strong> – Step size in nm</li>
<li><strong>order</strong> – Folding order</li>
<li><strong>filter_name</strong> – Name fo the filter</li>
<li><strong>optics_file_path</strong> – Path to the optics file</li>
<li><strong>camera_number</strong> – Number of the camera</li>
<li><strong>airmass</strong> – (Optional) Airmass (default 1)</li>
<li><strong>corr</strong> – (Optional) Correction coefficient related to the
incident angle (default 1).</li>
</ul>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="attribute">
<dt id="orb.core.Standard.flux">
<code class="descname">flux</code><em class="property"> = None</em><a class="headerlink" href="#orb.core.Standard.flux" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="method">
<dt id="orb.core.Standard.get_spectrum">
<code class="descname">get_spectrum</code><span class="sig-paren">(</span><em>step</em>, <em>order</em>, <em>n</em>, <em>wavenumber=False</em>, <em>corr=1.0</em><span class="sig-paren">)</span><a class="headerlink" href="#orb.core.Standard.get_spectrum" title="Permalink to this definition">¶</a></dt>
<dd><p>Return part of the standard spectrum corresponding to the
observation parameters.</p>
<p>Returned spectrum is calibrated in erg/cm^2/s/A</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first last simple">
<li><strong>order</strong> – Folding order</li>
<li><strong>step</strong> – Step size in um</li>
<li><strong>n</strong> – Number of steps</li>
<li><strong>wavenumber</strong> – (Optional) If True spectrum is returned along a
wavenumber axis (default False).</li>
<li><strong>corr</strong> – (Optional) Correction coefficient related to the incident
angle (default 1).</li>
</ul>
</td>
</tr>
</tbody>
</table>
</dd></dl>

</dd></dl>

<dl class="class">
<dt id="orb.core.TextColor">
<em class="property">class </em><code class="descclassname">orb.core.</code><code class="descname">TextColor</code><a class="headerlink" href="#orb.core.TextColor" title="Permalink to this definition">¶</a></dt>
<dd><p>Define ANSI Escape sequences to display text with colors.</p>
<dl class="attribute">
<dt id="orb.core.TextColor.CYAN">
<code class="descname">CYAN</code><em class="property"> = '\x1b[36m'</em><a class="headerlink" href="#orb.core.TextColor.CYAN" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="attribute">
<dt id="orb.core.TextColor.DEFAULT">
<code class="descname">DEFAULT</code><em class="property"> = '\x1b[0m'</em><a class="headerlink" href="#orb.core.TextColor.DEFAULT" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="attribute">
<dt id="orb.core.TextColor.END">
<code class="descname">END</code><em class="property"> = '\x1b[0m'</em><a class="headerlink" href="#orb.core.TextColor.END" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="attribute">
<dt id="orb.core.TextColor.GREEN">
<code class="descname">GREEN</code><em class="property"> = '\x1b[32m'</em><a class="headerlink" href="#orb.core.TextColor.GREEN" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="attribute">
<dt id="orb.core.TextColor.KORED">
<code class="descname">KORED</code><em class="property"> = '\x1b[91m'</em><a class="headerlink" href="#orb.core.TextColor.KORED" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="attribute">
<dt id="orb.core.TextColor.OKGREEN">
<code class="descname">OKGREEN</code><em class="property"> = '\x1b[92m'</em><a class="headerlink" href="#orb.core.TextColor.OKGREEN" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="attribute">
<dt id="orb.core.TextColor.RED">
<code class="descname">RED</code><em class="property"> = '\x1b[31m'</em><a class="headerlink" href="#orb.core.TextColor.RED" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="attribute">
<dt id="orb.core.TextColor.YELLOW">
<code class="descname">YELLOW</code><em class="property"> = '\x1b[33m'</em><a class="headerlink" href="#orb.core.TextColor.YELLOW" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

</dd></dl>

<dl class="class">
<dt id="orb.core.Tools">
<em class="property">class </em><code class="descclassname">orb.core.</code><code class="descname">Tools</code><span class="sig-paren">(</span><em>instrument=None</em>, <em>data_prefix='./temp/data.'</em>, <em>tuning_parameters={}</em>, <em>ncpus=None</em>, <em>silent=False</em><span class="sig-paren">)</span><a class="headerlink" href="#orb.core.Tools" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <a class="reference external" href="https://docs.python.org/3/library/functions.html#object" title="(in Python v3.7)"><code class="xref py py-class docutils literal notranslate"><span class="pre">object</span></code></a></p>
<p>Parent class of all classes of orb.</p>
<p>Manage configuration file, implement basic methods and manage the
server for parallel processing.</p>
<dl class="method">
<dt id="orb.core.Tools.get_param">
<code class="descname">get_param</code><span class="sig-paren">(</span><em>key</em><span class="sig-paren">)</span><a class="headerlink" href="#orb.core.Tools.get_param" title="Permalink to this definition">¶</a></dt>
<dd><p>Get class parameter</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><strong>key</strong> – parameter key</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="attribute">
<dt id="orb.core.Tools.instruments">
<code class="descname">instruments</code><em class="property"> = ['sitelle', 'spiomm']</em><a class="headerlink" href="#orb.core.Tools.instruments" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="method">
<dt id="orb.core.Tools.load_sip">
<code class="descname">load_sip</code><span class="sig-paren">(</span><em>fits_path</em><span class="sig-paren">)</span><a class="headerlink" href="#orb.core.Tools.load_sip" title="Permalink to this definition">¶</a></dt>
<dd><p>Return a astropy.wcs.WCS object from a FITS file containing
SIP parameters.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><strong>fits_path</strong> – Path to the FITS file</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="method">
<dt id="orb.core.Tools.open_file">
<code class="descname">open_file</code><span class="sig-paren">(</span><em>file_name</em>, <em>mode='w'</em><span class="sig-paren">)</span><a class="headerlink" href="#orb.core.Tools.open_file" title="Permalink to this definition">¶</a></dt>
<dd><p>Open a file in write mode (by default) and return a file
object.</p>
<p>Create the file if it doesn’t exist (only in write mode).</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first last simple">
<li><strong>fits_name</strong> – Path to the file, can be either
relative or absolute.</li>
<li><strong>mode</strong> – (Optional) Can be ‘w’ for write mode, ‘r’ for
read mode and ‘a’ for append mode.</li>
</ul>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="method">
<dt id="orb.core.Tools.open_hdf5">
<code class="descname">open_hdf5</code><span class="sig-paren">(</span><em>file_path</em>, <em>mode</em><span class="sig-paren">)</span><a class="headerlink" href="#orb.core.Tools.open_hdf5" title="Permalink to this definition">¶</a></dt>
<dd><p>Return a <code class="xref py py-class docutils literal notranslate"><span class="pre">h5py.File</span></code> instance with some
informations.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first last simple">
<li><strong>file_path</strong> – Path to the hdf5 file.</li>
<li><strong>mode</strong> – Opening mode. Can be ‘r’, ‘r+’, ‘w’, ‘w-‘, ‘x’,
‘a’.</li>
</ul>
</td>
</tr>
</tbody>
</table>
<div class="admonition note">
<p class="first admonition-title">Note</p>
<p class="last">Please refer to <a class="reference external" href="http://www.h5py.org/">http://www.h5py.org/</a>.</p>
</div>
</dd></dl>

<dl class="method">
<dt id="orb.core.Tools.read_fits">
<code class="descname">read_fits</code><span class="sig-paren">(</span><em>fits_path</em>, <em>no_error=False</em>, <em>nan_filter=False</em>, <em>return_header=False</em>, <em>return_hdu_only=False</em>, <em>return_mask=False</em>, <em>silent=False</em>, <em>delete_after=False</em>, <em>data_index=0</em>, <em>image_mode='classic'</em>, <em>chip_index=None</em>, <em>binning=None</em>, <em>fix_header=True</em>, <em>dtype=&lt;type 'float'&gt;</em><span class="sig-paren">)</span><a class="headerlink" href="#orb.core.Tools.read_fits" title="Permalink to this definition">¶</a></dt>
<dd><p>Read a FITS data file and returns its data.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first last simple">
<li><strong>fits_path</strong> – Path to the file, can be either
relative or absolut.</li>
<li><strong>no_error</strong> – (Optional) If True this function will only
display a warning message if the file does not exist (so it
does not raise an exception) (default False)</li>
<li><strong>nan_filter</strong> – (Optional) If True replace NaN by zeros
(default False)</li>
<li><strong>return_header</strong> – (Optional) If True return a tuple (data,
header) (default False).</li>
<li><strong>return_hdu_only</strong> – (Optional) If True return FITS header
data unit only. No data will be returned (default False).</li>
<li><strong>return_mask</strong> – (Optional) If True return only the mask
corresponding to the data file (default False).</li>
<li><strong>silent</strong> – (Optional) If True no message is displayed
except if an error is raised (default False).</li>
<li><strong>delete_after</strong> – (Optional) If True delete file after
reading (default False).</li>
<li><strong>data_index</strong> – (Optional) Index of data in the header data
unit (Default 0).</li>
<li><strong>image_mode</strong> – (Optional) Can be ‘sitelle’, ‘spiomm’ or
‘classic’. In ‘sitelle’ mode, the parameter
chip_index must also be set to 0 or 1. In this mode only
one of both SITELLE quadrants is returned. In ‘classic’ mode
the whole frame is returned (default ‘classic’).</li>
<li><strong>chip_index</strong> – (Optional) Index of the chip of the
SITELLE image. Used only if image_mode is set to ‘sitelle’
In this case, must be 1 or 2. Else must be None (default
None).</li>
<li><strong>binning</strong> – (Optional) If not None, returned data is
binned by this amount (must be an integer &gt;= 1)</li>
<li><strong>fix_header</strong> – (Optional) If True, fits header is
fixed to avoid errors due to header inconsistencies
(e.g. WCS errors) (default True).</li>
<li><strong>dtype</strong> – (Optional) Data is converted to
the given dtype (e.g. np.float32, default float).</li>
</ul>
</td>
</tr>
</tbody>
</table>
<div class="admonition note">
<p class="first admonition-title">Note</p>
<p class="last">Please refer to
<a class="reference external" href="http://www.stsci.edu/institute/software_hardware/pyfits/">http://www.stsci.edu/institute/software_hardware/pyfits/</a> for
more information on PyFITS module. And
<a class="reference external" href="http://fits.gsfc.nasa.gov/">http://fits.gsfc.nasa.gov/</a> for more information on FITS
files.</p>
</div>
</dd></dl>

<dl class="method">
<dt id="orb.core.Tools.read_hdf5">
<code class="descname">read_hdf5</code><span class="sig-paren">(</span><em>file_path</em>, <em>return_header=False</em>, <em>dtype=&lt;type 'float'&gt;</em><span class="sig-paren">)</span><a class="headerlink" href="#orb.core.Tools.read_hdf5" title="Permalink to this definition">¶</a></dt>
<dd><p>Read an HDF5 data file created with
<code class="xref py py-meth docutils literal notranslate"><span class="pre">core.Tools.write_hdf5()</span></code>.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first last simple">
<li><strong>file_path</strong> – Path to the file, can be either
relative or absolute.</li>
<li><strong>return_header</strong> – (Optional) If True return a tuple (data,
header) (default False).</li>
<li><strong>dtype</strong> – (Optional) Data is converted to the given type
(e.g. np.float32, default float).</li>
</ul>
</td>
</tr>
</tbody>
</table>
<div class="admonition note">
<p class="first admonition-title">Note</p>
<p class="last">Please refer to <a class="reference external" href="http://www.h5py.org/">http://www.h5py.org/</a>.</p>
</div>
</dd></dl>

<dl class="method">
<dt id="orb.core.Tools.save_sip">
<code class="descname">save_sip</code><span class="sig-paren">(</span><em>fits_path</em>, <em>hdr</em>, <em>overwrite=True</em><span class="sig-paren">)</span><a class="headerlink" href="#orb.core.Tools.save_sip" title="Permalink to this definition">¶</a></dt>
<dd><p>Save SIP parameters from a header to a blanck FITS file.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first last simple">
<li><strong>fits_path</strong> – Path to the FITS file</li>
<li><strong>hdr</strong> – header from which SIP parameters must be read</li>
<li><strong>overwrite</strong> – (Optional) Overwrite the FITS file.</li>
</ul>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="method">
<dt id="orb.core.Tools.set_config">
<code class="descname">set_config</code><span class="sig-paren">(</span><em>key</em>, <em>cast</em><span class="sig-paren">)</span><a class="headerlink" href="#orb.core.Tools.set_config" title="Permalink to this definition">¶</a></dt>
<dd><p>Set configuration parameter (from the configuration file)</p>
</dd></dl>

<dl class="method">
<dt id="orb.core.Tools.set_param">
<code class="descname">set_param</code><span class="sig-paren">(</span><em>key</em>, <em>value</em><span class="sig-paren">)</span><a class="headerlink" href="#orb.core.Tools.set_param" title="Permalink to this definition">¶</a></dt>
<dd><p>Set class parameter</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><strong>key</strong> – parameter key</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="method">
<dt id="orb.core.Tools.sort_image_list">
<code class="descname">sort_image_list</code><span class="sig-paren">(</span><em>file_list</em>, <em>image_mode</em>, <em>cube=True</em><span class="sig-paren">)</span><a class="headerlink" href="#orb.core.Tools.sort_image_list" title="Permalink to this definition">¶</a></dt>
<dd><p>Sort a list of fits files.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first last simple">
<li><strong>file_list</strong> – A list of file names</li>
<li><strong>image_mode</strong> – Image mode, can be ‘sitelle’ or ‘spiomm’.</li>
<li><strong>cube</strong> – If True, image list is considered as a cube
list. Headers are used to get the right order based on step
number instead of file path (default True).</li>
</ul>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="method">
<dt id="orb.core.Tools.write_fits">
<code class="descname">write_fits</code><span class="sig-paren">(</span><em>fits_path</em>, <em>fits_data</em>, <em>fits_header=None</em>, <em>silent=False</em>, <em>overwrite=False</em>, <em>mask=None</em>, <em>replace=False</em>, <em>record_stats=False</em><span class="sig-paren">)</span><a class="headerlink" href="#orb.core.Tools.write_fits" title="Permalink to this definition">¶</a></dt>
<dd><p>Write data in FITS format. If the file doesn’t exist create
it with its directories.</p>
<p>If the file already exists add a number to its name before the
extension (unless ‘overwrite’ option is set to True).</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first last simple">
<li><strong>fits_path</strong> – Path to the file, can be either
relative or absolut.</li>
<li><strong>fits_data</strong> – Data to be written in the file.</li>
<li><strong>fits_header</strong> – (Optional) Optional keywords to update or
create. It can be a pyfits.Header() instance or a list of
tuples [(KEYWORD_1, VALUE_1, COMMENT_1), (KEYWORD_2,
VALUE_2, COMMENT_2), …]. Standard keywords like SIMPLE,
BITPIX, NAXIS, EXTEND does not have to be passed.</li>
<li><strong>silent</strong> – (Optional) If True turn this function won’t
display any message (default False)</li>
<li><strong>overwrite</strong> – (Optional) If True overwrite the output file
if it exists (default False).</li>
<li><strong>mask</strong> – (Optional) It not None must be an array with the
same size as the given data but filled with ones and
zeros. Bad values (NaN or Inf) are converted to 1 and the
array is converted to 8 bit unsigned integers (uint8). This
array will be written to the disk with the same path
terminated by ‘_mask’. The header of the mask FITS file will
be the same as the original data (default None).</li>
<li><strong>replace</strong> – (Optional) If True and if the file already
exist, new data replace old data in the existing file. NaN
values do not replace old values. Other values replace old
values. New array MUST have the same size as the existing
array. Note that if replace is True, overwrite is
automatically set to True.</li>
<li><strong>record_stats</strong> – (Optional) If True, record mean and
median of data. Useful if they often have to be computed
(default False).</li>
</ul>
</td>
</tr>
</tbody>
</table>
<div class="admonition note">
<p class="first admonition-title">Note</p>
<p class="last">float64 data is converted to float32 data to avoid
too big files with unnecessary precision</p>
</div>
<div class="admonition note">
<p class="first admonition-title">Note</p>
<p class="last">Please refer to
<a class="reference external" href="http://www.stsci.edu/institute/software_hardware/pyfits/">http://www.stsci.edu/institute/software_hardware/pyfits/</a> for
more information on PyFITS module and
<a class="reference external" href="http://fits.gsfc.nasa.gov/">http://fits.gsfc.nasa.gov/</a> for more information on FITS
files.</p>
</div>
</dd></dl>

<dl class="method">
<dt id="orb.core.Tools.write_hdf5">
<code class="descname">write_hdf5</code><span class="sig-paren">(</span><em>file_path</em>, <em>data</em>, <em>header=None</em>, <em>silent=False</em>, <em>overwrite=False</em>, <em>max_hdu_check=True</em>, <em>compress=False</em><span class="sig-paren">)</span><a class="headerlink" href="#orb.core.Tools.write_hdf5" title="Permalink to this definition">¶</a></dt>
<dd><p>Write data in HDF5 format.</p>
<p>A header can be added to the data. This method is useful to
handle an HDF5 data file like a FITS file. It implements most
of the functionality of the method
<code class="xref py py-meth docutils literal notranslate"><span class="pre">core.Tools.write_fits()</span></code>.</p>
<div class="admonition note">
<p class="first admonition-title">Note</p>
<p class="last">The output HDF5 file can contain mutiple data header
units (HDU). Each HDU is in a specific group named ‘hdu*’, *
being the index of the HDU. The first HDU is named
HDU0. Each HDU contains one data group (HDU*/data) which
contains a numpy.ndarray and one header group
(HDU*/header). Each subgroup of a header group is a keyword
and its associated value, comment and type.</p>
</div>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first last simple">
<li><strong>file_path</strong> – Path to the HDF5 file to create</li>
<li><strong>data</strong> – A numpy array (numpy.ndarray instance) of numeric
values. If a list of arrays is given, each array will be
placed in a specific HDU. The header keyword must also be
set to a list of headers of the same length.</li>
<li><strong>header</strong> – (Optional) Optional keywords to update or
create. It can be a pyfits.Header() instance or a list of
tuples [(KEYWORD_1, VALUE_1, COMMENT_1), (KEYWORD_2,
VALUE_2, COMMENT_2), …]. Standard keywords like SIMPLE,
BITPIX, NAXIS, EXTEND does not have to be passed (default
None). It can also be a list of headers if a list of arrays
has been passed to the option ‘data’.</li>
<li><strong>max_hdu_check</strong> – (Optional): When True, if the input data
is a list (interpreted as a list of data unit), check if
it’s length is not too long to make sure that the input list
is not a single data array that has not been converted to a
numpy.ndarray format. If the number of HDU to create is
indeed very long this can be set to False (default True).</li>
<li><strong>silent</strong> – (Optional) If True turn this function won’t
display any message (default False)</li>
<li><strong>overwrite</strong> – (Optional) If True overwrite the output file
if it exists (default False).</li>
<li><strong>compress</strong> – (Optional) If True data is compressed using
the SZIP library (see
<a class="reference external" href="https://www.hdfgroup.org/doc_resource/SZIP/">https://www.hdfgroup.org/doc_resource/SZIP/</a>). SZIP library
must be installed (default False).</li>
</ul>
</td>
</tr>
</tbody>
</table>
<div class="admonition note">
<p class="first admonition-title">Note</p>
<p class="last">Please refer to <a class="reference external" href="http://www.h5py.org/">http://www.h5py.org/</a>.</p>
</div>
</dd></dl>

</dd></dl>

<dl class="class">
<dt id="orb.core.Vector1d">
<em class="property">class </em><code class="descclassname">orb.core.</code><code class="descname">Vector1d</code><span class="sig-paren">(</span><em>vector</em>, <em>params=None</em>, <em>**kwargs</em><span class="sig-paren">)</span><a class="headerlink" href="#orb.core.Vector1d" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <a class="reference external" href="https://docs.python.org/3/library/functions.html#object" title="(in Python v3.7)"><code class="xref py py-class docutils literal notranslate"><span class="pre">object</span></code></a></p>
<p>Basic 1d vector management class.</p>
<p>Useful for checking purpose.</p>
<dl class="method">
<dt id="orb.core.Vector1d.assert_params">
<code class="descname">assert_params</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#orb.core.Vector1d.assert_params" title="Permalink to this definition">¶</a></dt>
<dd><p>Assert the presence of observation parameters</p>
</dd></dl>

<dl class="method">
<dt id="orb.core.Vector1d.has_params">
<code class="descname">has_params</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#orb.core.Vector1d.has_params" title="Permalink to this definition">¶</a></dt>
<dd><p>Check the presence of observation parameters</p>
</dd></dl>

<dl class="attribute">
<dt id="orb.core.Vector1d.needed_params">
<code class="descname">needed_params</code><em class="property"> = ()</em><a class="headerlink" href="#orb.core.Vector1d.needed_params" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="attribute">
<dt id="orb.core.Vector1d.optional_params">
<code class="descname">optional_params</code><em class="property"> = ()</em><a class="headerlink" href="#orb.core.Vector1d.optional_params" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

</dd></dl>

<dl class="class">
<dt id="orb.core.Waves">
<em class="property">class </em><code class="descclassname">orb.core.</code><code class="descname">Waves</code><span class="sig-paren">(</span><em>nm</em>, <em>velocity=0.0</em><span class="sig-paren">)</span><a class="headerlink" href="#orb.core.Waves" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <a class="reference external" href="https://docs.python.org/3/library/functions.html#object" title="(in Python v3.7)"><code class="xref py py-class docutils literal notranslate"><span class="pre">object</span></code></a></p>
<p>Wave class that keep the best conversions possible from nm to cm1.</p>
<dl class="method">
<dt id="orb.core.Waves.get_cm1">
<code class="descname">get_cm1</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#orb.core.Waves.get_cm1" title="Permalink to this definition">¶</a></dt>
<dd><p>Return wavenumber of waves in cm-1 (taking velocity into account)</p>
</dd></dl>

<dl class="method">
<dt id="orb.core.Waves.get_cm1_rest">
<code class="descname">get_cm1_rest</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#orb.core.Waves.get_cm1_rest" title="Permalink to this definition">¶</a></dt>
<dd><p>Return restframe wavelength of waves in cm-1</p>
</dd></dl>

<dl class="method">
<dt id="orb.core.Waves.get_nm">
<code class="descname">get_nm</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#orb.core.Waves.get_nm" title="Permalink to this definition">¶</a></dt>
<dd><p>Return wavelength of waves in nm (taking velocity into account)</p>
</dd></dl>

<dl class="method">
<dt id="orb.core.Waves.get_nm_rest">
<code class="descname">get_nm_rest</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#orb.core.Waves.get_nm_rest" title="Permalink to this definition">¶</a></dt>
<dd><p>“Return restframe wavelength of waves in nm</p>
</dd></dl>

<dl class="method">
<dt id="orb.core.Waves.set_velocity">
<code class="descname">set_velocity</code><span class="sig-paren">(</span><em>velocity</em><span class="sig-paren">)</span><a class="headerlink" href="#orb.core.Waves.set_velocity" title="Permalink to this definition">¶</a></dt>
<dd><p>Set waves velocity.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><strong>velocity</strong> – velocity in km/s</td>
</tr>
</tbody>
</table>
</dd></dl>

</dd></dl>

</div>
<div class="section" id="module-orb.cutils">
<span id="orb-cutils-module"></span><h2>orb.cutils module<a class="headerlink" href="#module-orb.cutils" title="Permalink to this headline">¶</a></h2>
<p>CUtils is a set of C functions coded in <a class="reference external" href="http://cython.org/">Cython</a> to improve their speed.</p>
<div class="admonition note">
<p class="first admonition-title">Note</p>
<p>This file must be compiled before it can be used:</p>
<p>cython cutils.pyx</p>
<p>gcc -c -fPIC -I/usr/include/python2.7 cutils.c</p>
<p class="last">gcc -shared cutils.o -o cutils.so</p>
</div>
<dl class="function">
<dt id="orb.cutils.brute_photometry">
<code class="descclassname">orb.cutils.</code><code class="descname">brute_photometry</code><span class="sig-paren">(</span><em>ndarray im</em>, <em>ndarray star_list</em>, <em>ndarray kernel</em>, <em>int box_size</em><span class="sig-paren">)</span><a class="headerlink" href="#orb.cutils.brute_photometry" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="function">
<dt id="orb.cutils.check_cosmic_rays_neighbourhood">
<code class="descclassname">orb.cutils.</code><code class="descname">check_cosmic_rays_neighbourhood</code><span class="sig-paren">(</span><em>ndarray frame</em>, <em>ndarray cr_map</em>, <em>int box_size</em>, <em>double detect_coeff</em><span class="sig-paren">)</span><a class="headerlink" href="#orb.cutils.check_cosmic_rays_neighbourhood" title="Permalink to this definition">¶</a></dt>
<dd><p>Check the neighbourhood around detected cosmic rays in a frame.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first last simple">
<li><strong>frame</strong> – Frame to check</li>
<li><strong>cr_map</strong> – Map of the cosimic-rays positions (boolean map, 1
is a cosmic ray)</li>
<li><strong>box_size</strong> – Size of the box checked around each cr.</li>
<li><strong>detect_coeff</strong> – Coefficient of detection (number of sigmas
threshold)</li>
</ul>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="function">
<dt id="orb.cutils.complex_dft">
<code class="descclassname">orb.cutils.</code><code class="descname">complex_dft</code><span class="sig-paren">(</span><em>ndarray a</em>, <em>ndarray x</em><span class="sig-paren">)</span><a class="headerlink" href="#orb.cutils.complex_dft" title="Permalink to this definition">¶</a></dt>
<dd><p>Discret Fourier Transform.</p>
<p>Compute an irregularly sampled spectrum from a complex regularly
sampled interferogram.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first last simple">
<li><strong>a</strong> – complex regularly sampled interferogram.</li>
<li><strong>x</strong> – positions of the spectrum samples. If x =
range(size(a)), this function is equivalent to an fft. Note that
the fft is of course much faster to compute. This vector may
have any length.</li>
</ul>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="function">
<dt id="orb.cutils.create_transform_maps">
<code class="descclassname">orb.cutils.</code><code class="descname">create_transform_maps</code><span class="sig-paren">(</span><em>int nx</em>, <em>int ny</em>, <em>double dx</em>, <em>double dy</em>, <em>double dr</em>, <em>double da</em>, <em>double db</em>, <em>double xrc</em>, <em>double yrc</em>, <em>double zx</em>, <em>double zy</em>, <em>sip_A</em>, <em>sip_B</em><span class="sig-paren">)</span><a class="headerlink" href="#orb.cutils.create_transform_maps" title="Permalink to this definition">¶</a></dt>
<dd><p>Create the 2 transformation maps used to compute the
geometrical transformation.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first last simple">
<li><strong>nx</strong> – size of the frame along x axis</li>
<li><strong>ny</strong> – size of the frame along y axis</li>
<li><strong>dx</strong> – translation along x</li>
<li><strong>dy</strong> – translation along y</li>
<li><strong>dr</strong> – rotation in the plane of the image</li>
<li><strong>da</strong> – tip angle</li>
<li><strong>db</strong> – tilt angle</li>
<li><strong>xrc</strong> – x coordinate of the rotation center</li>
<li><strong>yrc</strong> – y coordinate of the rotation center</li>
<li><strong>zx</strong> – zoom coefficient along x</li>
<li><strong>zy</strong> – zoom coefficient along y</li>
<li><strong>sip_A</strong> – pywcs.WCS() instance containing SIP parameters of
the output image.</li>
<li><strong>sip_B</strong> – pywcs.WCS() instance containing SIP parameters of
the input image.</li>
</ul>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="function">
<dt id="orb.cutils.detect_cosmic_rays">
<code class="descclassname">orb.cutils.</code><code class="descname">detect_cosmic_rays</code><span class="sig-paren">(</span><em>ndarray frame</em>, <em>crs_list</em>, <em>int box_size</em>, <em>double detect_coeff</em><span class="sig-paren">)</span><a class="headerlink" href="#orb.cutils.detect_cosmic_rays" title="Permalink to this definition">¶</a></dt>
<dd><p>Check if a given pixel is a cosmic ray (classic detection).</p>
<p>classic detection: pixel value is checked against standard
deviation of values in a box around the pixel.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first last simple">
<li><strong>frame</strong> – Frame to check</li>
<li><strong>crs_list</strong> – List of pixels to check</li>
<li><strong>box_size</strong> – Size of the box in pixels</li>
<li><strong>detect_coeff</strong> – Coefficient of detection (number of sigmas
threshold)</li>
</ul>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="function">
<dt id="orb.cutils.dft">
<code class="descclassname">orb.cutils.</code><code class="descname">dft</code><span class="sig-paren">(</span><em>ndarray a</em>, <em>ndarray x</em><span class="sig-paren">)</span><a class="headerlink" href="#orb.cutils.dft" title="Permalink to this definition">¶</a></dt>
<dd><p>Discret Fourier Transform.</p>
<p>Compute an irregularly sampled spectrum from a regularly
sampled interferogram.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first last simple">
<li><strong>a</strong> – regularly sampled interferogram.</li>
<li><strong>x</strong> – positions of the spectrum samples. If x =
range(size(a)), this function is equivalent to an fft. Note that
the fft is of course much faster to compute. This vector may
have any length.</li>
</ul>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="function">
<dt id="orb.cutils.fast_gaussian_kernel">
<code class="descclassname">orb.cutils.</code><code class="descname">fast_gaussian_kernel</code><span class="sig-paren">(</span><em>int deg</em><span class="sig-paren">)</span><a class="headerlink" href="#orb.cutils.fast_gaussian_kernel" title="Permalink to this definition">¶</a></dt>
<dd><p>Return a fast gaussian kernel.</p>
<p>The value of each pixel is just the value of the gaussian at the
center of the pixel.</p>
<p>The degree gives the size of the kernel’s side : size = 2 * deg + 1</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><strong>deg</strong> – The degree of the kernel. Must be an integer &gt;= 0.</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="function">
<dt id="orb.cutils.fast_pix2w">
<code class="descclassname">orb.cutils.</code><code class="descname">fast_pix2w</code><span class="sig-paren">(</span><em>ndarray pix</em>, <em>double axis_min</em>, <em>double axis_step</em><span class="sig-paren">)</span><a class="headerlink" href="#orb.cutils.fast_pix2w" title="Permalink to this definition">¶</a></dt>
<dd><p>Fast conversion of pixel to wavelength/wavenumber</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first last simple">
<li><strong>pix</strong> – position along axis in pixels</li>
<li><strong>axis_min</strong> – min axis wavelength/wavenumber</li>
<li><strong>axis_step</strong> – axis step size in wavelength/wavenumber</li>
</ul>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="function">
<dt id="orb.cutils.fast_w2pix">
<code class="descclassname">orb.cutils.</code><code class="descname">fast_w2pix</code><span class="sig-paren">(</span><em>ndarray w</em>, <em>double axis_min</em>, <em>double axis_step</em><span class="sig-paren">)</span><a class="headerlink" href="#orb.cutils.fast_w2pix" title="Permalink to this definition">¶</a></dt>
<dd><p>Fast conversion of wavelength/wavenumber to pixel</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first last simple">
<li><strong>w</strong> – wavelength/wavenumber</li>
<li><strong>axis_min</strong> – min axis wavelength/wavenumber</li>
<li><strong>axis_step</strong> – axis step size in wavelength/wavenumber</li>
</ul>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="function">
<dt id="orb.cutils.fft_filter">
<code class="descclassname">orb.cutils.</code><code class="descname">fft_filter</code><span class="sig-paren">(</span><em>ndarray a</em>, <em>double cutoff</em>, <em>double width</em>, <em>bool lowpass</em><span class="sig-paren">)</span><a class="headerlink" href="#orb.cutils.fft_filter" title="Permalink to this definition">¶</a></dt>
<dd><p>Simple lowpass or highpass FFT filter (high pass or low pass)</p>
<p>Filter shape is a gaussian.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first last simple">
<li><strong>a</strong> – a 1D float64 vector</li>
<li><strong>cutoff_coeff</strong> – Coefficient defining the position of the cutoff
frequency (Cutoff frequency = cutoff_coeff * vector length)</li>
<li><strong>width_coeff</strong> – Coefficient defining the width of
the smoothed part of the filter (width = width_coeff * vector
length)</li>
<li><strong>lowpass</strong> – If True filter will be ‘low_pass’ and ‘high_pass’
if False.</li>
</ul>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="function">
<dt id="orb.cutils.filter_background">
<code class="descclassname">orb.cutils.</code><code class="descname">filter_background</code><span class="sig-paren">(</span><em>ndarray frame</em>, <em>int box_size</em>, <em>int big_box_coeff</em><span class="sig-paren">)</span><a class="headerlink" href="#orb.cutils.filter_background" title="Permalink to this definition">¶</a></dt>
<dd><p>Replace each pixel by the value in a box around it minus the
median of the baclground.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first last simple">
<li><strong>frame</strong> – Frame to filter</li>
<li><strong>box_size</strong> – Size of the box</li>
<li><strong>big_box_coeff</strong> – Coeff by which the bo size is multiplied to
get the background box size.</li>
</ul>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="function">
<dt id="orb.cutils.gaussian1d">
<code class="descclassname">orb.cutils.</code><code class="descname">gaussian1d</code><span class="sig-paren">(</span><em>ndarray x</em>, <em>double h</em>, <em>double a</em>, <em>double dx</em>, <em>double fwhm</em><span class="sig-paren">)</span><a class="headerlink" href="#orb.cutils.gaussian1d" title="Permalink to this definition">¶</a></dt>
<dd><p>Return a 1D gaussian given a set of parameters.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first last simple">
<li><strong>x</strong> – 1D array of float64 giving the positions where the
gaussian is evaluated</li>
<li><strong>h</strong> – Height</li>
<li><strong>a</strong> – Amplitude</li>
<li><strong>dx</strong> – Position of the center</li>
<li><strong>w</strong> – FWHM, <span class="math">\text{FWHM} = \text{Width} \times 2 \sqrt{2 \ln 2}</span></li>
</ul>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="function">
<dt id="orb.cutils.gaussian_array2d">
<code class="descclassname">orb.cutils.</code><code class="descname">gaussian_array2d</code><span class="sig-paren">(</span><em>double h</em>, <em>double a</em>, <em>double dx</em>, <em>double dy</em>, <em>double fwhm</em>, <em>int nx</em>, <em>int ny</em><span class="sig-paren">)</span><a class="headerlink" href="#orb.cutils.gaussian_array2d" title="Permalink to this definition">¶</a></dt>
<dd><p>Return the 2D profile of a gaussian</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first last simple">
<li><strong>h</strong> – Height</li>
<li><strong>a</strong> – Amplitude</li>
<li><strong>dx</strong> – X position</li>
<li><strong>dy</strong> – Y position</li>
<li><strong>fwhm</strong> – FWHM</li>
<li><strong>nx</strong> – X dimension of the output array</li>
<li><strong>ny</strong> – Y dimension of the output array</li>
</ul>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="function">
<dt id="orb.cutils.gaussian_kernel">
<code class="descclassname">orb.cutils.</code><code class="descname">gaussian_kernel</code><span class="sig-paren">(</span><em>double deg</em><span class="sig-paren">)</span><a class="headerlink" href="#orb.cutils.gaussian_kernel" title="Permalink to this definition">¶</a></dt>
<dd><p>Return a gaussian kernel.</p>
<p>The value of each pixel is the integral of the gaussian over the
whole pixel because the shape of the gaussian is not linear at
all. The estimation is done by subdividing each pixel in 9
sub-pixels.</p>
<p>The degree gives the size of the kernel’s side : size = 2 * deg + 1</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><strong>deg</strong> – The degree of the kernel. Must be an integer &gt;= 0.</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="function">
<dt id="orb.cutils.get_box_coords">
<code class="descclassname">orb.cutils.</code><code class="descname">get_box_coords</code><span class="sig-paren">(</span><em>int ix</em>, <em>int iy</em>, <em>int box_size</em>, <em>int x_lim_min</em>, <em>int x_lim_max</em>, <em>int y_lim_min</em>, <em>int y_lim_max</em><span class="sig-paren">)</span><a class="headerlink" href="#orb.cutils.get_box_coords" title="Permalink to this definition">¶</a></dt>
<dd><p>Return the coordinates of a box given the center of the box,
its size and the limits of the range along x and y axes.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first simple">
<li><strong>ix</strong> – center of the box along x axis</li>
<li><strong>iy</strong> – center of the box along y axis</li>
<li><strong>box_size</strong> – Size of the box. The final size of the box will
generally be the same if box_size is odd. Note that the final
size of the box cannot be guaranteed.</li>
<li><strong>x_lim_min</strong> – Minimum limit of the range along x.</li>
<li><strong>x_lim_max</strong> – Maximum limit of the range along x.</li>
<li><strong>y_lim_min</strong> – Minimum limit of the range along y.</li>
<li><strong>y_lim_max</strong> – Maximum limit of the range along y.</li>
</ul>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><p class="first last">x_min, x_max, y_min, y_max</p>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="function">
<dt id="orb.cutils.get_cm1_axis_max">
<code class="descclassname">orb.cutils.</code><code class="descname">get_cm1_axis_max</code><span class="sig-paren">(</span><em>int n</em>, <em>double step</em>, <em>int order</em>, <em>double corr=1.</em><span class="sig-paren">)</span><a class="headerlink" href="#orb.cutils.get_cm1_axis_max" title="Permalink to this definition">¶</a></dt>
<dd><p>Return max wavenumber of a regular wavenumber axis in cm-1.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first last simple">
<li><strong>n</strong> – Number of steps on the axis</li>
<li><strong>step</strong> – Step size in nm</li>
<li><strong>order</strong> – Folding order</li>
<li><strong>corr</strong> – (Optional) Coefficient of correction (default 1.)</li>
</ul>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="function">
<dt id="orb.cutils.get_cm1_axis_min">
<code class="descclassname">orb.cutils.</code><code class="descname">get_cm1_axis_min</code><span class="sig-paren">(</span><em>int n</em>, <em>double step</em>, <em>int order</em>, <em>double corr=1.</em><span class="sig-paren">)</span><a class="headerlink" href="#orb.cutils.get_cm1_axis_min" title="Permalink to this definition">¶</a></dt>
<dd><p>Return min wavenumber of a regular wavenumber axis in cm-1.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first last simple">
<li><strong>n</strong> – Number of steps on the axis</li>
<li><strong>step</strong> – Step size in nm</li>
<li><strong>order</strong> – Folding order</li>
<li><strong>corr</strong> – (Optional) Coefficient of correction (default 1.)</li>
</ul>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="function">
<dt id="orb.cutils.get_cm1_axis_step">
<code class="descclassname">orb.cutils.</code><code class="descname">get_cm1_axis_step</code><span class="sig-paren">(</span><em>int n</em>, <em>double step</em>, <em>double corr=1.</em><span class="sig-paren">)</span><a class="headerlink" href="#orb.cutils.get_cm1_axis_step" title="Permalink to this definition">¶</a></dt>
<dd><p>Return step size of a regular wavenumber axis in cm-1.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first last simple">
<li><strong>n</strong> – Number of steps on the axis</li>
<li><strong>step</strong> – Step size in nm</li>
<li><strong>corr</strong> – (Optional) Coefficient of correction (default 1.)</li>
</ul>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="function">
<dt id="orb.cutils.get_nm_axis_max">
<code class="descclassname">orb.cutils.</code><code class="descname">get_nm_axis_max</code><span class="sig-paren">(</span><em>int n</em>, <em>double step</em>, <em>int order</em>, <em>double corr=1.</em><span class="sig-paren">)</span><a class="headerlink" href="#orb.cutils.get_nm_axis_max" title="Permalink to this definition">¶</a></dt>
<dd><p>Return max wavelength of regular wavelength axis in nm.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first last simple">
<li><strong>n</strong> – Number of steps on the axis</li>
<li><strong>step</strong> – Step size in nm</li>
<li><strong>order</strong> – Folding order (cannot be 0)</li>
<li><strong>corr</strong> – (Optional) Coefficient of correction (default 1.)</li>
</ul>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="function">
<dt id="orb.cutils.get_nm_axis_min">
<code class="descclassname">orb.cutils.</code><code class="descname">get_nm_axis_min</code><span class="sig-paren">(</span><em>int n</em>, <em>double step</em>, <em>int order</em>, <em>double corr=1.</em><span class="sig-paren">)</span><a class="headerlink" href="#orb.cutils.get_nm_axis_min" title="Permalink to this definition">¶</a></dt>
<dd><p>Return min wavelength of regular wavelength axis in nm.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first last simple">
<li><strong>n</strong> – Number of steps on the axis</li>
<li><strong>step</strong> – Step size in nm</li>
<li><strong>order</strong> – Folding order (cannot be 0)</li>
<li><strong>corr</strong> – (Optional) Coefficient of correction (default 1.)</li>
</ul>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="function">
<dt id="orb.cutils.get_nm_axis_step">
<code class="descclassname">orb.cutils.</code><code class="descname">get_nm_axis_step</code><span class="sig-paren">(</span><em>int n</em>, <em>double step</em>, <em>int order</em>, <em>double corr=1.</em><span class="sig-paren">)</span><a class="headerlink" href="#orb.cutils.get_nm_axis_step" title="Permalink to this definition">¶</a></dt>
<dd><p>Return step size of a regular wavelength axis in nm.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first last simple">
<li><strong>n</strong> – Number of steps on the axis</li>
<li><strong>step</strong> – Step size in nm</li>
<li><strong>order</strong> – Folding order (cannot be 0)</li>
<li><strong>corr</strong> – (Optional) Coefficient of correction (default 1.)</li>
</ul>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="function">
<dt id="orb.cutils.im2rgba">
<code class="descclassname">orb.cutils.</code><code class="descname">im2rgba</code><span class="sig-paren">(</span><em>ndarray im</em>, <em>mpl_colorbar</em>, <em>double vmin</em>, <em>double vmax</em>, <em>int xmin</em>, <em>int xmax</em>, <em>int ymin</em>, <em>int ymax</em>, <em>ndarray computed_pixels</em>, <em>last_arr8</em>, <em>int res=1000</em><span class="sig-paren">)</span><a class="headerlink" href="#orb.cutils.im2rgba" title="Permalink to this definition">¶</a></dt>
<dd><p>Compute RGBA from image given a matplotlib colorbar instance.</p>
<p>This is a function used by <code class="xref py py-class docutils literal notranslate"><span class="pre">orb.visual.ImageCanvas</span></code>. It
is not a generalist function. It has been written to accelerate
matplotlib function colorbar.to_rgba().</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first last simple">
<li><strong>im</strong> – Image</li>
<li><strong>mpl_colorbar</strong> – A matplotlib colorbar instance</li>
<li><strong>vmin</strong> – min value of the colorbar</li>
<li><strong>vmax</strong> – max value of the colorbar</li>
<li><strong>xmin</strong> – min x index of the region to compute</li>
<li><strong>xmax</strong> – max x index of the region to compute</li>
<li><strong>ymin</strong> – min y index of the region to compute</li>
<li><strong>ymax</strong> – max y index of the region to compute</li>
<li><strong>computed_pixels</strong> – Array giving the already computed pixels</li>
<li><strong>last_arr8</strong> – If not None, last computed array.</li>
<li><strong>res</strong> – (Optional) Lookup table resolution (default 1000)</li>
</ul>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="function">
<dt id="orb.cutils.indft">
<code class="descclassname">orb.cutils.</code><code class="descname">indft</code><span class="sig-paren">(</span><em>ndarray a</em>, <em>ndarray x</em><span class="sig-paren">)</span><a class="headerlink" href="#orb.cutils.indft" title="Permalink to this definition">¶</a></dt>
<dd><p>Inverse Non-uniform Discret Fourier Transform.</p>
<p>Compute the irregularly sampled interferogram from a regularly
sampled spectrum.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first last simple">
<li><strong>a</strong> – regularly sampled spectrum.</li>
<li><strong>x</strong> – positions of the interferogram samples. If x =
range(size(a)), this function is equivalent to an idft or a
ifft. Note that the ifft is of course much faster to
compute. This vector may have any length.</li>
</ul>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="function">
<dt id="orb.cutils.interf_mean_energy">
<code class="descclassname">orb.cutils.</code><code class="descname">interf_mean_energy</code><span class="sig-paren">(</span><em>ndarray interf</em><span class="sig-paren">)</span><a class="headerlink" href="#orb.cutils.interf_mean_energy" title="Permalink to this definition">¶</a></dt>
<dd><p>Return the mean energy of an interferogram by step.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><strong>interf</strong> – an interferogram</td>
</tr>
</tbody>
</table>
<div class="admonition warning">
<p class="first admonition-title">Warning</p>
<p class="last">The mean of the interferogram is substracted to
compute only the modulation energy. This is the modulation
energy which must be conserved in the resulting spectrum. Note
that the interferogram transformation function (see
<code class="xref py py-meth docutils literal notranslate"><span class="pre">utils.transform_interferogram()</span></code>) remove the mean of the
interferogram before computing its FFT.</p>
</div>
<div class="admonition note">
<p class="first admonition-title">Note</p>
<p class="last">NaNs are counted as zeros.</p>
</div>
</dd></dl>

<dl class="function">
<dt id="orb.cutils.low_pass_image_filter">
<code class="descclassname">orb.cutils.</code><code class="descname">low_pass_image_filter</code><span class="sig-paren">(</span><em>ndarray im</em>, <em>int deg</em><span class="sig-paren">)</span><a class="headerlink" href="#orb.cutils.low_pass_image_filter" title="Permalink to this definition">¶</a></dt>
<dd><p>Low pass image filter by convolution with a gaussian kernel.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first last simple">
<li><strong>im</strong> – Image to filter</li>
<li><strong>deg</strong> – Kernel degree</li>
</ul>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="function">
<dt id="orb.cutils.map_me">
<code class="descclassname">orb.cutils.</code><code class="descname">map_me</code><span class="sig-paren">(</span><em>ndarray frame</em><span class="sig-paren">)</span><a class="headerlink" href="#orb.cutils.map_me" title="Permalink to this definition">¶</a></dt>
<dd><p>Create a map of the modulation efficiency from a laser frame.</p>
<p>The more fringes the best are the results.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><strong>frame</strong> – laser frame.</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="function">
<dt id="orb.cutils.master_combine">
<code class="descclassname">orb.cutils.</code><code class="descname">master_combine</code><span class="sig-paren">(</span><em>ndarray frames</em>, <em>double sigma</em>, <em>int nkeep</em>, <em>int combine_mode</em>, <em>int reject_mode</em>, <em>return_std_frame=False</em><span class="sig-paren">)</span><a class="headerlink" href="#orb.cutils.master_combine" title="Permalink to this definition">¶</a></dt>
<dd><p>Create a master frame from a set a frames.</p>
<p>This method has been inspired by the <strong>IRAF</strong> function
combine.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first last simple">
<li><strong>frames</strong> – Frames to be combined.</li>
<li><strong>sigma</strong> – Sigma factor for pixel rejection.</li>
<li><strong>nkeep</strong> – Minimum number of values to keep before
combining operation</li>
<li><strong>combine_mode</strong> – 0, mean ; 1, median.</li>
<li><strong>reject_mode</strong> – 0, avsigclip ; 1, sigclip ; 2, minmax.</li>
<li><strong>return_std</strong> – If True, the std frame is also returned
(default False).</li>
</ul>
</td>
</tr>
</tbody>
</table>
<div class="admonition note">
<p class="first admonition-title">Note</p>
<p>Rejection operations:</p>
<ul class="last simple">
<li><strong>sigclip</strong>: A Sigma Clipping algorithm is applied for
each pixel. Min and max values are rejected to estimate
the mean and the standard deviation at each pixel. Then
all values over (median + sigma * std) or below (median -
sigma * std) are rejected. Those steps are repeated (this
time not excluding the extreme values) while no other
value is rejected or the minimum number of values to keep
is reached. Work best with at least 10 frames.</li>
<li><strong>avsigclip</strong>: Average Sigma Clipping algorithm is the
same as Sigma Clipping algorithm but the standard
deviation at each pixel is estimated using an averaged
value of the std over the lines. This work best than sigma
clipping for a small number of frames. This algorithm is a
little more time consuming than the others. Works best with
at least 5 frames.</li>
<li><strong>minmax</strong>: Minimum and maximum values at each pixel are
rejected.</li>
</ul>
</div>
<div class="admonition warning">
<p class="first admonition-title">Warning</p>
<p class="last">No rejection operation can be performed with less
than 3 frames.</p>
</div>
</dd></dl>

<dl class="function">
<dt id="orb.cutils.mean2d">
<code class="descclassname">orb.cutils.</code><code class="descname">mean2d</code><span class="sig-paren">(</span><em>ndarray box</em><span class="sig-paren">)</span><a class="headerlink" href="#orb.cutils.mean2d" title="Permalink to this definition">¶</a></dt>
<dd><p>Return the mean of a 2d box with no GIL</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><strong>box</strong> – 2d array</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="function">
<dt id="orb.cutils.meansigcut2d">
<code class="descclassname">orb.cutils.</code><code class="descname">meansigcut2d</code><span class="sig-paren">(</span><em>ndarray x</em>, <em>double sigma=3</em>, <em>int min_values=3</em>, <em>int axis=0</em><span class="sig-paren">)</span><a class="headerlink" href="#orb.cutils.meansigcut2d" title="Permalink to this definition">¶</a></dt>
<dd><p>Return the sigma cut mean of a 2d array along a given axis.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first last simple">
<li><strong>x</strong> – The 2d array</li>
<li><strong>sigma</strong> – Number of sigma above which values are considered as
deviant</li>
<li><strong>min_values</strong> – Minimum number of values to return</li>
<li><strong>axis</strong> – Axis number. Must be 0 or 1.</li>
</ul>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="function">
<dt id="orb.cutils.median2d">
<code class="descclassname">orb.cutils.</code><code class="descname">median2d</code><span class="sig-paren">(</span><em>ndarray box</em><span class="sig-paren">)</span><a class="headerlink" href="#orb.cutils.median2d" title="Permalink to this definition">¶</a></dt>
<dd><p>Return the median of a 2d box with no GIL</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><strong>box</strong> – 2d array</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="function">
<dt id="orb.cutils.moffat_array2d">
<code class="descclassname">orb.cutils.</code><code class="descname">moffat_array2d</code><span class="sig-paren">(</span><em>double h</em>, <em>double a</em>, <em>double dx</em>, <em>double dy</em>, <em>double fwhm</em>, <em>double beta</em>, <em>int nx</em>, <em>int ny</em><span class="sig-paren">)</span><a class="headerlink" href="#orb.cutils.moffat_array2d" title="Permalink to this definition">¶</a></dt>
<dd><p>Return the 2D profile of a moffat</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first last simple">
<li><strong>h</strong> – Height</li>
<li><strong>a</strong> – Amplitude</li>
<li><strong>dx</strong> – X position</li>
<li><strong>dy</strong> – Y position</li>
<li><strong>fwhm</strong> – FWHM</li>
<li><strong>beta</strong> – Beta</li>
<li><strong>nx</strong> – X dimension of the output array</li>
<li><strong>ny</strong> – Y dimension of the output array</li>
</ul>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="function">
<dt id="orb.cutils.multi_fit_stars">
<code class="descclassname">orb.cutils.</code><code class="descname">multi_fit_stars</code><span class="sig-paren">(</span><em>ndarray frame, ndarray pos, int box_size, double height_guess=np.nan, ndarray fwhm_guess=np.array([np.nan], dtype=float), bool cov_height=False, bool cov_pos=True, bool cov_fwhm=True, bool fix_height=False, bool fix_pos=False, bool fix_fwhm=False, double fit_tol=1e-3, double ron=np.nan, double dcl=np.nan, bool enable_zoom=False, bool enable_rotation=False, bool estimate_local_noise=True, double saturation=0, sip=None</em><span class="sig-paren">)</span><a class="headerlink" href="#orb.cutils.multi_fit_stars" title="Permalink to this definition">¶</a></dt>
<dd><p>Fit multiple stars at the same time.</p>
<p>Useful if the relative positions of the stars are well known. In
this case the pattern of position can be shifted, zoomed and
rotated in order to be adjusted to the stars in the frame.</p>
<p>Other covarying parameters can be the height and the FWHM.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first last simple">
<li><strong>frame</strong> – Frame</li>
<li><strong>pos</strong> – array of stars positions of shape [[x1, y1], [x2, y2] …]</li>
<li><strong>box_size</strong> – Size of the box around a single star</li>
<li><strong>height_guess</strong> – (Optional) Initial guess on the height
parameter (default NaN).</li>
<li><strong>fwhm_guess</strong> – (Optional) Initial guess on the FWHM parameter
must a numpy.ndarray.</li>
<li><strong>cov_height</strong> – (Optional) If True, height is considered to be
the same for all the stars. It is then a covarying parameter
(default False).</li>
<li><strong>cov_pos</strong> – (Optional) If True, shift along x and y is
considered as the same for all the stars. dx and dy are thus 2
covarying parameters (default True).</li>
<li><strong>cov_fwhm</strong> – (Optional) If True, FWHM is considered to be the
same for all the stars. It is then a covarying parameter
(default True).</li>
<li><strong>fix_height</strong> – (Optional) If True, height is fixed to its
guess (default False).</li>
<li><strong>fix_pos</strong> – (Optional) If True, x and y are fixed to the position
guess given by pos (default False).</li>
<li><strong>fix_fwhm</strong> – (Optional) If True, FWHM is fixed to its guess
(default False).</li>
<li><strong>fit_tol</strong> – (Optional) Tolerance on the fit (default 1e-3).</li>
<li><strong>ron</strong> – (Optional) Readout noise. If given and if
estimate_local_noise is set to False the readout noise is fixed
to the given value. If not given the ron is guessed from the
background around the stars (default NaN).</li>
<li><strong>dcl</strong> – (Optional) Dark current level. If given and if
estimate_local_noise is set to False the dark current level is
fixed to the given value. If not given the dark current level is
fixed to 0. (default NaN)</li>
<li><strong>enable_zoom</strong> – (Optional) If True the position pattern can be
zoomed (default False).</li>
<li><strong>enable_rotation</strong> – (Optional) If True the position pattern
can be rotated (default False).</li>
<li><strong>estimate_local_noise</strong> – (Optional) If True, the level of
noise is computed from the background pixels around the
stars. ron and dcl parameters are thus not used (default True).</li>
<li><strong>saturation</strong> – (Optional) If not 0, all pixels above the
saturation level are removed from the fit (default 0).</li>
<li><strong>sip</strong> – (Optional) A pywcs.WCS instance containing SIP
distorsion correction (default None).</li>
</ul>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="function">
<dt id="orb.cutils.nanbin_image">
<code class="descclassname">orb.cutils.</code><code class="descname">nanbin_image</code><span class="sig-paren">(</span><em>ndarray im</em>, <em>int binning</em><span class="sig-paren">)</span><a class="headerlink" href="#orb.cutils.nanbin_image" title="Permalink to this definition">¶</a></dt>
<dd><p>Mean image binning robust to NaNs.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first last simple">
<li><strong>im</strong> – Image to bin</li>
<li><strong>binning</strong> – Binning factor (must be an integer)</li>
</ul>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="function">
<dt id="orb.cutils.part_value">
<code class="descclassname">orb.cutils.</code><code class="descname">part_value</code><span class="sig-paren">(</span><em>ndarray distrib</em>, <em>double coeff</em><span class="sig-paren">)</span><a class="headerlink" href="#orb.cutils.part_value" title="Permalink to this definition">¶</a></dt>
<dd><p>Return the value lying between two parts of a partition</p>
<p>The partition process is nan robusts. It is made over a
distribution cleaned from nans.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first last simple">
<li><strong>distrib</strong> – A 1D array of floats.</li>
<li><strong>coeff</strong> – Partition coefficient (must be &gt;= 0. and &lt;= 1.). If
0 return the min of the distribution and if 1 return the max.</li>
</ul>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="function">
<dt id="orb.cutils.point_inside_polygon">
<code class="descclassname">orb.cutils.</code><code class="descname">point_inside_polygon</code><span class="sig-paren">(</span><em>double x</em>, <em>double y</em>, <em>list poly</em><span class="sig-paren">)</span><a class="headerlink" href="#orb.cutils.point_inside_polygon" title="Permalink to this definition">¶</a></dt>
<dd><p>Determine if a point is inside a given polygon or not
Polygon is a list of (x,y) pairs.</p>
<p>This function has been taken from
<a class="reference external" href="http://www.ariel.com.au/a/python-point-int-poly.html">http://www.ariel.com.au/a/python-point-int-poly.html</a> and cythonized.</p>
</dd></dl>

<dl class="function">
<dt id="orb.cutils.radians">
<code class="descclassname">orb.cutils.</code><code class="descname">radians</code><span class="sig-paren">(</span><em>double deg</em><span class="sig-paren">)</span><a class="headerlink" href="#orb.cutils.radians" title="Permalink to this definition">¶</a></dt>
<dd><p>Convert degrees to radians</p>
</dd></dl>

<dl class="function">
<dt id="orb.cutils.robust_average">
<code class="descclassname">orb.cutils.</code><code class="descname">robust_average</code><span class="sig-paren">(</span><em>ndarray x</em>, <em>ndarray w</em><span class="sig-paren">)</span><a class="headerlink" href="#orb.cutils.robust_average" title="Permalink to this definition">¶</a></dt>
<dd><p>Compute robust average of a numpy ndarray (NaNs are skipped)</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first last simple">
<li><strong>x</strong> – a numpy ndarray</li>
<li><strong>w</strong> – a numpy ndarray of weigths</li>
</ul>
</td>
</tr>
</tbody>
</table>
<div class="admonition note">
<p class="first admonition-title">Note</p>
<p class="last">To get a weighted average the MEAN of the weights must
be equal to 1.</p>
</div>
</dd></dl>

<dl class="function">
<dt id="orb.cutils.robust_mean">
<code class="descclassname">orb.cutils.</code><code class="descname">robust_mean</code><span class="sig-paren">(</span><em>ndarray x</em><span class="sig-paren">)</span><a class="headerlink" href="#orb.cutils.robust_mean" title="Permalink to this definition">¶</a></dt>
<dd><p>Compute robust mean of a numpy ndarray (NaNs are skipped)</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><strong>x</strong> – a numpy ndarray</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="function">
<dt id="orb.cutils.robust_median">
<code class="descclassname">orb.cutils.</code><code class="descname">robust_median</code><span class="sig-paren">(</span><em>ndarray x</em><span class="sig-paren">)</span><a class="headerlink" href="#orb.cutils.robust_median" title="Permalink to this definition">¶</a></dt>
<dd><p>Compute robust median of a numpy ndarray (NaNs are skipped)</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><strong>x</strong> – a numpy ndarray</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="function">
<dt id="orb.cutils.robust_std">
<code class="descclassname">orb.cutils.</code><code class="descname">robust_std</code><span class="sig-paren">(</span><em>ndarray x</em><span class="sig-paren">)</span><a class="headerlink" href="#orb.cutils.robust_std" title="Permalink to this definition">¶</a></dt>
<dd><p>Compute robust std of a numpy ndarray (NaNs are skipped)</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><strong>x</strong> – a numpy ndarray</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="function">
<dt id="orb.cutils.robust_sum">
<code class="descclassname">orb.cutils.</code><code class="descname">robust_sum</code><span class="sig-paren">(</span><em>ndarray x</em><span class="sig-paren">)</span><a class="headerlink" href="#orb.cutils.robust_sum" title="Permalink to this definition">¶</a></dt>
<dd><p>Compute robust sum of a numpy ndarray (NaNs are skipped)</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><strong>x</strong> – a numpy ndarray</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="function">
<dt id="orb.cutils.sigmaclip">
<code class="descclassname">orb.cutils.</code><code class="descname">sigmaclip</code><span class="sig-paren">(</span><em>ndarray x</em>, <em>double sigma</em>, <em>int min_values</em><span class="sig-paren">)</span><a class="headerlink" href="#orb.cutils.sigmaclip" title="Permalink to this definition">¶</a></dt>
<dd><p>Return a distribution after a sigma clipping rejection
of the too deviant values.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first last simple">
<li><strong>x</strong> – The distribution to sigmaclip</li>
<li><strong>sigma</strong> – Number of sigma above which values are considered as
deviant</li>
<li><strong>min_values</strong> – Minimum number of values to return</li>
</ul>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="function">
<dt id="orb.cutils.sigmacut">
<code class="descclassname">orb.cutils.</code><code class="descname">sigmacut</code><span class="sig-paren">(</span><em>ndarray x</em>, <em>double central_value</em>, <em>int use_central_value</em>, <em>double sigma</em>, <em>int min_values</em>, <em>return_index_list=False</em><span class="sig-paren">)</span><a class="headerlink" href="#orb.cutils.sigmacut" title="Permalink to this definition">¶</a></dt>
<dd><p>Return a distribution after a sigma cut rejection
of the too deviant values.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first last simple">
<li><strong>x</strong> – The distribution to cut</li>
<li><strong>sigma</strong> – Number of sigma above which values are considered as
deviant</li>
<li><strong>min_values</strong> – Minimum number of values to return</li>
<li><strong>central_value</strong> – If not none, this value is used as the
central value of the cut. Else the median of the distribution is
used as the central value</li>
<li><strong>use_central_value</strong> – If True central value is used instead of
the median.</li>
<li><strong>return_index_list</strong> – (Optional) If True the list of the non
rejected values is returned also (default False).</li>
</ul>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="function">
<dt id="orb.cutils.sinc1d">
<code class="descclassname">orb.cutils.</code><code class="descname">sinc1d</code><span class="sig-paren">(</span><em>ndarray x</em>, <em>double h</em>, <em>double a</em>, <em>double dx</em>, <em>double fwhm</em><span class="sig-paren">)</span><a class="headerlink" href="#orb.cutils.sinc1d" title="Permalink to this definition">¶</a></dt>
<dd><p>Return a 1D sinc given a set of parameters.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first last simple">
<li><strong>x</strong> – 1D array of float64 giving the positions where the
sinc is evaluated</li>
<li><strong>h</strong> – Height</li>
<li><strong>a</strong> – Amplitude</li>
<li><strong>dx</strong> – Position of the center</li>
<li><strong>w</strong> – FWHM, <span class="math">\text{FWHM} = \text{Width} \times 2 \sqrt{2 \ln 2}</span></li>
</ul>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="function">
<dt id="orb.cutils.sip_im2pix">
<code class="descclassname">orb.cutils.</code><code class="descname">sip_im2pix</code><span class="sig-paren">(</span><em>ndarray im_coords</em>, <em>sip</em>, <em>tolerance=1e-8</em><span class="sig-paren">)</span><a class="headerlink" href="#orb.cutils.sip_im2pix" title="Permalink to this definition">¶</a></dt>
<dd><p>Transform perfect pixel positions to distorded pixels positions</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first last simple">
<li><strong>im_coords</strong> – perfect pixel positions as an Nx2 array of floats.</li>
<li><strong>sip</strong> – pywcs.WCS() instance containing SIP parameters.</li>
<li><strong>tolerance</strong> – tolerance on the iterative method.</li>
</ul>
</td>
</tr>
</tbody>
</table>
<div class="admonition warning">
<p class="first admonition-title">Warning</p>
<p class="last">SIP.foc2pix must be used instead</p>
</div>
</dd></dl>

<dl class="function">
<dt id="orb.cutils.sip_pix2im">
<code class="descclassname">orb.cutils.</code><code class="descname">sip_pix2im</code><span class="sig-paren">(</span><em>ndarray pix_coords</em>, <em>sip</em><span class="sig-paren">)</span><a class="headerlink" href="#orb.cutils.sip_pix2im" title="Permalink to this definition">¶</a></dt>
<dd><p>Transform distorded pixel positions to perfect pixels positions</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first last simple">
<li><strong>pix_coords</strong> – distorded pixel positions as an Nx2 array of floats.</li>
<li><strong>sip</strong> – pywcs.WCS() instance containing SIP parameters.</li>
</ul>
</td>
</tr>
</tbody>
</table>
<div class="admonition warning">
<p class="first admonition-title">Warning</p>
<p class="last">SIP.pix2foc must be used instead</p>
</div>
</dd></dl>

<dl class="function">
<dt id="orb.cutils.spectrum_mean_energy">
<code class="descclassname">orb.cutils.</code><code class="descname">spectrum_mean_energy</code><span class="sig-paren">(</span><em>ndarray spectrum</em><span class="sig-paren">)</span><a class="headerlink" href="#orb.cutils.spectrum_mean_energy" title="Permalink to this definition">¶</a></dt>
<dd><p>Return the mean energy of a spectrum by channel.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><strong>spectrum</strong> – a 1D spectrum</td>
</tr>
</tbody>
</table>
<div class="admonition note">
<p class="first admonition-title">Note</p>
<p class="last">NaNs are counted as zeros.</p>
</div>
</dd></dl>

<dl class="function">
<dt id="orb.cutils.surface_value">
<code class="descclassname">orb.cutils.</code><code class="descname">surface_value</code><span class="sig-paren">(</span><em>int dimx</em>, <em>int dimy</em>, <em>double xc</em>, <em>double yc</em>, <em>double rmin</em>, <em>double rmax</em>, <em>long sub_div</em><span class="sig-paren">)</span><a class="headerlink" href="#orb.cutils.surface_value" title="Permalink to this definition">¶</a></dt>
<dd><p>Return an approximation of the surface value of a pixel given
the min and max radius of an annulus in pixels.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first last simple">
<li><strong>dimx</strong> – dimension of the box along x</li>
<li><strong>dimy</strong> – dimension of the box along y</li>
<li><strong>xc</strong> – center of the annulus along x</li>
<li><strong>yc</strong> – center of the annulus along y</li>
<li><strong>rmin</strong> – min radius of the annulus</li>
<li><strong>rmax</strong> – max radius of the annulus</li>
<li><strong>sub_div</strong> – Number of subdivisions to make (the higher,the
better but the longer too)</li>
</ul>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="function">
<dt id="orb.cutils.transform_A_to_B">
<code class="descclassname">orb.cutils.</code><code class="descname">transform_A_to_B</code><span class="sig-paren">(</span><em>double x1</em>, <em>double y1</em>, <em>double dx</em>, <em>double dy</em>, <em>double dr</em>, <em>double da</em>, <em>double db</em>, <em>double xrc</em>, <em>double yrc</em>, <em>double zx</em>, <em>double zy</em>, <em>double x1_err=0.</em>, <em>double y1_err=0.</em>, <em>double dx_err=0.</em>, <em>double dy_err=0.</em>, <em>double dr_err=0.</em>, <em>double zx_err=0.</em>, <em>double zy_err=0.</em>, <em>bool return_err=False</em><span class="sig-paren">)</span><a class="headerlink" href="#orb.cutils.transform_A_to_B" title="Permalink to this definition">¶</a></dt>
<dd><p>Transform star positions in camera A to the same star position
in camera B given the transformation parameters</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first simple">
<li><strong>x1</strong> – x coordinate to transform</li>
<li><strong>y1</strong> – y coordinate to transform</li>
<li><strong>dx</strong> – translation along x</li>
<li><strong>dy</strong> – translation along y</li>
<li><strong>dr</strong> – rotation in the plane of the image</li>
<li><strong>da</strong> – tip angle</li>
<li><strong>db</strong> – tilt angle</li>
<li><strong>xrc</strong> – x coordinate of the rotation center</li>
<li><strong>yrc</strong> – y coordinate of the rotation center</li>
<li><strong>zx</strong> – zoom coefficient along x</li>
<li><strong>zy</strong> – zoom coefficient along y</li>
<li><strong>x1_err</strong> – (Optional) Error on x1 estimate (default 0.)</li>
<li><strong>y1_err</strong> – (Optional) Error on y1 estimate (default 0.)</li>
<li><strong>dx_err</strong> – (Optional) Error on dx estimate (default 0.)</li>
<li><strong>dy_err</strong> – (Optional) Error on dy estimate (default 0.)</li>
<li><strong>dr_err</strong> – (Optional) Error on dr estimate (default 0.)</li>
<li><strong>zx_err</strong> – (Optional) Error on zx estimate (default 0.)</li>
<li><strong>zy_err</strong> – (Optional) Error on zy estimate (default 0.)</li>
<li><strong>return_err</strong> – (Optional) If True, the error on the estimate
of x2 and y2 is returned.</li>
</ul>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><p class="first last">(x2, y2) = f(x1, y1). (x2, y2, x2_err, y2_err) if
return_err is True.</p>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="function">
<dt id="orb.cutils.transform_B_to_A">
<code class="descclassname">orb.cutils.</code><code class="descname">transform_B_to_A</code><span class="sig-paren">(</span><em>double x1</em>, <em>double y1</em>, <em>double dx</em>, <em>double dy</em>, <em>double dr</em>, <em>double da</em>, <em>double db</em>, <em>double xrc</em>, <em>double yrc</em>, <em>double zx</em>, <em>double zy</em><span class="sig-paren">)</span><a class="headerlink" href="#orb.cutils.transform_B_to_A" title="Permalink to this definition">¶</a></dt>
<dd><dl class="docutils">
<dt>Transform star positions in camera B to the same star position</dt>
<dd>in camera A given the transformation parameters.</dd>
</dl>
<div class="admonition warning">
<p class="first admonition-title">Warning</p>
<p class="last">this function is meant to be the inverse of
transform_A_to_B. Given the output of transform_A_to_B and the
<strong>SAME transformation parameters</strong> the initial positions must be
returned by this function within the numerical error. i.e. if
(Xb, Yb) = A_to_B(Xi,Yi,p) and (Xa, Ya) = B_to_A(Xb, Yb, p) then
Xa - Xi ~ 1e-13 and Ya - Yi ~ 1e-13 (for float64 numbers)</p>
</div>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first last simple">
<li><strong>x1</strong> – x coordinate to transform</li>
<li><strong>y1</strong> – y coordinate to transform</li>
<li><strong>dx</strong> – translation along x</li>
<li><strong>dy</strong> – translation along y</li>
<li><strong>dr</strong> – rotation in the plane of the image</li>
<li><strong>da</strong> – tip angle</li>
<li><strong>db</strong> – tilt angle</li>
<li><strong>xrc</strong> – x coordinate of the rotation center</li>
<li><strong>yrc</strong> – y coordinate of the rotation center</li>
<li><strong>zx</strong> – zoom coefficient along x</li>
<li><strong>zy</strong> – zoom coefficient along y</li>
</ul>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="function">
<dt id="orb.cutils.unbin_image">
<code class="descclassname">orb.cutils.</code><code class="descname">unbin_image</code><span class="sig-paren">(</span><em>ndarray im</em>, <em>int nx</em>, <em>int ny</em><span class="sig-paren">)</span><a class="headerlink" href="#orb.cutils.unbin_image" title="Permalink to this definition">¶</a></dt>
<dd><p>Unbin a binned image (restore the image binned with the
function <a class="reference internal" href="#orb.cutils.nanbin_image" title="orb.cutils.nanbin_image"><code class="xref py py-func docutils literal notranslate"><span class="pre">nanbin_image()</span></code></a>).</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first last simple">
<li><strong>im</strong> – Image to unbin.</li>
<li><strong>nx</strong> – X dimension of the unbinned image.</li>
<li><strong>ny</strong> – Y dimension of the unbinned image.</li>
</ul>
</td>
</tr>
</tbody>
</table>
</dd></dl>

</div>
<div class="section" id="module-orb.etc">
<span id="orb-etc-module"></span><h2>orb.etc module<a class="headerlink" href="#module-orb.etc" title="Permalink to this headline">¶</a></h2>
<dl class="class">
<dt id="orb.etc.ETC">
<em class="property">class </em><code class="descclassname">orb.etc.</code><code class="descname">ETC</code><span class="sig-paren">(</span><em>spectrum_phys</em>, <em>step</em>, <em>order</em>, <em>filter_name</em>, <em>add_sky=True</em>, <em>airmass=1</em>, <em>**kwargs</em><span class="sig-paren">)</span><a class="headerlink" href="#orb.etc.ETC" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <a class="reference internal" href="#orb.core.Tools" title="orb.core.Tools"><code class="xref py py-class docutils literal notranslate"><span class="pre">orb.core.Tools</span></code></a></p>
<dl class="method">
<dt id="orb.etc.ETC.convert">
<code class="descname">convert</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#orb.etc.ETC.convert" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="method">
<dt id="orb.etc.ETC.effective_exposition_time">
<code class="descname">effective_exposition_time</code><span class="sig-paren">(</span><em>exposition_time</em>, <em>percent</em>, <em>reverse=False</em><span class="sig-paren">)</span><a class="headerlink" href="#orb.etc.ETC.effective_exposition_time" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="method">
<dt id="orb.etc.ETC.get_exposition_time">
<code class="descname">get_exposition_time</code><span class="sig-paren">(</span><em>target</em>, <em>wavenumber</em><span class="sig-paren">)</span><a class="headerlink" href="#orb.etc.ETC.get_exposition_time" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="method">
<dt id="orb.etc.ETC.get_sky_spectrum">
<code class="descname">get_sky_spectrum</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#orb.etc.ETC.get_sky_spectrum" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="method">
<dt id="orb.etc.ETC.get_snr">
<code class="descname">get_snr</code><span class="sig-paren">(</span><em>exposition_time</em><span class="sig-paren">)</span><a class="headerlink" href="#orb.etc.ETC.get_snr" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="method">
<dt id="orb.etc.ETC.simulate_spectrum">
<code class="descname">simulate_spectrum</code><span class="sig-paren">(</span><em>exposition_time</em>, <em>remove_sky=True</em><span class="sig-paren">)</span><a class="headerlink" href="#orb.etc.ETC.simulate_spectrum" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

</dd></dl>

</div>
<div class="section" id="module-orb.fit">
<span id="orb-fit-module"></span><h2>orb.fit module<a class="headerlink" href="#module-orb.fit" title="Permalink to this headline">¶</a></h2>
<p>Fit module of ORB.</p>
<p>Defines the general Fitting classes and the fitting models.</p>
<p>Best accessed through fit_lines_in_*() functions (defined at the end
of the file)</p>
<dl class="class">
<dt id="orb.fit.Cm1InputParams">
<em class="property">class </em><code class="descclassname">orb.fit.</code><code class="descname">Cm1InputParams</code><span class="sig-paren">(</span><em>step</em>, <em>order</em>, <em>step_nb</em>, <em>nm_laser</em>, <em>theta_proj</em>, <em>theta_orig</em>, <em>apodization</em>, <em>zpd_index</em>, <em>filter_file_path</em><span class="sig-paren">)</span><a class="headerlink" href="#orb.fit.Cm1InputParams" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <a class="reference internal" href="#orb.fit.InputParams" title="orb.fit.InputParams"><code class="xref py py-class docutils literal notranslate"><span class="pre">orb.fit.InputParams</span></code></a></p>
<p>Manage the input parameters for <a class="reference internal" href="#orb.fit.FitVector" title="orb.fit.FitVector"><code class="xref py py-class docutils literal notranslate"><span class="pre">orb.fit.FitVector</span></code></a>
and <a class="reference internal" href="#orb.fit.fit_lines_in_spectrum" title="orb.fit.fit_lines_in_spectrum"><code class="xref py py-meth docutils literal notranslate"><span class="pre">orb.fit.fit_lines_in_spectrum()</span></code></a>.</p>
<dl class="method">
<dt id="orb.fit.Cm1InputParams.add_filter_model">
<code class="descname">add_filter_model</code><span class="sig-paren">(</span><em>**kwargs</em><span class="sig-paren">)</span><a class="headerlink" href="#orb.fit.Cm1InputParams.add_filter_model" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="method">
<dt id="orb.fit.Cm1InputParams.add_lines_model">
<code class="descname">add_lines_model</code><span class="sig-paren">(</span><em>lines</em>, <em>**kwargs</em><span class="sig-paren">)</span><a class="headerlink" href="#orb.fit.Cm1InputParams.add_lines_model" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="method">
<dt id="orb.fit.Cm1InputParams.check_signal_range">
<code class="descname">check_signal_range</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#orb.fit.Cm1InputParams.check_signal_range" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="method">
<dt id="orb.fit.Cm1InputParams.convert">
<code class="descname">convert</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#orb.fit.Cm1InputParams.convert" title="Permalink to this definition">¶</a></dt>
<dd><p>Convert class to a pickable dict object</p>
</dd></dl>

<dl class="method">
<dt id="orb.fit.Cm1InputParams.set_signal_range">
<code class="descname">set_signal_range</code><span class="sig-paren">(</span><em>rmin</em>, <em>rmax</em><span class="sig-paren">)</span><a class="headerlink" href="#orb.fit.Cm1InputParams.set_signal_range" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

</dd></dl>

<dl class="class">
<dt id="orb.fit.Cm1LinesModel">
<em class="property">class </em><code class="descclassname">orb.fit.</code><code class="descname">Cm1LinesModel</code><span class="sig-paren">(</span><em>p_dict</em><span class="sig-paren">)</span><a class="headerlink" href="#orb.fit.Cm1LinesModel" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <a class="reference internal" href="#orb.fit.LinesModel" title="orb.fit.LinesModel"><code class="xref py py-class docutils literal notranslate"><span class="pre">orb.fit.LinesModel</span></code></a></p>
<p>Emission/absorption lines model with a channel unity in cm-1.</p>
<p>Reimplements <code class="xref py py-class docutils literal notranslate"><span class="pre">fit.LinesModel</span></code> to use more physical units
: channels are translated to cm-1 and velocity to km/s in input
and output.</p>
<div class="admonition seealso">
<p class="first admonition-title">See also</p>
<p class="last">For more information please refer to
<code class="xref py py-class docutils literal notranslate"><span class="pre">fit.LinesModel</span></code></p>
</div>
<dl class="attribute">
<dt id="orb.fit.Cm1LinesModel.accepted_keys">
<code class="descname">accepted_keys</code><em class="property"> = ['line_nb', 'fmodel', 'amp_def', 'pos_def', 'fwhm_def', 'sigma_def', 'alpha_def', 'amp_cov', 'pos_cov', 'fwhm_cov', 'sigma_cov', 'alpha_cov', 'amp_guess', 'pos_guess', 'fwhm_guess', 'sigma_guess', 'alpha_guess', 'step_nb', 'step', 'order', 'nm_laser', 'nm_laser_obs']</em><a class="headerlink" href="#orb.fit.Cm1LinesModel.accepted_keys" title="Permalink to this definition">¶</a></dt>
<dd><p>Accepted keys of the input dictionary (see
<code class="xref py py-attr docutils literal notranslate"><span class="pre">fit.Model.p_dict</span></code>)</p>
</dd></dl>

<dl class="method">
<dt id="orb.fit.Cm1LinesModel.parse_dict">
<code class="descname">parse_dict</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#orb.fit.Cm1LinesModel.parse_dict" title="Permalink to this definition">¶</a></dt>
<dd><p>Parse input dictionary <code class="xref py py-attr docutils literal notranslate"><span class="pre">fit.Model.p_dict</span></code></p>
</dd></dl>

</dd></dl>

<dl class="class">
<dt id="orb.fit.ContinuumModel">
<em class="property">class </em><code class="descclassname">orb.fit.</code><code class="descname">ContinuumModel</code><span class="sig-paren">(</span><em>p_dict</em><span class="sig-paren">)</span><a class="headerlink" href="#orb.fit.ContinuumModel" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <a class="reference internal" href="#orb.fit.Model" title="orb.fit.Model"><code class="xref py py-class docutils literal notranslate"><span class="pre">orb.fit.Model</span></code></a></p>
<p>Polynomial continuum model.</p>
<p>Input dictionary <code class="xref py py-attr docutils literal notranslate"><span class="pre">fit.Model.p_dict</span></code>:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="p">{</span><span class="s1">&#39;poly_order&#39;</span><span class="p">:</span>
 <span class="s1">&#39;poly_guess&#39;</span><span class="p">:}</span>
</pre></div>
</div>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name" colspan="2">Keyword Arguments:</th></tr>
<tr class="field-odd field"><td>&#160;</td><td class="field-body"><ul class="first last simple">
<li><strong>poly_order</strong> – Order of the polynomial to fit (be careful
with high order polynomials).</li>
<li><strong>poly_guess</strong> – Initial guess on the coefficient values :
must be a tuple of length poly_order + 1.</li>
</ul>
</td>
</tr>
</tbody>
</table>
<div class="admonition note">
<p class="first admonition-title">Note</p>
<p class="last">This model must be added to the others.</p>
</div>
<dl class="attribute">
<dt id="orb.fit.ContinuumModel.accepted_keys">
<code class="descname">accepted_keys</code><em class="property"> = ('poly_order', 'poly_guess')</em><a class="headerlink" href="#orb.fit.ContinuumModel.accepted_keys" title="Permalink to this definition">¶</a></dt>
<dd><p>Accepted keys of the input dictionary (see
<code class="xref py py-attr docutils literal notranslate"><span class="pre">fit.Model.p_dict</span></code>)</p>
</dd></dl>

<dl class="method">
<dt id="orb.fit.ContinuumModel.check_input">
<code class="descname">check_input</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#orb.fit.ContinuumModel.check_input" title="Permalink to this definition">¶</a></dt>
<dd><p>Check input parameters</p>
</dd></dl>

<dl class="method">
<dt id="orb.fit.ContinuumModel.get_model">
<code class="descname">get_model</code><span class="sig-paren">(</span><em>x</em>, <em>p_free=None</em>, <em>return_models=False</em>, <em>multf=None</em><span class="sig-paren">)</span><a class="headerlink" href="#orb.fit.ContinuumModel.get_model" title="Permalink to this definition">¶</a></dt>
<dd><p>Return model M(x, p).</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first last simple">
<li><strong>x</strong> – Positions where the model M(x, p) is computed.</li>
<li><strong>p_free</strong> – (Optional) New values of the free parameters
(default None).</li>
<li><strong>multf</strong> – 1d vector with the same length as x vector which
represent the function by which the model must be multiplied.</li>
<li><strong>return_models</strong> – (Optional) If True return also
individual models (default False)</li>
</ul>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="method">
<dt id="orb.fit.ContinuumModel.get_p_val_as_array">
<code class="descname">get_p_val_as_array</code><span class="sig-paren">(</span><em>p_val=None</em><span class="sig-paren">)</span><a class="headerlink" href="#orb.fit.ContinuumModel.get_p_val_as_array" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="method">
<dt id="orb.fit.ContinuumModel.make_guess">
<code class="descname">make_guess</code><span class="sig-paren">(</span><em>v</em><span class="sig-paren">)</span><a class="headerlink" href="#orb.fit.ContinuumModel.make_guess" title="Permalink to this definition">¶</a></dt>
<dd><p>If a parameter value at init is a NaN this value is guessed.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><strong>v</strong> – Data vector from which the guess is made.</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="method">
<dt id="orb.fit.ContinuumModel.parse_dict">
<code class="descname">parse_dict</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#orb.fit.ContinuumModel.parse_dict" title="Permalink to this definition">¶</a></dt>
<dd><p>Parse input dictionary <code class="xref py py-attr docutils literal notranslate"><span class="pre">fit.Model.p_dict</span></code></p>
</dd></dl>

</dd></dl>

<dl class="class">
<dt id="orb.fit.FilterModel">
<em class="property">class </em><code class="descclassname">orb.fit.</code><code class="descname">FilterModel</code><span class="sig-paren">(</span><em>p_dict</em><span class="sig-paren">)</span><a class="headerlink" href="#orb.fit.FilterModel" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <a class="reference internal" href="#orb.fit.Model" title="orb.fit.Model"><code class="xref py py-class docutils literal notranslate"><span class="pre">orb.fit.Model</span></code></a></p>
<p>Simple model of filter based on a real filter shape. The only
possible free parameter is a wavelength/wavenumber shift.</p>
<p>Input dictionary <code class="xref py py-attr docutils literal notranslate"><span class="pre">fit.Model.p_dict</span></code>:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="p">{</span><span class="s1">&#39;filter_function&#39;</span><span class="p">:,</span>
 <span class="s1">&#39;shift_guess&#39;</span><span class="p">:,</span>
 <span class="s1">&#39;shift_def&#39;</span><span class="p">:}</span>
</pre></div>
</div>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name" colspan="2">Keyword Arguments:</th></tr>
<tr class="field-odd field"><td>&#160;</td><td class="field-body"><ul class="first last simple">
<li><strong>filter_function</strong> – Transmission of the filter over the
fitted spectral range (axis must be exactly the same).</li>
<li><strong>shift_guess</strong> – Guess on the filter shift in pixels.</li>
<li><strong>shift_def</strong> – Definition of the shift parameter, can be
‘free’ or ‘fixed’</li>
</ul>
</td>
</tr>
</tbody>
</table>
<div class="admonition note">
<p class="first admonition-title">Note</p>
<p class="last">This model must be multiplied with the other and used
last.</p>
</div>
<dl class="attribute">
<dt id="orb.fit.FilterModel.accepted_keys">
<code class="descname">accepted_keys</code><em class="property"> = ('filter_function', 'shift_guess', 'shift_def')</em><a class="headerlink" href="#orb.fit.FilterModel.accepted_keys" title="Permalink to this definition">¶</a></dt>
<dd><p>Accepted keys of the input dictionary (see
<code class="xref py py-attr docutils literal notranslate"><span class="pre">fit.Model.p_dict</span></code>)</p>
</dd></dl>

<dl class="method">
<dt id="orb.fit.FilterModel.check_input">
<code class="descname">check_input</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#orb.fit.FilterModel.check_input" title="Permalink to this definition">¶</a></dt>
<dd><p>Check input parameters</p>
</dd></dl>

<dl class="method">
<dt id="orb.fit.FilterModel.get_model">
<code class="descname">get_model</code><span class="sig-paren">(</span><em>x</em>, <em>p_free=None</em>, <em>return_models=False</em><span class="sig-paren">)</span><a class="headerlink" href="#orb.fit.FilterModel.get_model" title="Permalink to this definition">¶</a></dt>
<dd><p>Return model M(x, p).</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first last simple">
<li><strong>x</strong> – Positions where the model M(x, p) is computed.</li>
<li><strong>p_free</strong> – (Optional) New values of the free parameters
(default None).</li>
<li><strong>return_models</strong> – (Optional) If True return also
individual models (default False)</li>
</ul>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="method">
<dt id="orb.fit.FilterModel.make_guess">
<code class="descname">make_guess</code><span class="sig-paren">(</span><em>v</em><span class="sig-paren">)</span><a class="headerlink" href="#orb.fit.FilterModel.make_guess" title="Permalink to this definition">¶</a></dt>
<dd><p>If a parameter value at init is a NaN this value is guessed.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><strong>v</strong> – Data vector from which the guess is made.</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="method">
<dt id="orb.fit.FilterModel.parse_dict">
<code class="descname">parse_dict</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#orb.fit.FilterModel.parse_dict" title="Permalink to this definition">¶</a></dt>
<dd><p>Parse input dictionary <code class="xref py py-attr docutils literal notranslate"><span class="pre">fit.Model.p_dict</span></code></p>
</dd></dl>

</dd></dl>

<dl class="class">
<dt id="orb.fit.FitVector">
<em class="property">class </em><code class="descclassname">orb.fit.</code><code class="descname">FitVector</code><span class="sig-paren">(</span><em>vector</em>, <em>models</em>, <em>params</em>, <em>snr_guess=None</em>, <em>fit_tol=1e-08</em>, <em>signal_range=None</em>, <em>classic=False</em>, <em>max_iter=None</em><span class="sig-paren">)</span><a class="headerlink" href="#orb.fit.FitVector" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <a class="reference external" href="https://docs.python.org/3/library/functions.html#object" title="(in Python v3.7)"><code class="xref py py-class docutils literal notranslate"><span class="pre">object</span></code></a></p>
<p>General fitting class for a 1d array of data based on
Levenberg-Marquardt least square fit algorithm.</p>
<p>Accept any combination of models (based on <code class="xref py py-class docutils literal notranslate"><span class="pre">fit.Model</span></code>)</p>
<div class="admonition note">
<p class="first admonition-title">Note</p>
<p class="last">This class is a wrapper around
<code class="xref py py-meth docutils literal notranslate"><span class="pre">scipy.optimize.leastsq()</span></code>. Most of its purpose consists
in passing an array of purely free parameters to
<code class="xref py py-meth docutils literal notranslate"><span class="pre">scipy.optimize.leastsq()</span></code> and creating the objective
function from free and fixed parameters by combining the
different models.</p>
</div>
<dl class="method">
<dt id="orb.fit.FitVector.fit">
<code class="descname">fit</code><span class="sig-paren">(</span><em>compute_mcmc_error=False</em><span class="sig-paren">)</span><a class="headerlink" href="#orb.fit.FitVector.fit" title="Permalink to this definition">¶</a></dt>
<dd><p>Fit data vector.</p>
<p>This is the central function of the class.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><strong>compute_mcmc_error</strong> – (Optional) Compute Markov chain
Monte-Carlo error on the fit parameters (Uncertainty
estimates might be slighly better constrained but computing
time can be orders of magnitude longer) (default False).</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="attribute">
<dt id="orb.fit.FitVector.fit_tol">
<code class="descname">fit_tol</code><em class="property"> = None</em><a class="headerlink" href="#orb.fit.FitVector.fit_tol" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="method">
<dt id="orb.fit.FitVector.get_model">
<code class="descname">get_model</code><span class="sig-paren">(</span><em>all_p_free</em>, <em>return_models=False</em>, <em>x=None</em><span class="sig-paren">)</span><a class="headerlink" href="#orb.fit.FitVector.get_model" title="Permalink to this definition">¶</a></dt>
<dd><p>Return the combined model of the vector given a set of free
parameters.</p>
<p>This function is typically called to compute the objective
function. It can also be called to obtain the final model
based on fitted parameters.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first last simple">
<li><strong>all_p_free</strong> – Vector of free parameters.</li>
<li><strong>return_models</strong> – (Optional) If True return also
individual models (default False)</li>
<li><strong>x</strong> – (Optional) array of data points on which model is
computed instead of a typical np.arange(step_nb) (default
None).</li>
</ul>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="attribute">
<dt id="orb.fit.FitVector.max_fev">
<code class="descname">max_fev</code><em class="property"> = 5000</em><a class="headerlink" href="#orb.fit.FitVector.max_fev" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="attribute">
<dt id="orb.fit.FitVector.models">
<code class="descname">models</code><em class="property"> = None</em><a class="headerlink" href="#orb.fit.FitVector.models" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="attribute">
<dt id="orb.fit.FitVector.models_operation">
<code class="descname">models_operation</code><em class="property"> = None</em><a class="headerlink" href="#orb.fit.FitVector.models_operation" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="attribute">
<dt id="orb.fit.FitVector.models_operations">
<code class="descname">models_operations</code><em class="property"> = ['add', 'mult']</em><a class="headerlink" href="#orb.fit.FitVector.models_operations" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="attribute">
<dt id="orb.fit.FitVector.priors_keys_list">
<code class="descname">priors_keys_list</code><em class="property"> = None</em><a class="headerlink" href="#orb.fit.FitVector.priors_keys_list" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="attribute">
<dt id="orb.fit.FitVector.priors_list">
<code class="descname">priors_list</code><em class="property"> = None</em><a class="headerlink" href="#orb.fit.FitVector.priors_list" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="attribute">
<dt id="orb.fit.FitVector.vector">
<code class="descname">vector</code><em class="property"> = None</em><a class="headerlink" href="#orb.fit.FitVector.vector" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

</dd></dl>

<dl class="class">
<dt id="orb.fit.InputParams">
<em class="property">class </em><code class="descclassname">orb.fit.</code><code class="descname">InputParams</code><span class="sig-paren">(</span><em>step_nb</em><span class="sig-paren">)</span><a class="headerlink" href="#orb.fit.InputParams" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <a class="reference external" href="https://docs.python.org/3/library/functions.html#object" title="(in Python v3.7)"><code class="xref py py-class docutils literal notranslate"><span class="pre">object</span></code></a></p>
<dl class="attribute">
<dt id="orb.fit.InputParams.FWHM_SDEV">
<code class="descname">FWHM_SDEV</code><em class="property"> = 10</em><a class="headerlink" href="#orb.fit.InputParams.FWHM_SDEV" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="attribute">
<dt id="orb.fit.InputParams.SHIFT_SDEV">
<code class="descname">SHIFT_SDEV</code><em class="property"> = 10</em><a class="headerlink" href="#orb.fit.InputParams.SHIFT_SDEV" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="attribute">
<dt id="orb.fit.InputParams.SIGMA_SDEV">
<code class="descname">SIGMA_SDEV</code><em class="property"> = 10</em><a class="headerlink" href="#orb.fit.InputParams.SIGMA_SDEV" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="method">
<dt id="orb.fit.InputParams.add_continuum_model">
<code class="descname">add_continuum_model</code><span class="sig-paren">(</span><em>**kwargs</em><span class="sig-paren">)</span><a class="headerlink" href="#orb.fit.InputParams.add_continuum_model" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="method">
<dt id="orb.fit.InputParams.add_lines_model">
<code class="descname">add_lines_model</code><span class="sig-paren">(</span><em>lines</em>, <em>fwhm_guess</em>, <em>**kwargs</em><span class="sig-paren">)</span><a class="headerlink" href="#orb.fit.InputParams.add_lines_model" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="method">
<dt id="orb.fit.InputParams.append_model">
<code class="descname">append_model</code><span class="sig-paren">(</span><em>model</em>, <em>operation</em>, <em>params</em><span class="sig-paren">)</span><a class="headerlink" href="#orb.fit.InputParams.append_model" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="method">
<dt id="orb.fit.InputParams.check_signal_range">
<code class="descname">check_signal_range</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#orb.fit.InputParams.check_signal_range" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="method">
<dt id="orb.fit.InputParams.clean_kwargs">
<code class="descname">clean_kwargs</code><span class="sig-paren">(</span><em>kwargs</em>, <em>params</em><span class="sig-paren">)</span><a class="headerlink" href="#orb.fit.InputParams.clean_kwargs" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="method">
<dt id="orb.fit.InputParams.convert">
<code class="descname">convert</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#orb.fit.InputParams.convert" title="Permalink to this definition">¶</a></dt>
<dd><p>Convert class to a pickable dict object</p>
</dd></dl>

<dl class="method">
<dt id="orb.fit.InputParams.has_model">
<code class="descname">has_model</code><span class="sig-paren">(</span><em>model</em><span class="sig-paren">)</span><a class="headerlink" href="#orb.fit.InputParams.has_model" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="method">
<dt id="orb.fit.InputParams.set_signal_range">
<code class="descname">set_signal_range</code><span class="sig-paren">(</span><em>rmin</em>, <em>rmax</em><span class="sig-paren">)</span><a class="headerlink" href="#orb.fit.InputParams.set_signal_range" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

</dd></dl>

<dl class="class">
<dt id="orb.fit.LinesModel">
<em class="property">class </em><code class="descclassname">orb.fit.</code><code class="descname">LinesModel</code><span class="sig-paren">(</span><em>p_dict</em><span class="sig-paren">)</span><a class="headerlink" href="#orb.fit.LinesModel" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <a class="reference internal" href="#orb.fit.Model" title="orb.fit.Model"><code class="xref py py-class docutils literal notranslate"><span class="pre">orb.fit.Model</span></code></a></p>
<p>Emission/absorption lines model with a channel unity in pixels.</p>
<div class="admonition note">
<p class="first admonition-title">Note</p>
<p class="last">This class is best seen as a basic class implemented
with more physical unities by <code class="xref py py-class docutils literal notranslate"><span class="pre">fit.Cm1LinesModel</span></code> or
<code class="xref py py-class docutils literal notranslate"><span class="pre">fit.NmLinesModel</span></code>.</p>
</div>
<div class="admonition note">
<p class="first admonition-title">Note</p>
<p>Each line is built on 3 (or more) parameters : amplitude,
FWHM, position and sigma/alpha (the 4th and 5th parameters are used only for some models – see
below for details on the different models).</p>
<p class="last">Some lines can have one or more covarying parameters: FWHM can
be the same for all the lines (this is True if lines are not
resolved), lines issued from the same ion can have the same
speed (e.g. [NII] doublet, [SII] doublet, [OIII] doublet), and
some fixed transition ratios between lines can also be set
(e.g. [NII]6584/[NII]6548 can be set to 2.89, when [NII]6548 is
likely to be really noisy).</p>
</div>
<p>Input dictionary <code class="xref py py-attr docutils literal notranslate"><span class="pre">fit.Model.p_dict</span></code>:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="p">{</span><span class="s1">&#39;line_nb&#39;</span><span class="p">:,</span>
 <span class="s1">&#39;fmodel&#39;</span><span class="p">:,</span>
 <span class="s1">&#39;amp_def&#39;</span><span class="p">:,</span>
 <span class="s1">&#39;pos_def&#39;</span><span class="p">:,</span>
 <span class="s1">&#39;fwhm_def&#39;</span><span class="p">:,</span>
 <span class="s1">&#39;sigma_def&#39;</span><span class="p">:,</span> <span class="c1"># only for sincgauss fmodel</span>
 <span class="s1">&#39;alpha_def&#39;</span><span class="p">:,</span> <span class="c1"># only for sincphased fmode</span>
 <span class="s1">&#39;amp_cov&#39;</span><span class="p">:,</span>
 <span class="s1">&#39;pos_cov&#39;</span><span class="p">:,</span>
 <span class="s1">&#39;fwhm_cov&#39;</span><span class="p">:,</span>
 <span class="s1">&#39;sigma_cov&#39;</span><span class="p">:,</span> <span class="c1"># only for sincgauss fmodel</span>
 <span class="s1">&#39;alpha_cov&#39;</span><span class="p">:,</span> <span class="c1"># only for sincphased fmodel</span>
 <span class="s1">&#39;amp_guess&#39;</span><span class="p">:,</span>
 <span class="s1">&#39;pos_guess&#39;</span><span class="p">:,</span>
 <span class="s1">&#39;fwhm_guess&#39;</span><span class="p">:,</span>
 <span class="s1">&#39;sigma_guess&#39;</span><span class="p">:,</span> <span class="c1"># only for sincgauss fmodel</span>
 <span class="s1">&#39;alpha_guess&#39;</span><span class="p">:}</span> <span class="c1">#  only for sincphased fmodel</span>
</pre></div>
</div>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name" colspan="2">Keyword Arguments:</th></tr>
<tr class="field-odd field"><td>&#160;</td><td class="field-body"><ul class="first last simple">
<li><strong>line_nb</strong> – Number of lines.</li>
<li><strong>fmodel</strong> – Line shape, can be ‘gaussian’, ‘sinc’, ‘sinc2’ or
‘sincgauss’.</li>
<li><strong>amp_def</strong> – Definition of the amplitude parameter, can be
‘free’, ‘fixed’ or set to a label that defines its covarying
group.</li>
<li><strong>pos_def</strong> – Definition of the position parameter in pixels,
can be ‘free’, ‘fixed’ or set to a label that defines its
covarying group.</li>
<li><strong>fwhm_def</strong> – Definition of the FWHM parameter in pixels, can
be ‘free’, ‘fixed’ or set to a label that defines its covarying
group.</li>
<li><strong>sigma_def</strong> – Definition of the sigma parameter in pixels,
can be ‘free’, ‘fixed’ or set to a label that defines its
covarying group.</li>
<li><strong>amp_cov</strong> – Guess on the covariant value of the amplitude
(best set to 0 in general). There must be as many values as
covarying amplitude groups or only one value if it is the same
for all groups.</li>
<li><strong>pos_cov</strong> – Guess on the covariant value of the velocity (in
pixels). There must be as many values as covarying amplitude
groups or only one value if it is the same
for all groups.</li>
<li><strong>fwhm_cov</strong> – Guess on the covariant value of the FWHM
(best set to 0 in general). There must be as many values as
covarying amplitude groups or only one value if it is the same
for all groups.</li>
<li><strong>sigma_cov</strong> – Guess on the covariant value of sigma (best
set to 0 in general). There must be as many values as covarying
amplitude groups or only one value if it is the same for all
groups.</li>
<li><strong>amp_guess</strong> – Initial guess on the amplitude value of the
lines. Best set to a NaN in general (it can be automatically
guessed with good robusteness). But if lines have a covarying
amplitude the initial guess fixes their ratio.</li>
<li><strong>pos_guess</strong> – Initial guess on the position of the lines:
the PRECISE rest frame position must be given here, especially
if lines share a covarying position, because their relative
position will be fixed.</li>
<li><strong>fwhm_guess</strong> – Initial guess on the FWHM of the lines. This
guess must be the MOST PRECISE possible (to a few 10%), it is by
far the most unstable parameter especially for sinc lines.</li>
<li><strong>sigma_guess</strong> – Initial guess on the value of sigma. Best
set to 0. in general</li>
</ul>
</td>
</tr>
</tbody>
</table>
<p>Example: A red spectrum containing [NII]6548, Halpha, [NII]6584,
[SII]6716 and [SII]6731, with a mean velocity of 1500 km/s (which
translates in a pixel shift of 5.5), with a fixed amplitude ratio
netween [NII] lines, the same speed for lines issued from the same
ions and a shared FWHM between everybody but Halpha would be
defined this way:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="p">{</span><span class="s1">&#39;line_nb&#39;</span> <span class="p">:</span> <span class="mi">5</span><span class="p">,</span>
 <span class="s1">&#39;amp_def&#39;</span> <span class="p">:</span> <span class="p">(</span><span class="s1">&#39;1&#39;</span><span class="p">,</span> <span class="s1">&#39;free&#39;</span><span class="p">,</span> <span class="s1">&#39;1&#39;</span><span class="p">,</span> <span class="s1">&#39;free&#39;</span><span class="p">,</span> <span class="s1">&#39;free&#39;</span><span class="p">),</span>
 <span class="s1">&#39;pos_def&#39;</span> <span class="p">:</span> <span class="p">(</span><span class="s1">&#39;1&#39;</span><span class="p">,</span> <span class="s1">&#39;2&#39;</span><span class="p">,</span> <span class="s1">&#39;1&#39;</span><span class="p">,</span> <span class="s1">&#39;3&#39;</span><span class="p">,</span> <span class="s1">&#39;3&#39;</span><span class="p">),</span>
 <span class="s1">&#39;fwhm_def&#39;</span><span class="p">:</span> <span class="p">(</span><span class="s1">&#39;1&#39;</span><span class="p">,</span> <span class="s1">&#39;2&#39;</span><span class="p">,</span> <span class="s1">&#39;1&#39;</span><span class="p">,</span> <span class="s1">&#39;1&#39;</span><span class="p">,</span> <span class="s1">&#39;1&#39;</span><span class="p">),</span>
 <span class="s1">&#39;amp_cov&#39;</span><span class="p">:</span> <span class="mf">0.</span><span class="p">,</span>
 <span class="s1">&#39;pos_cov&#39;</span><span class="p">:</span> <span class="mf">5.5</span><span class="p">,</span>
 <span class="s1">&#39;fwhm_cov&#39;</span><span class="p">:</span> <span class="mf">0.</span><span class="p">,</span>
 <span class="s1">&#39;amp_guess&#39;</span><span class="p">:</span> <span class="p">(</span><span class="mf">1.</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">nan</span><span class="p">,</span> <span class="mf">2.89</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">nan</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">nan</span><span class="p">),</span> <span class="c1"># here the amplitude ratio between covarying [NII] lines is fixed.</span>
 <span class="s1">&#39;pos_guess&#39;</span><span class="p">:</span> <span class="p">(</span><span class="mi">40</span><span class="p">,</span><span class="mi">60</span><span class="p">,</span><span class="mi">80</span><span class="p">,</span><span class="mi">120</span><span class="p">,</span><span class="mi">140</span><span class="p">),</span> <span class="c1"># positions are given in pixel and are purely arbitrary in this example</span>
 <span class="s1">&#39;fwhm_guess&#39;</span><span class="p">:</span> <span class="mf">2.43</span><span class="p">}</span>
</pre></div>
</div>
<div class="admonition note">
<p class="first admonition-title">Note</p>
<p>Line shapes (fmodel keyword):</p>
<ul class="last simple">
<li><strong>gaussian</strong>: A classical gaussian line shape. See <code class="xref py py-meth docutils literal notranslate"><span class="pre">cutils.gaussian1d()</span></code>.</li>
<li><strong>sinc</strong>: A pure sinc line shape, True interferometric line shape
if lines are strongly unresolved and if the interferometer has
no assymetry (generally good on SITELLE/SpIOMM low res cubes
–i.e. less than 500 steps– if the line SNR is not too high
–i.e. &lt; 50–). See <code class="xref py py-meth docutils literal notranslate"><span class="pre">cutils.sinc1d()</span></code>.</li>
<li><strong>sinc2</strong>: sinc2 = sqrt(sinc**2.). Can be used for spectra not
corrected in phase (where the absolute value of the complex
spectrum is taken).</li>
<li><strong>sincgauss</strong>: Convolution of a Gaussian (of width <strong>sigma</strong>) and
a sinc (FWHM). This line shape has a 4th parameter:
sigma. This is much closer to the true line shape, but it
takes much more time to compute because of the generally very
small value of sigma. This can be used to fit resolved lines,
like e.g. Halpha in absorption or active nucleus with broader
emission. See <code class="xref py py-meth docutils literal notranslate"><span class="pre">cutils.sincgauss1d()</span></code>.</li>
</ul>
</div>
<dl class="attribute">
<dt id="orb.fit.LinesModel.accepted_keys">
<code class="descname">accepted_keys</code><em class="property"> = ('line_nb', 'fmodel', 'amp_def', 'pos_def', 'fwhm_def', 'sigma_def', 'alpha_def', 'amp_cov', 'pos_cov', 'fwhm_cov', 'sigma_cov', 'alpha_cov', 'amp_guess', 'pos_guess', 'fwhm_guess', 'sigma_guess', 'alpha_guess')</em><a class="headerlink" href="#orb.fit.LinesModel.accepted_keys" title="Permalink to this definition">¶</a></dt>
<dd><p>Accepted keys of the input dictionary (see
<code class="xref py py-attr docutils literal notranslate"><span class="pre">fit.Model.p_dict</span></code>)</p>
</dd></dl>

<dl class="method">
<dt id="orb.fit.LinesModel.check_input">
<code class="descname">check_input</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#orb.fit.LinesModel.check_input" title="Permalink to this definition">¶</a></dt>
<dd><p>Check input parameters</p>
</dd></dl>

<dl class="method">
<dt id="orb.fit.LinesModel.get_model">
<code class="descname">get_model</code><span class="sig-paren">(</span><em>x</em>, <em>p_free=None</em>, <em>return_models=False</em>, <em>multf=None</em><span class="sig-paren">)</span><a class="headerlink" href="#orb.fit.LinesModel.get_model" title="Permalink to this definition">¶</a></dt>
<dd><p>Return model M(x, p).</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first last simple">
<li><strong>x</strong> – Positions where the model M(x, p) is computed.</li>
<li><strong>p_free</strong> – (Optional) New values of the free parameters
(default None).</li>
<li><strong>multf</strong> – 1d vector with the same length as x vector which
represent the function by which the model must be multiplied.</li>
<li><strong>return_models</strong> – (Optional) If True return also
individual models (default False)</li>
</ul>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="method">
<dt id="orb.fit.LinesModel.get_p_val_as_array">
<code class="descname">get_p_val_as_array</code><span class="sig-paren">(</span><em>p_val=None</em><span class="sig-paren">)</span><a class="headerlink" href="#orb.fit.LinesModel.get_p_val_as_array" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="method">
<dt id="orb.fit.LinesModel.get_priors">
<code class="descname">get_priors</code><span class="sig-paren">(</span><em>classic</em><span class="sig-paren">)</span><a class="headerlink" href="#orb.fit.LinesModel.get_priors" title="Permalink to this definition">¶</a></dt>
<dd><p>Return priors. Replace gaussian distribution by lognormal
distribution for some parameters.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><strong>classic</strong> – If True, return classic priors (e.g. no log
distribution)</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="attribute">
<dt id="orb.fit.LinesModel.log_param_keys">
<code class="descname">log_param_keys</code><em class="property"> = ['fwhm', 'sigma']</em><a class="headerlink" href="#orb.fit.LinesModel.log_param_keys" title="Permalink to this definition">¶</a></dt>
<dd><p>Parameter keys that have a lognormal distribution</p>
</dd></dl>

<dl class="method">
<dt id="orb.fit.LinesModel.make_guess">
<code class="descname">make_guess</code><span class="sig-paren">(</span><em>v</em><span class="sig-paren">)</span><a class="headerlink" href="#orb.fit.LinesModel.make_guess" title="Permalink to this definition">¶</a></dt>
<dd><p>If a parameter value at init is a NaN this value is guessed.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><strong>v</strong> – Data vector from which the guess is made.</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="attribute">
<dt id="orb.fit.LinesModel.p_array">
<code class="descname">p_array</code><em class="property"> = None</em><a class="headerlink" href="#orb.fit.LinesModel.p_array" title="Permalink to this definition">¶</a></dt>
<dd><p>equivalent of <code class="xref py py-attr docutils literal notranslate"><span class="pre">fit.Model.p_val</span></code> but presented as an
array with each row corresponding to a line which is easier to
handle.</p>
</dd></dl>

<dl class="attribute">
<dt id="orb.fit.LinesModel.param_keys">
<code class="descname">param_keys</code><em class="property"> = ['amp', 'pos', 'fwhm', 'sigma', 'alpha']</em><a class="headerlink" href="#orb.fit.LinesModel.param_keys" title="Permalink to this definition">¶</a></dt>
<dd><p>Parameter keys</p>
</dd></dl>

<dl class="method">
<dt id="orb.fit.LinesModel.parse_dict">
<code class="descname">parse_dict</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#orb.fit.LinesModel.parse_dict" title="Permalink to this definition">¶</a></dt>
<dd><p>Parse input dictionary <code class="xref py py-attr docutils literal notranslate"><span class="pre">fit.Model.p_dict</span></code></p>
</dd></dl>

<dl class="attribute">
<dt id="orb.fit.LinesModel.same_param_keys">
<code class="descname">same_param_keys</code><em class="property"> = ['fwhm', 'sigma']</em><a class="headerlink" href="#orb.fit.LinesModel.same_param_keys" title="Permalink to this definition">¶</a></dt>
<dd><p>Parameter keys which must be the same if covarying</p>
</dd></dl>

</dd></dl>

<dl class="class">
<dt id="orb.fit.Model">
<em class="property">class </em><code class="descclassname">orb.fit.</code><code class="descname">Model</code><span class="sig-paren">(</span><em>p_dict</em><span class="sig-paren">)</span><a class="headerlink" href="#orb.fit.Model" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <a class="reference external" href="https://docs.python.org/3/library/functions.html#object" title="(in Python v3.7)"><code class="xref py py-class docutils literal notranslate"><span class="pre">object</span></code></a></p>
<p>Template class for fit models. This class cannot be used directly.</p>
<p>The main purpose of a Model class is to output a model given a set
of parameters.</p>
<p>Methods that must be implemented by real classes:</p>
<blockquote>
<div><ul class="simple">
<li><code class="xref py py-meth docutils literal notranslate"><span class="pre">fit.Model.parse_dict()</span></code></li>
<li><code class="xref py py-meth docutils literal notranslate"><span class="pre">fit.Model.check_input()</span></code></li>
<li><code class="xref py py-meth docutils literal notranslate"><span class="pre">fit.Model.make_guess()</span></code></li>
<li><code class="xref py py-meth docutils literal notranslate"><span class="pre">fit.Model.get_model()</span></code></li>
</ul>
</div></blockquote>
<div class="admonition note">
<p class="first admonition-title">Note</p>
<p>A model is computed from a given set of parameters
stored in <code class="xref py py-attr docutils literal notranslate"><span class="pre">fit.Model.p_val</span></code>. From this set some
parameters are <strong>free</strong>, some are <strong>fixed</strong> and some are
<strong>covarying</strong>, i.e. the value of a subset of parameters can be
computed from 1 free parameter.</p>
<p>Taking the definition of the parameters (free, fixed or
covarying, stored in <code class="xref py py-attr docutils literal notranslate"><span class="pre">fit.Model.p_def</span></code>) into account,
the reduced free parameter set is stored in
<code class="xref py py-attr docutils literal notranslate"><span class="pre">fit.Model.p_free</span></code>, the reduced set of fixed parameters
is stored in <code class="xref py py-attr docutils literal notranslate"><span class="pre">fit.Model.p_fixed</span></code>, the set of covarying
parameters is stored in <code class="xref py py-attr docutils literal notranslate"><span class="pre">fit.Model.p_cov</span></code> and when the
model needs to be computed, the full set of model parameters
(<code class="xref py py-attr docutils literal notranslate"><span class="pre">fit.Model.p_val</span></code>) is computed again from set.p_free`,
<code class="xref py py-attr docutils literal notranslate"><span class="pre">fit.Model.p_fixed</span></code>, <code class="xref py py-attr docutils literal notranslate"><span class="pre">fit.Model.p_cov</span></code> and
<code class="xref py py-attr docutils literal notranslate"><span class="pre">fit.Model.p_def</span></code>.</p>
<p>A group of covarying parameters is defined by the same label. If
<code class="xref py py-attr docutils literal notranslate"><span class="pre">fit.Model.p_def</span></code> is:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="p">[</span><span class="s1">&#39;free&#39;</span><span class="p">,</span> <span class="s1">&#39;fixed&#39;</span><span class="p">,</span> <span class="s1">&#39;1&#39;</span><span class="p">,</span> <span class="s1">&#39;2&#39;</span><span class="p">,</span> <span class="s1">&#39;free&#39;</span><span class="p">,</span> <span class="s1">&#39;fixed&#39;</span><span class="p">,</span> <span class="s1">&#39;2&#39;</span><span class="p">,</span> <span class="s1">&#39;1&#39;</span><span class="p">,</span> <span class="s1">&#39;2&#39;</span><span class="p">,</span> <span class="s1">&#39;free&#39;</span><span class="p">]</span>
</pre></div>
</div>
<p>It means that we have 3 free parameters, 2 fixed parameters and
2 groups of covarying parameters. The first group contains 2
parameters and the second group contains 3 parameters. In this
case the real number of free parameters will be 3 + 2 (one free
parameter for each group of covarying parameters) = 5 and the
real number of fixed parameters will be 2 + 5 (one fixed
parameter for each covarying parameters) = 7.</p>
<p>A Model class works this way :</p>
<ol class="last arabic simple">
<li>Init: the dictionary defining the parameters (free, fixed,
covarying) and their values is parsed with
<code class="xref py py-meth docutils literal notranslate"><span class="pre">fit.Model.parse_dict()</span></code>: <code class="xref py py-attr docutils literal notranslate"><span class="pre">fit.Model.p_def</span></code>,
<code class="xref py py-attr docutils literal notranslate"><span class="pre">fit.Model.p_val</span></code> and <code class="xref py py-attr docutils literal notranslate"><span class="pre">fit.Model.p_cov</span></code> are
created. Then <code class="xref py py-meth docutils literal notranslate"><span class="pre">fit.Model.val2free()</span></code> is called to
create <code class="xref py py-attr docutils literal notranslate"><span class="pre">fit.Model.p_free</span></code> and
<code class="xref py py-attr docutils literal notranslate"><span class="pre">fit.Model.p_fixed</span></code>.</li>
<li>the set of free parameters can then be changed with
<code class="xref py py-meth docutils literal notranslate"><span class="pre">fit.Model.set_p_free()</span></code> before calling
<code class="xref py py-meth docutils literal notranslate"><span class="pre">fit.Model.get_model()</span></code>. the updated values of
<code class="xref py py-attr docutils literal notranslate"><span class="pre">fit.Model.p_val</span></code> are computed before the model is created via
<code class="xref py py-meth docutils literal notranslate"><span class="pre">fit.Model.free2val()</span></code>. A new set of free parameters
can also be passed to <code class="xref py py-meth docutils literal notranslate"><span class="pre">fit.Model.get_model()</span></code>.</li>
</ol>
</div>
<dl class="attribute">
<dt id="orb.fit.Model.accepted_keys">
<code class="descname">accepted_keys</code><em class="property"> = ()</em><a class="headerlink" href="#orb.fit.Model.accepted_keys" title="Permalink to this definition">¶</a></dt>
<dd><p>Accepted keys of the input dictionary (see
<code class="xref py py-attr docutils literal notranslate"><span class="pre">fit.Model.p_dict</span></code>)</p>
</dd></dl>

<dl class="method">
<dt id="orb.fit.Model.check_input">
<code class="descname">check_input</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#orb.fit.Model.check_input" title="Permalink to this definition">¶</a></dt>
<dd><p>Check input parameters</p>
</dd></dl>

<dl class="method">
<dt id="orb.fit.Model.free2val">
<code class="descname">free2val</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#orb.fit.Model.free2val" title="Permalink to this definition">¶</a></dt>
<dd><p>Read the array of parameters definition
<code class="xref py py-attr docutils literal notranslate"><span class="pre">fit.Model.p_def</span></code> and update the parameter values
based on the new set of free parameters
<code class="xref py py-attr docutils literal notranslate"><span class="pre">fit.Model.p_free</span></code>.</p>
</dd></dl>

<dl class="method">
<dt id="orb.fit.Model.get_model">
<code class="descname">get_model</code><span class="sig-paren">(</span><em>x</em>, <em>return_models=False</em><span class="sig-paren">)</span><a class="headerlink" href="#orb.fit.Model.get_model" title="Permalink to this definition">¶</a></dt>
<dd><p>Compute a model M(x, p) for all passed x positions. p are
the parameter values stored in <code class="xref py py-attr docutils literal notranslate"><span class="pre">fit.Model.p_val</span></code></p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first last simple">
<li><strong>x</strong> – Positions where the model M(x, p) is computed.</li>
<li><strong>return_models</strong> – (Optional) If True return also
individual models (default False)</li>
</ul>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="method">
<dt id="orb.fit.Model.get_p_free">
<code class="descname">get_p_free</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#orb.fit.Model.get_p_free" title="Permalink to this definition">¶</a></dt>
<dd><p>Return the vector of free parameters <code class="xref py py-attr docutils literal notranslate"><span class="pre">fit.Model.p_free</span></code></p>
</dd></dl>

<dl class="method">
<dt id="orb.fit.Model.get_p_val">
<code class="descname">get_p_val</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#orb.fit.Model.get_p_val" title="Permalink to this definition">¶</a></dt>
<dd><p>Return <code class="xref py py-attr docutils literal notranslate"><span class="pre">fit.Model.p_val</span></code></p>
</dd></dl>

<dl class="method">
<dt id="orb.fit.Model.get_priors">
<code class="descname">get_priors</code><span class="sig-paren">(</span><em>classic</em><span class="sig-paren">)</span><a class="headerlink" href="#orb.fit.Model.get_priors" title="Permalink to this definition">¶</a></dt>
<dd><p>Return priors</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><strong>classic</strong> – If True, return classic priors (e.g. no log distribution)</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="method">
<dt id="orb.fit.Model.make_guess">
<code class="descname">make_guess</code><span class="sig-paren">(</span><em>v</em><span class="sig-paren">)</span><a class="headerlink" href="#orb.fit.Model.make_guess" title="Permalink to this definition">¶</a></dt>
<dd><p>If a parameter value at init is a NaN this value is guessed.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><strong>v</strong> – Data vector from which the guess is made.</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="attribute">
<dt id="orb.fit.Model.p_cov">
<code class="descname">p_cov</code><em class="property"> = None</em><a class="headerlink" href="#orb.fit.Model.p_cov" title="Permalink to this definition">¶</a></dt>
<dd><p>dict that stores the groups of covarying parameters by label
and their associated value and covarying operation (a pointer to a
function), i.e.:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="p">{[</span><span class="s1">&#39;cov_label_1&#39;</span><span class="p">:</span> <span class="p">(</span><span class="n">value1</span><span class="p">,</span> <span class="n">cov_operation1</span><span class="p">)],</span>
 <span class="p">[</span><span class="s1">&#39;cov_label_2&#39;</span><span class="p">:</span> <span class="p">(</span><span class="n">value2</span><span class="p">,</span> <span class="n">cov_operation2</span><span class="p">)],</span>
 <span class="o">...</span><span class="p">}</span>
</pre></div>
</div>
</dd></dl>

<dl class="attribute">
<dt id="orb.fit.Model.p_def">
<code class="descname">p_def</code><em class="property"> = None</em><a class="headerlink" href="#orb.fit.Model.p_def" title="Permalink to this definition">¶</a></dt>
<dd><p>Definition the full set of parameters (fixed, free or
covarying). This array as the same shape as <code class="xref py py-attr docutils literal notranslate"><span class="pre">fit.Model.p_val</span></code></p>
</dd></dl>

<dl class="attribute">
<dt id="orb.fit.Model.p_dict">
<code class="descname">p_dict</code><em class="property"> = None</em><a class="headerlink" href="#orb.fit.Model.p_dict" title="Permalink to this definition">¶</a></dt>
<dd><p>Input dictionary defining the parameters. Contains the initial
values of the parameters</p>
</dd></dl>

<dl class="attribute">
<dt id="orb.fit.Model.p_fixed">
<code class="descname">p_fixed</code><em class="property"> = None</em><a class="headerlink" href="#orb.fit.Model.p_fixed" title="Permalink to this definition">¶</a></dt>
<dd><p>Array of fixed parameters. Each covarying parameter is stored
as fixed. And one free parameter is added for each group of
covarying parameters.</p>
</dd></dl>

<dl class="attribute">
<dt id="orb.fit.Model.p_free">
<code class="descname">p_free</code><em class="property"> = None</em><a class="headerlink" href="#orb.fit.Model.p_free" title="Permalink to this definition">¶</a></dt>
<dd><p>Up to date value of the free parameters. Its size is always
less or equal to the size of the full set of parameters used
directly to compute the model. It reflects the real number of
fitted parameters. For each group of covarying parameters one free
parameter is added.</p>
</dd></dl>

<dl class="attribute">
<dt id="orb.fit.Model.p_val">
<code class="descname">p_val</code><em class="property"> = None</em><a class="headerlink" href="#orb.fit.Model.p_val" title="Permalink to this definition">¶</a></dt>
<dd><p>Up to date values of the full set of parameters used by the model
(initial guess before fit, fitted value after fit). This array as
the same shape as <code class="xref py py-attr docutils literal notranslate"><span class="pre">fit.Model.p_def</span></code>. It does not reflect the real number
of fitted parameters.</p>
</dd></dl>

<dl class="method">
<dt id="orb.fit.Model.parse_dict">
<code class="descname">parse_dict</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#orb.fit.Model.parse_dict" title="Permalink to this definition">¶</a></dt>
<dd><p>Parse input dictionary to create <code class="xref py py-attr docutils literal notranslate"><span class="pre">fit.Model.p_def</span></code>, <code class="xref py py-attr docutils literal notranslate"><span class="pre">fit.Model.p_val</span></code> and
<code class="xref py py-attr docutils literal notranslate"><span class="pre">fit.Model.p_cov</span></code></p>
</dd></dl>

<dl class="method">
<dt id="orb.fit.Model.set_p_free">
<code class="descname">set_p_free</code><span class="sig-paren">(</span><em>p_free</em><span class="sig-paren">)</span><a class="headerlink" href="#orb.fit.Model.set_p_free" title="Permalink to this definition">¶</a></dt>
<dd><p>Set the vector of free parameters <code class="xref py py-attr docutils literal notranslate"><span class="pre">fit.Model.p_free</span></code></p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><strong>p_free</strong> – New vector of free parameters</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="method">
<dt id="orb.fit.Model.set_p_val">
<code class="descname">set_p_val</code><span class="sig-paren">(</span><em>p_val</em><span class="sig-paren">)</span><a class="headerlink" href="#orb.fit.Model.set_p_val" title="Permalink to this definition">¶</a></dt>
<dd><p>Set <code class="xref py py-attr docutils literal notranslate"><span class="pre">fit.Model.p_val</span></code></p>
<div class="admonition warning">
<p class="first admonition-title">Warning</p>
<p class="last">This method is used to bypass all the initialized
parameters and reuse an already initialized model with
another full set of parameters. Note that you might want to
call <code class="xref py py-meth docutils literal notranslate"><span class="pre">fit.Model.get_model()</span></code> directly after this
method because any call to <code class="xref py py-meth docutils literal notranslate"><span class="pre">fit.Model.set_p_free()</span></code>
or <code class="xref py py-meth docutils literal notranslate"><span class="pre">fit.Model.free2val()</span></code> will recompute
<code class="xref py py-attr docutils literal notranslate"><span class="pre">fit.Model.p_val</span></code> from the init values and the
actual <code class="xref py py-attr docutils literal notranslate"><span class="pre">fit.Model.p_free</span></code>.</p>
</div>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><strong>p_val</strong> – New full set of parameters.</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="method">
<dt id="orb.fit.Model.val2free">
<code class="descname">val2free</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#orb.fit.Model.val2free" title="Permalink to this definition">¶</a></dt>
<dd><p>Recompute the set of free parameters
<code class="xref py py-attr docutils literal notranslate"><span class="pre">fit.Model.p_free</span></code> with the updated values of
<code class="xref py py-attr docutils literal notranslate"><span class="pre">fit.Model.p_val</span></code></p>
</dd></dl>

</dd></dl>

<dl class="class">
<dt id="orb.fit.NmLinesModel">
<em class="property">class </em><code class="descclassname">orb.fit.</code><code class="descname">NmLinesModel</code><span class="sig-paren">(</span><em>p_dict</em><span class="sig-paren">)</span><a class="headerlink" href="#orb.fit.NmLinesModel" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <a class="reference internal" href="#orb.fit.Cm1LinesModel" title="orb.fit.Cm1LinesModel"><code class="xref py py-class docutils literal notranslate"><span class="pre">orb.fit.Cm1LinesModel</span></code></a></p>
<p>Emission/absorption lines model with a channel unity in nm.</p>
<p>Reimplements <code class="xref py py-class docutils literal notranslate"><span class="pre">fit.Cm1LinesModel</span></code> to use nm instead of
cm-1. Channels are translated to cm-1 and velocity to km/s in
input and output.</p>
<div class="admonition seealso">
<p class="first admonition-title">See also</p>
<p class="last">For more information please refer to
<code class="xref py py-class docutils literal notranslate"><span class="pre">fit.Cm1LinesModel</span></code> and <code class="xref py py-class docutils literal notranslate"><span class="pre">fit.LinesModel</span></code></p>
</div>
<dl class="method">
<dt id="orb.fit.NmLinesModel.parse_dict">
<code class="descname">parse_dict</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#orb.fit.NmLinesModel.parse_dict" title="Permalink to this definition">¶</a></dt>
<dd><p>Parse input dictionary <code class="xref py py-attr docutils literal notranslate"><span class="pre">fit.Model.p_dict</span></code></p>
</dd></dl>

</dd></dl>

<dl class="class">
<dt id="orb.fit.OutputParams">
<em class="property">class </em><code class="descclassname">orb.fit.</code><code class="descname">OutputParams</code><a class="headerlink" href="#orb.fit.OutputParams" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <a class="reference internal" href="#orb.fit.Params" title="orb.fit.Params"><code class="xref py py-class docutils literal notranslate"><span class="pre">orb.fit.Params</span></code></a></p>
<dl class="method">
<dt id="orb.fit.OutputParams.convert">
<code class="descname">convert</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#orb.fit.OutputParams.convert" title="Permalink to this definition">¶</a></dt>
<dd><p>Convert class to a raw pickable format</p>
</dd></dl>

<dl class="method">
<dt id="orb.fit.OutputParams.translate">
<code class="descname">translate</code><span class="sig-paren">(</span><em>inputparams</em>, <em>fitvector</em><span class="sig-paren">)</span><a class="headerlink" href="#orb.fit.OutputParams.translate" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

</dd></dl>

<dl class="class">
<dt id="orb.fit.Params">
<em class="property">class </em><code class="descclassname">orb.fit.</code><code class="descname">Params</code><a class="headerlink" href="#orb.fit.Params" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#dict" title="(in Python v3.7)"><code class="xref py py-class docutils literal notranslate"><span class="pre">dict</span></code></a></p>
<p>Manage a set of parameters as a special dictionary which
elements can be accessed like attributes.</p>
</dd></dl>

<dl class="function">
<dt id="orb.fit.check_fit">
<code class="descclassname">orb.fit.</code><code class="descname">check_fit</code><span class="sig-paren">(</span><em>lines</em>, <em>amp</em>, <em>fwhm</em>, <em>step_nb</em>, <em>snr</em>, <em>line_shift=0</em>, <em>sigma=0</em>, <em>alpha=0</em>, <em>fmodel='sincgauss'</em><span class="sig-paren">)</span><a class="headerlink" href="#orb.fit.check_fit" title="Permalink to this definition">¶</a></dt>
<dd><p>Create a model and fit it.</p>
<p>This is a good way to check the quality and the internal coherency
of the fitting routine.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first last simple">
<li><strong>lines</strong> – lines channels</li>
<li><strong>amp</strong> – Amplitude (must have the same size as lines)</li>
<li><strong>fwhm</strong> – lines FWHM (in channels)</li>
<li><strong>step_nb</strong> – Number of steps of the spectrum.</li>
<li><strong>snr</strong> – SNR of the strongest line</li>
<li><strong>line_shift</strong> – (Optional) Global shift applied to all the
lines (in channels, default 0.)</li>
<li><strong>sigma</strong> – (Optional) Sigma of the lines (in channels, default
0.)</li>
<li><strong>alpha</strong> – (Optional) Phase coefficient of the lines (default
0.)</li>
<li><strong>fmodel</strong> – (Optional) Lines model. Can be ‘gaussian’, ‘sinc’,
‘sincgauss’, ‘sincphased’, ‘sincgaussphased’ (default sincgauss).</li>
</ul>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="function">
<dt id="orb.fit.check_fit_cm1">
<code class="descclassname">orb.fit.</code><code class="descname">check_fit_cm1</code><span class="sig-paren">(</span><em>lines_cm1</em>, <em>amp</em>, <em>step</em>, <em>order</em>, <em>resolution</em>, <em>theta</em>, <em>snr</em>, <em>sigma=0</em>, <em>vel=0</em>, <em>alpha=0.0</em>, <em>fmodel='sincgauss'</em><span class="sig-paren">)</span><a class="headerlink" href="#orb.fit.check_fit_cm1" title="Permalink to this definition">¶</a></dt>
<dd><p>Create a model and fit it.</p>
<p>This is a good way to check the quality and the internal coherency
of the fitting routine.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first last simple">
<li><strong>lines_cm1</strong> – Lines rest wavenumber in cm-1</li>
<li><strong>amp</strong> – Amplitude of the lines</li>
<li><strong>step</strong> – Step size in nm</li>
<li><strong>oder</strong> – Folding order</li>
<li><strong>resolution</strong> – Resolution</li>
<li><strong>theta</strong> – Incident angle</li>
<li><strong>snr</strong> – SNR of the strongest line</li>
<li><strong>sigma</strong> – (Optional) Line broadening in km/s (default 0.)</li>
<li><strong>vel</strong> – (Optional) Velocity in km/s (default 0.)</li>
<li><strong>alpha</strong> – (Optional) Phase coefficient of the lines (default
0.)</li>
</ul>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="function">
<dt id="orb.fit.create_cm1_lines_model">
<code class="descclassname">orb.fit.</code><code class="descname">create_cm1_lines_model</code><span class="sig-paren">(</span><em>lines_cm1</em>, <em>amp</em>, <em>step</em>, <em>order</em>, <em>resolution</em>, <em>theta</em>, <em>vel=0.0</em>, <em>sigma=0.0</em>, <em>alpha=0.0</em>, <em>fmodel='sincgauss'</em><span class="sig-paren">)</span><a class="headerlink" href="#orb.fit.create_cm1_lines_model" title="Permalink to this definition">¶</a></dt>
<dd><p>Return a simple emission-line spectrum model in cm-1</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first last simple">
<li><strong>lines</strong> – lines in cm-1</li>
<li><strong>amp</strong> – Amplitude (must have the same size as lines)</li>
<li><strong>step</strong> – Step size</li>
<li><strong>order</strong> – Folding order</li>
<li><strong>resolution</strong> – Resolution of the spectrum</li>
<li><strong>theta</strong> – Incident angle</li>
<li><strong>step_nb</strong> – Number of steps of the spectrum.</li>
<li><strong>vel</strong> – (Optional) Global velocity shift applied to all the
lines (in km/s, default 0.)</li>
<li><strong>sigma</strong> – (Optional) Line broadening (in km/s, default 0.)</li>
<li><strong>alpha</strong> – (Optional) Phase coefficient of the lines (default
0.)</li>
<li><strong>fmodel</strong> – (Optional) Lines model. Can be ‘gaussian’, ‘sinc’,
‘sincgauss’, ‘sincphased’, ‘sincgaussphased’ (default sincgauss).</li>
</ul>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="function">
<dt id="orb.fit.create_lines_model">
<code class="descclassname">orb.fit.</code><code class="descname">create_lines_model</code><span class="sig-paren">(</span><em>lines</em>, <em>amp</em>, <em>fwhm</em>, <em>step_nb</em>, <em>line_shift=0.0</em>, <em>sigma=0.0</em>, <em>alpha=0.0</em>, <em>fmodel='sincgauss'</em><span class="sig-paren">)</span><a class="headerlink" href="#orb.fit.create_lines_model" title="Permalink to this definition">¶</a></dt>
<dd><p>Return a simple emission-line spectrum model with no physical units.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first last simple">
<li><strong>lines</strong> – lines channels.</li>
<li><strong>amp</strong> – Amplitude (must have the same size as lines).</li>
<li><strong>fwhm</strong> – lines FWHM (in channels).</li>
<li><strong>step_nb</strong> – Number of steps of the spectrum.</li>
<li><strong>line_shift</strong> – (Optional) Global shift applied to all the
lines (in channels, default 0.)</li>
<li><strong>sigma</strong> – (Optional) Sigma of the lines (in channels, default
0.)</li>
<li><strong>alpha</strong> – (Optional) Phase coefficient of the lines (default
0.)</li>
<li><strong>fmodel</strong> – (Optional) Lines model. Can be ‘gaussian’, ‘sinc’,
‘sincgauss’, ‘sincphased’, ‘sincgaussphased’ (default sincgauss).</li>
</ul>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="function">
<dt id="orb.fit.fit_lines_in_spectrum">
<code class="descclassname">orb.fit.</code><code class="descname">fit_lines_in_spectrum</code><span class="sig-paren">(</span><em>spectrum</em>, <em>lines</em>, <em>step</em>, <em>order</em>, <em>nm_laser</em>, <em>theta</em>, <em>zpd_index</em>, <em>wavenumber=True</em>, <em>filter_file_path=None</em>, <em>apodization=1.0</em>, <em>fit_tol=1e-10</em>, <em>velocity_range=None</em>, <em>compute_mcmc_error=False</em>, <em>snr_guess=None</em>, <em>max_iter=None</em>, <em>**kwargs</em><span class="sig-paren">)</span><a class="headerlink" href="#orb.fit.fit_lines_in_spectrum" title="Permalink to this definition">¶</a></dt>
<dd><p>Fit lines in spectrum</p>
<div class="admonition warning">
<p class="first admonition-title">Warning</p>
<p class="last">If spectrum is in wavenumber (option wavenumber set
to True) input and output unit will be in cm-1. If spectrum is
in wavelength (option wavenumber set to False) input and output
unit will be in nm.</p>
</div>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first simple">
<li><strong>spectrum</strong> – Spectrum to fit</li>
<li><strong>lines</strong> – Positions of the lines in nm/cm-1</li>
<li><strong>step</strong> – Step size in nm</li>
<li><strong>order</strong> – Folding order</li>
<li><strong>nm_laser</strong> – Calibration laser wavelength in nm.</li>
<li><strong>theta_proj</strong> – Projected incident angle of the spectrum in
degrees.</li>
<li><strong>zpd_index</strong> – Index of the ZPD in the interferogram.</li>
<li><strong>apodization</strong> – (Optional) Apodization level. Permit to separate the
broadening due to the apodization and the real line broadening
(see ‘broadening’ output parameter, default 1.).</li>
<li><strong>fit_tol</strong> – (Optional) Tolerance on the fit value (default
1e-10).</li>
<li><strong>filter_file_path</strong> – (Optional) Filter file path (default
None).</li>
<li><strong>velocity_range</strong> – (Optional) Range of velocity to check
around the shift_guess value. If not None, a brute force
algorithm is used to find the best velocity value. If more than
one shift_guess is given (e.g. if lines are have different
velocities, the mean velocity will be used as an initial
velocity guess). The quality of this guess depends strongly on
the spectrum noise. Try avoid using it with low a SNR spectrum.</li>
<li><strong>compute_mcmc_error</strong> – (Optional) If True, uncertainty
estimates are computed from a Markov chain Monte-Carlo
algorithm. If the estimates can be better constrained, the
fitting time is orders of magnitude longer (default False).</li>
<li><strong>snr_guess</strong> – (Optional) Guess on the SNR (default None).</li>
<li><strong>max_iter</strong> – (Optional) Maximum number of iterations (default None)</li>
<li><strong>kwargs</strong> – (Optional) Fitting parameters of
<code class="xref py py-class docutils literal notranslate"><span class="pre">orb.fit.Cm1LinesInput</span></code> or
<a class="reference internal" href="#orb.fit.FitVector" title="orb.fit.FitVector"><code class="xref py py-class docutils literal notranslate"><span class="pre">orb.fit.FitVector</span></code></a>.</li>
</ul>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><p class="first last"><p>a dictionary containing:</p>
<ul class="simple">
<li>all the fit parameters [key: ‘fit_params’]</li>
<li>lines parameters [key: ‘lines_params’] Lines parameters are
given as an array of shape (lines_nb, 5). The order of the 5
parameters for each lines is [height at the center of the
line, amplitude, position, fwhm, sigma]. Position and FWHM are given
in nm/cm-1 depending on the input unit (i.e. nm if wavenumber
is False and cm-1 if wavenumber is True)</li>
<li>lines parameters errors [key: ‘lines_params_err’]</li>
<li>velocity [key: ‘velocity’] Velocity of the lines in km/s</li>
<li>velocity error [key: ‘velocity_err’] Error on the velocity of
the lines in km/s</li>
<li>residual [key: ‘residual’]</li>
<li>chi-square [key: ‘chi2’]</li>
<li>reduced chi-square [key: ‘rchi2’]</li>
<li>SNR [key: ‘snr’]</li>
<li>continuum parameters [key: ‘cont_params’]</li>
<li>fitted spectrum [key: ‘fitted_vector’]</li>
<li>log(Gaussian Bayes Factor) [key: ‘logGBF’]</li>
</ul>
</p>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="function">
<dt id="orb.fit.fit_lines_in_vector">
<code class="descclassname">orb.fit.</code><code class="descname">fit_lines_in_vector</code><span class="sig-paren">(</span><em>vector</em>, <em>lines</em>, <em>fwhm_guess</em>, <em>fit_tol=1e-10</em>, <em>compute_mcmc_error=False</em>, <em>snr_guess=None</em>, <em>max_iter=None</em>, <em>**kwargs</em><span class="sig-paren">)</span><a class="headerlink" href="#orb.fit.fit_lines_in_vector" title="Permalink to this definition">¶</a></dt>
<dd><p>Fit lines in a vector</p>
<p>Use this function only if little is known about the vector. A
vector resulting from an interferogram FFT is assumed :
i.e. regular axis, symmetrical line shape.</p>
<div class="admonition warning">
<p class="first admonition-title">Warning</p>
<p class="last">All position units are in channels</p>
</div>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first simple">
<li><strong>vector</strong> – vector to fit</li>
<li><strong>lines</strong> – Positions of the lines in channels</li>
<li><strong>fwhm_guess</strong> – Initial guess on the lines FWHM (in channels).</li>
<li><strong>fit_tol</strong> – (Optional) Tolerance on the fit value (default
1e-10).</li>
<li><strong>compute_mcmc_error</strong> – (Optional) If True, uncertainty
estimates are computed from a Markov chain Monte-Carlo
algorithm. If the estimates can be better constrained, the
fitting time is orders of magnitude longer (default False).</li>
<li><strong>max_iter</strong> – (Optional) Maximum number of iterations (default None)</li>
<li><strong>kwargs</strong> – (Optional) Fitting parameters of
<code class="xref py py-class docutils literal notranslate"><span class="pre">orb.fit.LinesInput</span></code> or
<a class="reference internal" href="#orb.fit.FitVector" title="orb.fit.FitVector"><code class="xref py py-class docutils literal notranslate"><span class="pre">orb.fit.FitVector</span></code></a>.</li>
</ul>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Snr_guess:</th><td class="field-body"><p class="first">(Optional) Guess on the SNR (default None).</p>
</td>
</tr>
<tr class="field-odd field"><th class="field-name">Returns:</th><td class="field-body"><p class="first last"><p>a dictionary containing:</p>
<ul class="simple">
<li>all the fit parameters [key: ‘fit_params’]</li>
<li>lines parameters [key: ‘lines_params’] Lines parameters are
given as an array of shape (lines_nb, 5). The order of the 5
parameters for each lines is [height at the center of the
line, amplitude, position, fwhm, sigma]. Postion and FWHM are given
in channels.</li>
<li>lines parameters errors [key: ‘lines_params_err’]</li>
<li>residual [key: ‘residual’]</li>
<li>chi-square [key: ‘chi2’]</li>
<li>reduced chi-square [key: ‘rchi2’]</li>
<li>SNR [key: ‘snr’]</li>
<li>continuum parameters [key: ‘cont_params’]</li>
<li>fitted spectrum [key: ‘fitted_vector’]</li>
<li>log(Gaussian Bayes Factor) [key: ‘logGBF’]</li>
</ul>
</p>
</td>
</tr>
</tbody>
</table>
</dd></dl>

</div>
</div>


           </div>
           
          </div>
          <footer>
  
    <div class="rst-footer-buttons" role="navigation" aria-label="footer navigation">
      
        <a href="code_utils.html" class="btn btn-neutral float-right" title="Code documentation: utils modules" accesskey="n" rel="next">Next <span class="fa fa-arrow-circle-right"></span></a>
      
      
        <a href="README.html" class="btn btn-neutral float-left" title="Introduction" accesskey="p" rel="prev"><span class="fa fa-arrow-circle-left"></span> Previous</a>
      
    </div>
  

  <hr/>

  <div role="contentinfo">
    <p>
        &copy; Copyright 2019, Thomas Martin

    </p>
  </div>
  Built with <a href="http://sphinx-doc.org/">Sphinx</a> using a <a href="https://github.com/rtfd/sphinx_rtd_theme">theme</a> provided by <a href="https://readthedocs.org">Read the Docs</a>. 

</footer>

        </div>
      </div>

    </section>

  </div>
  


  <script type="text/javascript">
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script>

  
  
    
   

</body>
</html>